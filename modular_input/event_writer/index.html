
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../event/">
      
      
        <link rel="next" href="../modular_input/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>event_writer.py - Splunk Solutions SDK</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#event_writerpy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- Source:
https://github.com/squidfunk/mkdocs-material/blob/master/src/templates/partials/header.html
-->



  


<!-- Header -->
<header class="md-header md-header--shadow" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="Header"
  >

    <!-- Link to home -->
    <a
      href="../.."
      title="Splunk Solutions SDK"
      class="md-header__button md-logo"
      aria-label="Splunk Solutions SDK"
      data-md-component="logo"
    >
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Splunk Solutions SDK
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              event_writer.py
            
          </span>
        </div>
      </div>
    </div>

    
      <a href="../../print_page/" title="Print Site" class="md-header__button md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 3H6v4h12m1 5a1 1 0 0 1-1-1 1 1 0 0 1 1-1 1 1 0 0 1 1 1 1 1 0 0 1-1 1m-3 7H8v-5h8m3-6H5a3 3 0 0 0-3 3v6h4v4h12v-4h4v-6a3 3 0 0 0-3-3Z"/></svg>
      </a>
    

    <!-- Color palette toggle -->
    
      
    

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Splunk Solutions SDK" class="md-nav__button md-logo" aria-label="Splunk Solutions SDK" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Splunk Solutions SDK
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../release_6_0_0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release 6.0.0
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../release_7_0_0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release 7.0.0
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    modular_input
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            modular_input
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../checkpointer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkpointer.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    event_writer.py
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    event_writer.py
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer" class="md-nav__link">
    solnlib.modular_input.event_writer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.__all__" class="md-nav__link">
    __all__
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.deprecation_msg" class="md-nav__link">
    deprecation_msg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter" class="md-nav__link">
    ClassicEventWriter
  </a>
  
    <nav class="md-nav" aria-label="ClassicEventWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.create_event" class="md-nav__link">
    create_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.write_events" class="md-nav__link">
    write_events()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter" class="md-nav__link">
    EventWriter
  </a>
  
    <nav class="md-nav" aria-label="EventWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter.description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter.create_event" class="md-nav__link">
    create_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter.write_events" class="md-nav__link">
    write_events()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.FunctionDeprecated" class="md-nav__link">
    FunctionDeprecated
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter" class="md-nav__link">
    HECEventWriter
  </a>
  
    <nav class="md-nav" aria-label="HECEventWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.HTTP_EVENT_COLLECTOR_ENDPOINT" class="md-nav__link">
    HTTP_EVENT_COLLECTOR_ENDPOINT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.HTTP_INPUT_CONFIG_ENDPOINT" class="md-nav__link">
    HTTP_INPUT_CONFIG_ENDPOINT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.SERVICE_UNAVAILABLE" class="md-nav__link">
    SERVICE_UNAVAILABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.TOO_MANY_REQUESTS" class="md-nav__link">
    TOO_MANY_REQUESTS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.WRITE_EVENT_RETRIES" class="md-nav__link">
    WRITE_EVENT_RETRIES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.headers" class="md-nav__link">
    headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.logger" class="md-nav__link">
    logger
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_event" class="md-nav__link">
    create_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_input" class="md-nav__link">
    create_from_input()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_token" class="md-nav__link">
    create_from_token()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_token_with_session_key" class="md-nav__link">
    create_from_token_with_session_key()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.write_events" class="md-nav__link">
    write_events()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../modular_input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    modular_input.py
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../acl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acl.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    credentials.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../conf_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conf_manager.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../file_monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_monitor.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../hec_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hec_config.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../net_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    net_utils.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../orphan_process_monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    orphan_process_monitor.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pattern.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../server_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    server_info.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../splunk_rest_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    splunk_rest_client.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../bulletin_rest_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bulletin_rest_client.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../splunkenv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    splunkenv.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../time_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    time_parser.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../timer_queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer_queue.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../user_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    user_access.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils.py
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer" class="md-nav__link">
    solnlib.modular_input.event_writer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.__all__" class="md-nav__link">
    __all__
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.deprecation_msg" class="md-nav__link">
    deprecation_msg
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter" class="md-nav__link">
    ClassicEventWriter
  </a>
  
    <nav class="md-nav" aria-label="ClassicEventWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.create_event" class="md-nav__link">
    create_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.ClassicEventWriter.write_events" class="md-nav__link">
    write_events()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter" class="md-nav__link">
    EventWriter
  </a>
  
    <nav class="md-nav" aria-label="EventWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter.description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter.create_event" class="md-nav__link">
    create_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.EventWriter.write_events" class="md-nav__link">
    write_events()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.FunctionDeprecated" class="md-nav__link">
    FunctionDeprecated
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter" class="md-nav__link">
    HECEventWriter
  </a>
  
    <nav class="md-nav" aria-label="HECEventWriter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.HTTP_EVENT_COLLECTOR_ENDPOINT" class="md-nav__link">
    HTTP_EVENT_COLLECTOR_ENDPOINT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.HTTP_INPUT_CONFIG_ENDPOINT" class="md-nav__link">
    HTTP_INPUT_CONFIG_ENDPOINT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.SERVICE_UNAVAILABLE" class="md-nav__link">
    SERVICE_UNAVAILABLE
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.TOO_MANY_REQUESTS" class="md-nav__link">
    TOO_MANY_REQUESTS
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.WRITE_EVENT_RETRIES" class="md-nav__link">
    WRITE_EVENT_RETRIES
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.description" class="md-nav__link">
    description
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.headers" class="md-nav__link">
    headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.logger" class="md-nav__link">
    logger
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_event" class="md-nav__link">
    create_event()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_input" class="md-nav__link">
    create_from_input()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_token" class="md-nav__link">
    create_from_token()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_token_with_session_key" class="md-nav__link">
    create_from_token_with_session_key()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solnlib.modular_input.event_writer.HECEventWriter.write_events" class="md-nav__link">
    write_events()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="event_writerpy">event_writer.py<a class="headerlink" href="#event_writerpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.modular_input.event_writer"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides two kinds of event writers (ClassicEventWriter,
HECEventWriter) to write Splunk modular input events.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="solnlib.modular_input.event_writer.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ClassicEventWriter&#39;</span><span class="p">,</span> <span class="s1">&#39;HECEventWriter&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="solnlib.modular_input.event_writer.deprecation_msg" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">deprecation_msg</span> <span class="o">=</span> <span class="s2">&quot;Function &#39;create_from_token&#39; is deprecated and incompatible with &#39;global_settings_schema=True&#39;. Use &#39;create_from_token_with_session_key&#39; instead.&quot;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.deprecation_msg" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="solnlib.modular_input.event_writer.ClassicEventWriter" class="doc doc-heading">
        <code>ClassicEventWriter</code>


<a href="#solnlib.modular_input.event_writer.ClassicEventWriter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="solnlib.modular_input.event_writer.EventWriter" href="#solnlib.modular_input.event_writer.EventWriter">EventWriter</a></code></p>

  
      <p>Classic event writer.</p>
<p>Use sys.stdout as the output.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">event_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">ClassicEventWriter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span><span class="o">.</span><span class="n">write_events</span><span class="p">([</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">])</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ClassicEventWriter</span><span class="p">(</span><span class="n">EventWriter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classic event writer.</span>

<span class="sd">    Use sys.stdout as the output.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">        &gt;&gt;&gt; ew = event_writer.ClassicEventWriter()</span>
<span class="sd">        &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;ClassicEventWriter&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lock</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ClassicEventWriter.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            lock: (optional) lock to exclusively access stdout.</span>
<span class="sd">                by default, it is None and it will use threading safe lock.</span>
<span class="sd">                if user would like to make the lock multiple-process safe, user should</span>
<span class="sd">                pass in multiprocessing.Lock() instead</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">lock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">lock</span>

    <span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new XMLEvent object.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">XMLEvent</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
            <span class="n">stanza</span><span class="o">=</span><span class="n">stanza</span><span class="p">,</span>
            <span class="n">unbroken</span><span class="o">=</span><span class="n">unbroken</span><span class="p">,</span>
            <span class="n">done</span><span class="o">=</span><span class="n">done</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">XMLEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">)])</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.ClassicEventWriter.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;ClassicEventWriter&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.ClassicEventWriter.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.ClassicEventWriter.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">lock</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#solnlib.modular_input.event_writer.ClassicEventWriter.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ClassicEventWriter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lock</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[threading.<span title="threading.Lock">Lock</span>, multiprocessing.<span title="multiprocessing.Lock">Lock</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) lock to exclusively access stdout.
by default, it is None and it will use threading safe lock.
if user would like to make the lock multiple-process safe, user should
pass in multiprocessing.Lock() instead</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lock</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ClassicEventWriter.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        lock: (optional) lock to exclusively access stdout.</span>
<span class="sd">            by default, it is None and it will use threading safe lock.</span>
<span class="sd">            if user would like to make the lock multiple-process safe, user should</span>
<span class="sd">            pass in multiprocessing.Lock() instead</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">lock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">lock</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.ClassicEventWriter.create_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#solnlib.modular_input.event_writer.ClassicEventWriter.create_event" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new XMLEvent object.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new XMLEvent object.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">XMLEvent</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
        <span class="n">stanza</span><span class="o">=</span><span class="n">stanza</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="o">=</span><span class="n">unbroken</span><span class="p">,</span>
        <span class="n">done</span><span class="o">=</span><span class="n">done</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.ClassicEventWriter.write_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">write_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span></code>

<a href="#solnlib.modular_input.event_writer.ClassicEventWriter.write_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

    <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">XMLEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">)])</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="solnlib.modular_input.event_writer.EventWriter" class="doc doc-heading">
        <code>EventWriter</code>


<a href="#solnlib.modular_input.event_writer.EventWriter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Base class of event writer.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EventWriter</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class of event writer.&quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;EventWriter&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">XMLEvent</span><span class="p">,</span> <span class="n">HECEvent</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new event.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data: Event data.</span>
<span class="sd">            time: (optional) Event timestamp, default is None.</span>
<span class="sd">            index: (optional) The index event will be written to, default is None.</span>
<span class="sd">            host: (optional) Event host, default is None.</span>
<span class="sd">            source: (optional) Event source, default is None.</span>
<span class="sd">            sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">            fields: (optional) Event fields, default is None.</span>
<span class="sd">            stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">            unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">            done: (optional) The last unbroken event, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; ew = event_writer.HECEventWriter(...)</span>
<span class="sd">           &gt;&gt;&gt; event = ew.create_event(</span>
<span class="sd">           &gt;&gt;&gt;     data=&#39;This is a test data.&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     time=&#39;%.3f&#39; % 1372274622.493,</span>
<span class="sd">           &gt;&gt;&gt;     index=&#39;main&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     host=&#39;localhost&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     source=&#39;Splunk&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     sourcetype=&#39;misc&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     fields={&#39;accountid&#39;: &#39;603514901691&#39;, &#39;Cloud&#39;: u&#39;AWS&#39;},</span>
<span class="sd">           &gt;&gt;&gt;     stanza=&#39;test_scheme://test&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     unbroken=True,</span>
<span class="sd">           &gt;&gt;&gt;     done=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write events.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events to write.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">           &gt;&gt;&gt; ew = event_writer.EventWriter(...)</span>
<span class="sd">           &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.EventWriter.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;EventWriter&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.EventWriter.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.EventWriter.create_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.EventWriter.create_event" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new event.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event timestamp, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The index event will be written to, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event host, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event source, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sourcetype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event sourcetype, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fields</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event fields, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event stanza name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>unbroken</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event unbroken flag, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>done</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The last unbroken event, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">HECEventWriter</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="n">ew</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span><span class="o">=</span><span class="s1">&#39;This is a test data.&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">time</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">1372274622.493</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Splunk&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sourcetype</span><span class="o">=</span><span class="s1">&#39;misc&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;accountid&#39;</span><span class="p">:</span> <span class="s1">&#39;603514901691&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloud&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;AWS&#39;</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stanza</span><span class="o">=</span><span class="s1">&#39;test_scheme://test&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">unbroken</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">done</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">XMLEvent</span><span class="p">,</span> <span class="n">HECEvent</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new event.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data: Event data.</span>
<span class="sd">        time: (optional) Event timestamp, default is None.</span>
<span class="sd">        index: (optional) The index event will be written to, default is None.</span>
<span class="sd">        host: (optional) Event host, default is None.</span>
<span class="sd">        source: (optional) Event source, default is None.</span>
<span class="sd">        sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">        fields: (optional) Event fields, default is None.</span>
<span class="sd">        stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">        unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">        done: (optional) The last unbroken event, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; ew = event_writer.HECEventWriter(...)</span>
<span class="sd">       &gt;&gt;&gt; event = ew.create_event(</span>
<span class="sd">       &gt;&gt;&gt;     data=&#39;This is a test data.&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     time=&#39;%.3f&#39; % 1372274622.493,</span>
<span class="sd">       &gt;&gt;&gt;     index=&#39;main&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     host=&#39;localhost&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     source=&#39;Splunk&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     sourcetype=&#39;misc&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     fields={&#39;accountid&#39;: &#39;603514901691&#39;, &#39;Cloud&#39;: u&#39;AWS&#39;},</span>
<span class="sd">       &gt;&gt;&gt;     stanza=&#39;test_scheme://test&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     unbroken=True,</span>
<span class="sd">       &gt;&gt;&gt;     done=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.EventWriter.write_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">write_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.EventWriter.write_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Write events.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span title="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events to write.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">event_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">EventWriter</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span><span class="o">.</span><span class="n">write_events</span><span class="p">([</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">])</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write events.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events to write.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">       &gt;&gt;&gt; ew = event_writer.EventWriter(...)</span>
<span class="sd">       &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="solnlib.modular_input.event_writer.FunctionDeprecated" class="doc doc-heading">
        <code>FunctionDeprecated</code>


<a href="#solnlib.modular_input.event_writer.FunctionDeprecated" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>Exception</code></p>



        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FunctionDeprecated</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="solnlib.modular_input.event_writer.HECEventWriter" class="doc doc-heading">
        <code>HECEventWriter</code>


<a href="#solnlib.modular_input.event_writer.HECEventWriter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="solnlib.modular_input.event_writer.EventWriter" href="#solnlib.modular_input.event_writer.EventWriter">EventWriter</a></code></p>

  
      <p>HEC event writer.</p>
<p>Use Splunk HEC as the output.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">event_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">HECEventWriter</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span><span class="o">.</span><span class="n">write_events</span><span class="p">([</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">])</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HECEventWriter</span><span class="p">(</span><span class="n">EventWriter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;HEC event writer.</span>

<span class="sd">    Use Splunk HEC as the output.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">        &gt;&gt;&gt; ew = event_writer.HECEventWriter(hec_input_name, session_key)</span>
<span class="sd">        &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">WRITE_EVENT_RETRIES</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">HTTP_INPUT_CONFIG_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/servicesNS/nobody/splunk_httpinput/data/inputs/http&quot;</span>
    <span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/services/collector&quot;</span>
    <span class="n">TOO_MANY_REQUESTS</span> <span class="o">=</span> <span class="mi">429</span>  <span class="c1"># we exceeded rate limit</span>
    <span class="n">SERVICE_UNAVAILABLE</span> <span class="o">=</span> <span class="mi">503</span>  <span class="c1"># remote service is temporary unavailable</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;HECEventWriter&quot;</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes HECEventWriter.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            hec_input_name: Splunk HEC input name.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            hec_uri: (optional) If hec_uri and hec_token are provided, they will</span>
<span class="sd">                higher precedence than hec_input_name.</span>
<span class="sd">            hec_token: (optional) HEC token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            logger: Logger object.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span>

        <span class="k">if</span> <span class="n">hec_uri</span> <span class="ow">and</span> <span class="n">hec_token</span><span class="p">:</span>
            <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">hec_port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">hec_uri</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
                <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>
            <span class="n">hec_port</span><span class="p">,</span> <span class="n">hec_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hec_config</span><span class="p">(</span>
                <span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
            <span class="n">scheme</span> <span class="o">=</span> <span class="n">get_scheme_from_hec_settings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">hec_token</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hec_port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_from_token</span><span class="p">(</span>
        <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given HEC URI and HEC token, create HECEventWriter object. This</span>
<span class="sd">        function simplifies the standalone mode HECEventWriter usage (not in a</span>
<span class="sd">        modinput).</span>

<span class="sd">        Arguments:</span>
<span class="sd">            hec_uri: HTTP Event Collector URI, like https://localhost:8088.</span>
<span class="sd">            hec_token: HTTP Event Collector token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            context: Other configurations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEventWriter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FunctionDeprecated</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
            <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
            <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_from_input</span><span class="p">(</span>
        <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given HEC input stanza name, splunkd URI and splunkd session key,</span>
<span class="sd">        create HECEventWriter object. HEC URI and token etc will be discovered</span>
<span class="sd">        from HEC input stanza. When hitting HEC event limit, the underlying</span>
<span class="sd">        code will increase the HEC event limit automatically by calling</span>
<span class="sd">        corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            hec_input_name: Splunk HEC input name.</span>
<span class="sd">            splunkd_uri: Splunkd URI, like https://localhost:8089</span>
<span class="sd">            session_key: Splunkd access token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            context: Other configurations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEventWriter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
            <span class="n">hec_input_name</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_from_token_with_session_key</span><span class="p">(</span>
        <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given Splunkd URI, Splunkd session key, HEC URI and HEC token,</span>
<span class="sd">        create HECEventWriter object. When hitting HEC event limit, the event</span>
<span class="sd">        writer will increase the HEC event limit automatically by calling</span>
<span class="sd">        corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            splunkd_uri: Splunkd URI, like https://localhost:8089.</span>
<span class="sd">            session_key: Splunkd access token.</span>
<span class="sd">            hec_uri: Http Event Collector URI, like https://localhost:8088.</span>
<span class="sd">            hec_token: Http Event Collector token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            context: Other configurations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEventWriter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
            <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
            <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_get_hec_config</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">):</span>
        <span class="n">hc</span> <span class="o">=</span> <span class="n">HECConfig</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">)):</span>
            <span class="c1"># Enable HEC input</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Enabling HEC&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;disabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
            <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;enableSSL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hec_enablessl&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hec_port&quot;</span><span class="p">,</span> <span class="s2">&quot;8088&quot;</span><span class="p">)</span>
            <span class="n">hc</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>

        <span class="n">hec_input</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">get_input</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hec_input</span><span class="p">:</span>
            <span class="c1"># Create HEC input</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Create HEC datainput, name=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">hec_input_name</span><span class="p">)</span>
            <span class="n">hinput</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;token&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;host&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span>

            <span class="n">hec_input</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">create_input</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">hinput</span><span class="p">)</span>

        <span class="n">limits</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">get_limits</span><span class="p">()</span>
        <span class="n">HECEvent</span><span class="o">.</span><span class="n">max_hec_event_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">limits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_content_length&quot;</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span> <span class="n">hec_input</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HECEvent</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new HECEvent object.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data: Event data.</span>
<span class="sd">            time: (optional) Event timestamp, default is None.</span>
<span class="sd">            index: (optional) The index event will be written to, default is None.</span>
<span class="sd">            host: (optional) Event host, default is None.</span>
<span class="sd">            source: (optional) Event source, default is None.</span>
<span class="sd">            sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">            fields: (optional) Event fields, default is None.</span>
<span class="sd">            stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">            unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">            done: (optional) The last unbroken event, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEvent.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">HECEvent</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
            <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
        <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">WRITE_EVENT_RETRIES</span><span class="p">,</span>
        <span class="n">event_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write events to index in bulk.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events.</span>
<span class="sd">            retries: Number of retries for writing events to index.</span>
<span class="sd">            event_field: Event field.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">HECEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">event_field</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">retries</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span><span class="p">,</span>
                        <span class="n">body</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="s2">&quot;Write events through HEC failed. Status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span>
                    <span class="p">)</span>
                    <span class="n">last_ex</span> <span class="o">=</span> <span class="n">e</span>
                    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOO_MANY_REQUESTS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SERVICE_UNAVAILABLE</span><span class="p">]:</span>
                        <span class="c1"># wait time for n retries: 10, 20, 40, 80, 80, 80, 80, ....</span>
                        <span class="n">sleep_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">random_millisecond</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span> <span class="o">+</span> <span class="n">random_millisecond</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">last_ex</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># When failed after retry, we reraise the exception</span>
                <span class="c1"># to exit the function to let client handle this situation</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Write events through HEC failed: </span><span class="si">%s</span><span class="s2">. status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                    <span class="n">last_ex</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">last_ex</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.HTTP_EVENT_COLLECTOR_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/services/collector&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.HTTP_EVENT_COLLECTOR_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.HTTP_INPUT_CONFIG_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">HTTP_INPUT_CONFIG_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/servicesNS/nobody/splunk_httpinput/data/inputs/http&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.HTTP_INPUT_CONFIG_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.SERVICE_UNAVAILABLE" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">SERVICE_UNAVAILABLE</span> <span class="o">=</span> <span class="mi">503</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.SERVICE_UNAVAILABLE" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.TOO_MANY_REQUESTS" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">TOO_MANY_REQUESTS</span> <span class="o">=</span> <span class="mi">429</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.TOO_MANY_REQUESTS" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.WRITE_EVENT_RETRIES" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">WRITE_EVENT_RETRIES</span> <span class="o">=</span> <span class="mi">5</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.WRITE_EVENT_RETRIES" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;HECEventWriter&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.headers" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.headers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.logger" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.logger" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hec_uri</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hec_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes HECEventWriter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hec_input_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk HEC input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hec_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) If hec_uri and hec_token are provided, they will
higher precedence than hec_input_name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hec_token</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) HEC token.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code>logging.<span title="logging.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logger object.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes HECEventWriter.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hec_input_name: Splunk HEC input name.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        hec_uri: (optional) If hec_uri and hec_token are provided, they will</span>
<span class="sd">            higher precedence than hec_input_name.</span>
<span class="sd">        hec_token: (optional) HEC token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        logger: Logger object.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span>

    <span class="k">if</span> <span class="n">hec_uri</span> <span class="ow">and</span> <span class="n">hec_token</span><span class="p">:</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">hec_port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">hec_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
            <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>
        <span class="n">hec_port</span><span class="p">,</span> <span class="n">hec_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hec_config</span><span class="p">(</span>
            <span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="n">get_scheme_from_hec_settings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">):</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">):</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">hec_token</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hec_port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.create_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.create_event" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new HECEvent object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event timestamp, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The index event will be written to, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event host, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event source, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sourcetype</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event sourcetype, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fields</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event fields, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event stanza name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>unbroken</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event unbroken flag, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>done</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The last unbroken event, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="solnlib.modular_input.event.HECEvent" href="../event/#solnlib.modular_input.event.HECEvent">HECEvent</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEvent.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HECEvent</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new HECEvent object.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data: Event data.</span>
<span class="sd">        time: (optional) Event timestamp, default is None.</span>
<span class="sd">        index: (optional) The index event will be written to, default is None.</span>
<span class="sd">        host: (optional) Event host, default is None.</span>
<span class="sd">        source: (optional) Event source, default is None.</span>
<span class="sd">        sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">        fields: (optional) Event fields, default is None.</span>
<span class="sd">        stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">        unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">        done: (optional) The last unbroken event, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEvent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">HECEvent</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
        <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.create_from_input" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_from_input</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">splunkd_uri</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given HEC input stanza name, splunkd URI and splunkd session key,
create HECEventWriter object. HEC URI and token etc will be discovered
from HEC input stanza. When hitting HEC event limit, the underlying
code will increase the HEC event limit automatically by calling
corresponding REST API against splunkd_uri by using session_key.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hec_input_name</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk HEC input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>splunkd_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd URI, like https://localhost:8089</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="solnlib.modular_input.event_writer.HECEventWriter" href="#solnlib.modular_input.event_writer.HECEventWriter">HECEventWriter</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEventWriter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_from_input</span><span class="p">(</span>
    <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given HEC input stanza name, splunkd URI and splunkd session key,</span>
<span class="sd">    create HECEventWriter object. HEC URI and token etc will be discovered</span>
<span class="sd">    from HEC input stanza. When hitting HEC event limit, the underlying</span>
<span class="sd">    code will increase the HEC event limit automatically by calling</span>
<span class="sd">    corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hec_input_name: Splunk HEC input name.</span>
<span class="sd">        splunkd_uri: Splunkd URI, like https://localhost:8089</span>
<span class="sd">        session_key: Splunkd access token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        context: Other configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEventWriter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
        <span class="n">hec_input_name</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.create_from_token" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_from_token</span><span class="p">(</span><span class="n">hec_uri</span><span class="p">,</span> <span class="n">hec_token</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_token" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given HEC URI and HEC token, create HECEventWriter object. This
function simplifies the standalone mode HECEventWriter usage (not in a
modinput).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hec_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP Event Collector URI, like https://localhost:8088.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hec_token</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP Event Collector token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="solnlib.modular_input.event_writer.HECEventWriter" href="#solnlib.modular_input.event_writer.HECEventWriter">HECEventWriter</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEventWriter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_from_token</span><span class="p">(</span>
    <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given HEC URI and HEC token, create HECEventWriter object. This</span>
<span class="sd">    function simplifies the standalone mode HECEventWriter usage (not in a</span>
<span class="sd">    modinput).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hec_uri: HTTP Event Collector URI, like https://localhost:8088.</span>
<span class="sd">        hec_token: HTTP Event Collector token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        context: Other configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEventWriter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FunctionDeprecated</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.create_from_token_with_session_key" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_from_token_with_session_key</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">hec_uri</span><span class="p">,</span> <span class="n">hec_token</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.create_from_token_with_session_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given Splunkd URI, Splunkd session key, HEC URI and HEC token,
create HECEventWriter object. When hitting HEC event limit, the event
writer will increase the HEC event limit automatically by calling
corresponding REST API against splunkd_uri by using session_key.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>splunkd_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd URI, like https://localhost:8089.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hec_uri</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Http Event Collector URI, like https://localhost:8088.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hec_token</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Http Event Collector token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="solnlib.modular_input.event_writer.HECEventWriter" href="#solnlib.modular_input.event_writer.HECEventWriter">HECEventWriter</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEventWriter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_from_token_with_session_key</span><span class="p">(</span>
    <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given Splunkd URI, Splunkd session key, HEC URI and HEC token,</span>
<span class="sd">    create HECEventWriter object. When hitting HEC event limit, the event</span>
<span class="sd">    writer will increase the HEC event limit automatically by calling</span>
<span class="sd">    corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        splunkd_uri: Splunkd URI, like https://localhost:8089.</span>
<span class="sd">        session_key: Splunkd access token.</span>
<span class="sd">        hec_uri: Http Event Collector URI, like https://localhost:8088.</span>
<span class="sd">        hec_token: Http Event Collector token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        context: Other configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEventWriter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="solnlib.modular_input.event_writer.HECEventWriter.write_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">write_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="n">WRITE_EVENT_RETRIES</span><span class="p">,</span> <span class="n">event_field</span><span class="o">=</span><span class="s1">&#39;event&#39;</span><span class="p">)</span></code>

<a href="#solnlib.modular_input.event_writer.HECEventWriter.write_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Write events to index in bulk.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span title="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>retries</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of retries for writing events to index.</p>
            </div>
          </td>
          <td>
                <code>WRITE_EVENT_RETRIES</code>
          </td>
        </tr>
        <tr>
          <td><code>event_field</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event field.</p>
            </div>
          </td>
          <td>
                <code>&#39;event&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
    <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">WRITE_EVENT_RETRIES</span><span class="p">,</span>
    <span class="n">event_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write events to index in bulk.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events.</span>
<span class="sd">        retries: Number of retries for writing events to index.</span>
<span class="sd">        event_field: Event field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">HECEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">event_field</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">retries</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span><span class="p">,</span>
                    <span class="n">body</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Write events through HEC failed. Status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span>
                <span class="p">)</span>
                <span class="n">last_ex</span> <span class="o">=</span> <span class="n">e</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOO_MANY_REQUESTS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SERVICE_UNAVAILABLE</span><span class="p">]:</span>
                    <span class="c1"># wait time for n retries: 10, 20, 40, 80, 80, 80, 80, ....</span>
                    <span class="n">sleep_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">random_millisecond</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span> <span class="o">+</span> <span class="n">random_millisecond</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">last_ex</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># When failed after retry, we reraise the exception</span>
            <span class="c1"># to exit the function to let client handle this situation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Write events through HEC failed: </span><span class="si">%s</span><span class="s2">. status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                <span class="n">last_ex</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">last_ex</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
    
  </body>
</html>