
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>Print Site - Splunk Solutions SDK</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("/",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!-- Source:
https://github.com/squidfunk/mkdocs-material/blob/master/src/templates/partials/header.html
-->



  


<!-- Header -->
<header class="md-header md-header--shadow" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="Header"
  >

    <!-- Link to home -->
    <a
      href=".."
      title="Splunk Solutions SDK"
      class="md-header__button md-logo"
      aria-label="Splunk Solutions SDK"
      data-md-component="logo"
    >
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Splunk Solutions SDK
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>

    

    <!-- Color palette toggle -->
    
      
    

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
  </nav>

  <!-- Navigation tabs (sticky) -->
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Splunk Solutions SDK" class="md-nav__button md-logo" aria-label="Splunk Solutions SDK" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Splunk Solutions SDK
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../release_6_0_0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release 6.0.0
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../release_7_0_0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release 7.0.0
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    References
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    modular_input
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            modular_input
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../modular_input/checkpointer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    checkpointer.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../modular_input/event/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../modular_input/event_writer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    event_writer.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../modular_input/modular_input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    modular_input.py
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../acl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    acl.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    credentials.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../conf_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conf_manager.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../file_monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    file_monitor.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../hec_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hec_config.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../log/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    log.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../net_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    net_utils.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../orphan_process_monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    orphan_process_monitor.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../pattern/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pattern.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../server_info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    server_info.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../splunk_rest_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    splunk_rest_client.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../bulletin_rest_client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    bulletin_rest_client.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../splunkenv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    splunkenv.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../time_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    time_parser.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../timer_queue/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timer_queue.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../user_access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    user_access.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils.py
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#" class="md-nav__link">
    1. Home
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#release_6_0_0" class="md-nav__link">
    2. Release 6.0.0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#release_7_0_0" class="md-nav__link">
    3. Release 7.0.0
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-references" class="md-nav__link">
    I. References
  </a>
  
    <nav class="md-nav" aria-label="I. References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acl" class="md-nav__link">
    4. acl.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#credentials" class="md-nav__link">
    5. credentials.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conf_manager" class="md-nav__link">
    6. conf_manager.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file_monitor" class="md-nav__link">
    7. file_monitor.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hec_config" class="md-nav__link">
    8. hec_config.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log" class="md-nav__link">
    9. log.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#net_utils" class="md-nav__link">
    10. net_utils.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orphan_process_monitor" class="md-nav__link">
    11. orphan_process_monitor.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pattern" class="md-nav__link">
    12. pattern.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#server_info" class="md-nav__link">
    13. server_info.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splunk_rest_client" class="md-nav__link">
    14. splunk_rest_client.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulletin_rest_client" class="md-nav__link">
    15. bulletin_rest_client.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#splunkenv" class="md-nav__link">
    16. splunkenv.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time_parser" class="md-nav__link">
    17. time_parser.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timer_queue" class="md-nav__link">
    18. timer_queue.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user_access" class="md-nav__link">
    19. user_access.py
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utils" class="md-nav__link">
    20. utils.py
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index"><h1 id="index-overview">Overview<a class="headerlink" href="#index-overview" title="Permanent link">&para;</a></h1>
<p>Splunk Solutions SDK is an open source packaged solution for getting data into Splunk using modular inputs.
This SDK is used by Splunk Add-on builder, and Splunk UCC based add-ons and is intended for use by partner
developers. This SDK/Library extends the Splunk SDK for Python.</p>
<blockquote>
<p>Note: this project uses <code>poetry</code> 1.5.1.</p>
</blockquote></section><section class="print-page" id="release_6_0_0"><h1 id="release_6_0_0-removed-requests-and-urllib3-from-solnlib">Removed requests and urllib3 from solnlib<a class="headerlink" href="#release_6_0_0-removed-requests-and-urllib3-from-solnlib" title="Permanent link">&para;</a></h1>
<p>The <code>requests</code> and <code>urllib3</code> libraries has been removed from solnlib, so solnlib now depends on the <code>requests</code> and <code>urllib3</code> libraries from the running environment.
By default, Splunk delivers the above libraries and their version depends on the Splunk version. More information <a href="https://docs.splunk.com/Documentation/Splunk/9.2.3/ReleaseNotes/Credits">here</a>.</p>
<p><strong>IMPORTANT</strong>: <code>urllib3</code> is available in Splunk <code>v8.1.0</code> and later</p>
<p>Please note that if <code>requests</code> or <code>urllib3</code> are installed in <code>&lt;Add-on&gt;/lib</code> e.g. as a dependency of another library, that version will be taken first.
If <code>requests</code> or <code>urllib3</code> is missing in the add-on&rsquo;s <code>lib</code> directory, the version provided by Splunk will be used.</p>
<h2 id="release_6_0_0-custom-version-of-requests-and-urllib3">Custom Version of requests and urllib3<a class="headerlink" href="#release_6_0_0-custom-version-of-requests-and-urllib3" title="Permanent link">&para;</a></h2>
<p>In case the Splunk&rsquo;s <code>requests</code> or <code>urllib3</code> version is not sufficient for you, 
you can deliver version you need by simply adding it to the <code>requirements.txt</code> or <code>pyproject.toml</code> file in your add-on.</p>
<h2 id="release_6_0_0-use-solnlib-outside-the-splunk">Use solnlib outside the Splunk<a class="headerlink" href="#release_6_0_0-use-solnlib-outside-the-splunk" title="Permanent link">&para;</a></h2>
<p><strong>Solnlib</strong> no longer provides <code>requests</code> and <code>urllib3</code> so if you want to use <strong>solnlib</strong> outside the Splunk, please note that you will need to
provide these libraries yourself in the environment where <strong>solnlib</strong> is used.</p></section><section class="print-page" id="release_7_0_0"><h1 id="release_7_0_0-removed-usage-of-btool-command-from-solnlib">Removed usage of btool command from solnlib<a class="headerlink" href="#release_7_0_0-removed-usage-of-btool-command-from-solnlib" title="Permanent link">&para;</a></h1>
<p>As of version 7.0.0, the <code>btool</code> command has been removed from solnlib. Configuration stanzas and keys should now be accessed via the REST API. 
Additionally, the <code>splunkenv</code> module can only be used in environments where Splunk is installed, as it relies on Splunk-specific methods for making internal calls.</p>
<h2 id="release_7_0_0-session-key-is-now-mandatory-in-some-of-the-functions">Session key is now mandatory in some of the functions<a class="headerlink" href="#release_7_0_0-session-key-is-now-mandatory-in-some-of-the-functions" title="Permanent link">&para;</a></h2>
<p>The affected functions now require a valid <code>session_key</code> to operate correctly. While solnlib attempts to retrieve the <code>session_key</code> automatically, 
there are scenarios—such as within a modular input script—where this is not possible. In such cases, you must explicitly provide the <code>session_key</code> 
to ensure proper authorization. Affected functions are:</p>
<ul>
<li><code>get_splunk_host_info</code></li>
<li><code>get_splunkd_access_info</code></li>
<li><code>get_scheme_from_hec_settings</code></li>
<li><code>get_splunkd_uri</code></li>
<li><code>get_conf_key_value</code></li>
<li><code>get_conf_stanza</code></li>
</ul>
<h2 id="release_7_0_0-changed-arguments-in-get_conf_key_value-and-get_conf_stanza">Changed arguments in <code>get_conf_key_value</code> and <code>get_conf_stanza</code><a class="headerlink" href="#release_7_0_0-changed-arguments-in-get_conf_key_value-and-get_conf_stanza" title="Permanent link">&para;</a></h2>
<p>As of version 7.0.0, the following changes have been made to the function:</p>
<p><code>get_conf_key_value</code> now requires 4 mandatory arguments:</p>
<ul>
<li><code>conf_name</code></li>
<li><code>stanza</code></li>
<li><code>key</code></li>
<li><code>app_name</code> (new)</li>
</ul>
<p><code>get_conf_stanza</code> now requires 3 mandatory arguments:</p>
<ul>
<li><code>conf_name</code></li>
<li><code>stanza</code></li>
<li><code>app_name</code> (new)</li>
</ul>
<p>Both functions also accept the following optional arguments:</p>
<ul>
<li><code>session_key</code> - Used for authentication. If not provided, a 401 Unauthorized error may occur depending on the context.</li>
<li><code>users</code> - Limits results returned by the configuration endpoint. Defaults to <code>nobody</code>.</li>
<li><code>raw_output</code> - If set to <code>True</code>, the full decoded JSON response is returned. 
This should be enabled when <code>app_name</code> is set to the global context <code>(/-/)</code>, as the Splunk REST API may return multiple entries in that case.</li>
</ul>
<h2 id="release_7_0_0-the-get_session_key-function-has-been-removed-from-solnlib">The <code>get_session_key</code> function has been removed from solnlib<a class="headerlink" href="#release_7_0_0-the-get_session_key-function-has-been-removed-from-solnlib" title="Permanent link">&para;</a></h2>
<p>This function relied on reading the <code>scheme</code>, <code>host</code> and <code>port</code> using the deprecated btool utility, which is no longer supported.</p></section>
                        <h1 class='nav-section-title' id='section-references'>
                            References <a class='headerlink' href='#section-references' title='Permanent link'>↵</a>
                        </h1>
                        
                        <h2 class='nav-section-title' id='section-modular_input'>
                            modular_input <a class='headerlink' href='#section-modular_input' title='Permanent link'>↵</a>
                        </h2>
                        <section class="print-page" id="modular_input-checkpointer"><h1 id="modular_input-checkpointer-checkpointerpy">checkpointer.py<a class="headerlink" href="#modular_input-checkpointer-checkpointerpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.modular_input.checkpointer"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides two kinds of checkpointer: KVStoreCheckpointer,
FileCheckpointer for modular input to save checkpoint.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CheckpointerException&#39;</span><span class="p">,</span> <span class="s1">&#39;KVStoreCheckpointer&#39;</span><span class="p">,</span> <span class="s1">&#39;FileCheckpointer&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer" class="doc doc-heading">
        <code>Checkpointer</code>


<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Base class of checkpointer.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Checkpointer</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class of checkpointer.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates document with an id that equals to `key` and `state` as</span>
<span class="sd">        document data.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">batch_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates multiple documents.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets document with an id that equals to `key`.&quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes document with an id that equals to `key`.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.batch_update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">batch_update</span><span class="p">(</span><span class="n">states</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.batch_update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates multiple documents.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">batch_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates multiple documents.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.delete" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.delete" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deletes document with an id that equals to <code>key</code>.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes document with an id that equals to `key`.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.get" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Gets document with an id that equals to <code>key</code>.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets document with an id that equals to `key`.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.Checkpointer.update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates document with an id that equals to <code>key</code> and <code>state</code> as
document data.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates document with an id that equals to `key` and `state` as</span>
<span class="sd">    document data.&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.CheckpointerException" class="doc doc-heading">
        <code>CheckpointerException</code>


<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.CheckpointerException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>



        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CheckpointerException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer" class="doc doc-heading">
        <code>FileCheckpointer</code>


<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="solnlib.modular_input.checkpointer.Checkpointer">Checkpointer</span></code></p>

  
      <p>File checkpointer.</p>
<p>Use file to save modular input checkpoint.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">checkpointer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ck</span> <span class="o">=</span> <span class="n">checkpointer</span><span class="o">.</span><span class="n">FileCheckpointer</span><span class="p">(</span><span class="s1">&#39;/opt/splunk/var/...&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ck</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ck</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileCheckpointer</span><span class="p">(</span><span class="n">Checkpointer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;File checkpointer.</span>

<span class="sd">    Use file to save modular input checkpoint.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib.modular_input import checkpointer</span>
<span class="sd">        &gt;&gt;&gt; ck = checkpointer.FileCheckpointer(&#39;/opt/splunk/var/...&#39;)</span>
<span class="sd">        &gt;&gt;&gt; ck.update(...)</span>
<span class="sd">        &gt;&gt;&gt; ck.get(...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checkpoint_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes FileCheckpointer.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            checkpoint_dir: Checkpoint directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;FileCheckpointer is deprecated, please use KVStoreCheckpointer&quot;</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span> <span class="o">=</span> <span class="n">checkpoint_dir</span>

    <span class="k">def</span> <span class="nf">encode_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_new&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_new&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">batch_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;_key&quot;</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">checkpoint_dir</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes FileCheckpointer.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>checkpoint_dir</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Checkpoint directory.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">checkpoint_dir</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes FileCheckpointer.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        checkpoint_dir: Checkpoint directory.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;FileCheckpointer is deprecated, please use KVStoreCheckpointer&quot;</span><span class="p">,</span>
        <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span> <span class="o">=</span> <span class="n">checkpoint_dir</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.batch_update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">batch_update</span><span class="p">(</span><span class="n">states</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.batch_update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">batch_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;_key&quot;</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.delete" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.delete" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.encode_key" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.encode_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">encode_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.get" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.FileCheckpointer.update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_key</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_new&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">op</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;_new&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer" class="doc doc-heading">
        <code>KVStoreCheckpointer</code>


<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="solnlib.modular_input.checkpointer.Checkpointer">Checkpointer</span></code></p>

  
      <p>KVStore checkpointer.</p>
<p>Use KVStore to save modular input checkpoint.</p>
<p>More information about KV Store in Splunk is
<a href="https://dev.splunk.com/enterprise/docs/developapps/manageknowledge/kvstore/aboutkvstorecollections">here</a>.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">checkpointer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">checkpointer</span><span class="o">.</span><span class="n">KVStoreCheckpointer</span><span class="p">(</span>
<span class="go">        &quot;unique_addon_checkpoints&quot;,</span>
<span class="go">        &quot;session_key&quot;,</span>
<span class="go">        &quot;unique_addon&quot;</span>
<span class="go">    )</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checkpoint</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;input_1&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="mi">1638043093</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">checkpoint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;input_1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># returns {&quot;timestamp&quot;: 1638043093}</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">KVStoreCheckpointer</span><span class="p">(</span><span class="n">Checkpointer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;KVStore checkpointer.</span>

<span class="sd">    Use KVStore to save modular input checkpoint.</span>

<span class="sd">    More information about KV Store in Splunk is</span>
<span class="sd">    [here](https://dev.splunk.com/enterprise/docs/developapps/manageknowledge/kvstore/aboutkvstorecollections).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib.modular_input import checkpointer</span>
<span class="sd">        &gt;&gt;&gt; checkpoint = checkpointer.KVStoreCheckpointer(</span>
<span class="sd">                &quot;unique_addon_checkpoints&quot;,</span>
<span class="sd">                &quot;session_key&quot;,</span>
<span class="sd">                &quot;unique_addon&quot;</span>
<span class="sd">            )</span>
<span class="sd">        &gt;&gt;&gt; checkpoint.update(&quot;input_1&quot;, {&quot;timestamp&quot;: 1638043093})</span>
<span class="sd">        &gt;&gt;&gt; checkpoint.get(&quot;input_1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; # returns {&quot;timestamp&quot;: 1638043093}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes KVStoreCheckpointer.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            collection_name: Collection name of kvstore checkpointer.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: HTTP error different from 404, for example 503</span>
<span class="sd">                when KV Store is initializing and not ready to serve requests.</span>
<span class="sd">            CheckpointerException: If init KV Store checkpointer failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">):</span>
                <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">):</span>
                <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">get_collection_data</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="p">,</span>
                <span class="n">session_key</span><span class="p">,</span>
                <span class="n">app</span><span class="p">,</span>
                <span class="n">owner</span><span class="p">,</span>
                <span class="n">scheme</span><span class="p">,</span>
                <span class="n">host</span><span class="p">,</span>
                <span class="n">port</span><span class="p">,</span>
                <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
                <span class="o">**</span><span class="n">context</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CheckpointerException</span><span class="p">(</span><span class="s2">&quot;Get KV Store checkpointer failed.&quot;</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates document with an id that equals to `key` and `state` as</span>
<span class="sd">        document data.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            key: `id` of the document to update.</span>
<span class="sd">            state: Document data to update. It can be integer, string,</span>
<span class="sd">                or a dict, or anything that can be an argument to `json.dumps`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: when an error occurred in Splunk, for example,</span>
<span class="sd">                when Splunk is restarting and KV Store is not yet initialized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state</span><span class="p">)}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">batch_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates multiple documents.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            states: Iterable that contains documents to update. Document should</span>
<span class="sd">                be a dict with at least &quot;state&quot; key.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: when an error occurred in Splunk, for example,</span>
<span class="sd">                when Splunk is restarting and KV Store is not yet initialized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
            <span class="n">state</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="o">*</span><span class="n">states</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets document with an id that equals to `key`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            key: `id` of the document to get.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: When an error occurred in Splunk (not 404 code),</span>
<span class="sd">                can be 503 code, when Splunk is restarting and KV Store is not</span>
<span class="sd">                yet initialized.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Document data under `key` or `None` in case of no data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get checkpoint failed: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">])</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes document with an id that equals to `key`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            key: `id` of the document to delete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: When an error occurred in Splunk (not 404 code),</span>
<span class="sd">                can be 503 code, when Splunk is restarting and KV Store is not</span>
<span class="sd">                yet initialized.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Delete checkpoint failed: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">collection_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes KVStoreCheckpointer.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>collection_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection name of kvstore checkpointer.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP error different from 404, for example 503
when KV Store is initializing and not ready to serve requests.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.checkpointer.CheckpointerException">CheckpointerException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If init KV Store checkpointer failed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes KVStoreCheckpointer.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        collection_name: Collection name of kvstore checkpointer.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: HTTP error different from 404, for example 503</span>
<span class="sd">            when KV Store is initializing and not ready to serve requests.</span>
<span class="sd">        CheckpointerException: If init KV Store checkpointer failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">get_collection_data</span><span class="p">(</span>
            <span class="n">collection_name</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app</span><span class="p">,</span>
            <span class="n">owner</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span>
            <span class="o">**</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CheckpointerException</span><span class="p">(</span><span class="s2">&quot;Get KV Store checkpointer failed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.batch_update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">batch_update</span><span class="p">(</span><span class="n">states</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.batch_update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates multiple documents.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>states</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Iterable">Iterable</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.Any">Any</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Iterable that contains documents to update. Document should
be a dict with at least &ldquo;state&rdquo; key.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>when an error occurred in Splunk, for example,
when Splunk is restarting and KV Store is not yet initialized.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">batch_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">states</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates multiple documents.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        states: Iterable that contains documents to update. Document should</span>
<span class="sd">            be a dict with at least &quot;state&quot; key.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: when an error occurred in Splunk, for example,</span>
<span class="sd">            when Splunk is restarting and KV Store is not yet initialized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span>
        <span class="n">state</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="o">*</span><span class="n">states</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.delete" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.delete" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Deletes document with an id that equals to <code>key</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>id</code> of the document to delete.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When an error occurred in Splunk (not 404 code),
can be 503 code, when Splunk is restarting and KV Store is not
yet initialized.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes document with an id that equals to `key`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        key: `id` of the document to delete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: When an error occurred in Splunk (not 404 code),</span>
<span class="sd">            can be 503 code, when Splunk is restarting and KV Store is not</span>
<span class="sd">            yet initialized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Delete checkpoint failed: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.get" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Gets document with an id that equals to <code>key</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>id</code> of the document to get.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>When an error occurred in Splunk (not 404 code),
can be 503 code, when Splunk is restarting and KV Store is not
yet initialized.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Document data under <code>key</code> or <code>None</code> in case of no data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets document with an id that equals to `key`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        key: `id` of the document to get.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: When an error occurred in Splunk (not 404 code),</span>
<span class="sd">            can be 503 code, when Splunk is restarting and KV Store is not</span>
<span class="sd">            yet initialized.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Document data under `key` or `None` in case of no data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Get checkpoint failed: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span></code>

<a href="#modular_input-checkpointer-solnlib.modular_input.checkpointer.KVStoreCheckpointer.update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Updates document with an id that equals to <code>key</code> and <code>state</code> as
document data.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p><code>id</code> of the document to update.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>state</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Document data to update. It can be integer, string,
or a dict, or anything that can be an argument to <code>json.dumps</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>when an error occurred in Splunk, for example,
when Splunk is restarting and KV Store is not yet initialized.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/checkpointer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates document with an id that equals to `key` and `state` as</span>
<span class="sd">    document data.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        key: `id` of the document to update.</span>
<span class="sd">        state: Document data to update. It can be integer, string,</span>
<span class="sd">            or a dict, or anything that can be an argument to `json.dumps`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: when an error occurred in Splunk, for example,</span>
<span class="sd">            when Splunk is restarting and KV Store is not yet initialized.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state</span><span class="p">)}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="modular_input-event"><h1 id="modular_input-event-eventpy">event.py<a class="headerlink" href="#modular_input-event-eventpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.modular_input.event"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides Splunk modular input event encapsulation.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="modular_input-event-solnlib.modular_input.event.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;EventException&#39;</span><span class="p">,</span> <span class="s1">&#39;XMLEvent&#39;</span><span class="p">,</span> <span class="s1">&#39;HECEvent&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#modular_input-event-solnlib.modular_input.event.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="modular_input-event-solnlib.modular_input.event.Event" class="doc doc-heading">
        <code>Event</code>


<a href="#modular_input-event-solnlib.modular_input.event.Event" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Base class of modular input event.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Event</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class of modular input event.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modular input event.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data: Event data.</span>
<span class="sd">            time: (optional) Event timestamp, default is None.</span>
<span class="sd">            index: (optional) The index event will be written to, default is None.</span>
<span class="sd">            host: (optional) Event host, default is None.</span>
<span class="sd">            source: (optional) Event source, default is None.</span>
<span class="sd">            sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">            fields: (optional) Event fields, default is None.</span>
<span class="sd">            stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">            unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">            done: (optional) The last unbroken event, default is False.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; event = Event(</span>
<span class="sd">           &gt;&gt;&gt;     data=&#39;This is a test data.&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     time=1372274622.493,</span>
<span class="sd">           &gt;&gt;&gt;     index=&#39;main&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     host=&#39;localhost&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     source=&#39;Splunk&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     sourcetype=&#39;misc&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     fields= {&#39;Cloud&#39;:&#39;AWS&#39;,&#39;region&#39;: &#39;us-west-1&#39;},</span>
<span class="sd">           &gt;&gt;&gt;     stanza=&#39;test_scheme://test&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     unbroken=True,</span>
<span class="sd">           &gt;&gt;&gt;     done=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">time</span> <span class="k">if</span> <span class="n">time</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span> <span class="o">=</span> <span class="n">sourcetype</span>
        <span class="k">if</span> <span class="n">fields</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stanza</span> <span class="o">=</span> <span class="n">stanza</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unbroken</span> <span class="ow">and</span> <span class="n">done</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EventException</span><span class="p">(</span><span class="s1">&#39;Invalid combination of &quot;unbroken&quot; and &quot;done&quot;.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_unbroken</span> <span class="o">=</span> <span class="n">unbroken</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_done</span> <span class="o">=</span> <span class="n">done</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span>
            <span class="s2">&quot;sourcetype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span><span class="p">,</span>
            <span class="s2">&quot;stanza&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stanza</span><span class="p">,</span>
            <span class="s2">&quot;unbroken&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unbroken</span><span class="p">,</span>
            <span class="s2">&quot;done&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_fields&quot;</span><span class="p">):</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">format_events</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format events to list of string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events to format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of formatted events string.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">raise</span> <span class="n">EventException</span><span class="p">(</span><span class="s1">&#39;Unimplemented &quot;format_events&quot;.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="modular_input-event-solnlib.modular_input.event.Event.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#modular_input-event-solnlib.modular_input.event.Event.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Modular input event.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code><span data-autorefs-optional="float">float</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event timestamp, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The index event will be written to, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event host, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event source, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sourcetype</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event sourcetype, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fields</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event fields, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event stanza name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>unbroken</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event unbroken flag, default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>done</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The last unbroken event, default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="n">Event</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span><span class="o">=</span><span class="s1">&#39;This is a test data.&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">time</span><span class="o">=</span><span class="mf">1372274622.493</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Splunk&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sourcetype</span><span class="o">=</span><span class="s1">&#39;misc&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fields</span><span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Cloud&#39;</span><span class="p">:</span><span class="s1">&#39;AWS&#39;</span><span class="p">,</span><span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="s1">&#39;us-west-1&#39;</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stanza</span><span class="o">=</span><span class="s1">&#39;test_scheme://test&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">unbroken</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">done</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Modular input event.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data: Event data.</span>
<span class="sd">        time: (optional) Event timestamp, default is None.</span>
<span class="sd">        index: (optional) The index event will be written to, default is None.</span>
<span class="sd">        host: (optional) Event host, default is None.</span>
<span class="sd">        source: (optional) Event source, default is None.</span>
<span class="sd">        sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">        fields: (optional) Event fields, default is None.</span>
<span class="sd">        stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">        unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">        done: (optional) The last unbroken event, default is False.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; event = Event(</span>
<span class="sd">       &gt;&gt;&gt;     data=&#39;This is a test data.&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     time=1372274622.493,</span>
<span class="sd">       &gt;&gt;&gt;     index=&#39;main&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     host=&#39;localhost&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     source=&#39;Splunk&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     sourcetype=&#39;misc&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     fields= {&#39;Cloud&#39;:&#39;AWS&#39;,&#39;region&#39;: &#39;us-west-1&#39;},</span>
<span class="sd">       &gt;&gt;&gt;     stanza=&#39;test_scheme://test&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     unbroken=True,</span>
<span class="sd">       &gt;&gt;&gt;     done=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">time</span> <span class="k">if</span> <span class="n">time</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">host</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_source</span> <span class="o">=</span> <span class="n">source</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span> <span class="o">=</span> <span class="n">sourcetype</span>
    <span class="k">if</span> <span class="n">fields</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span> <span class="o">=</span> <span class="n">fields</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_stanza</span> <span class="o">=</span> <span class="n">stanza</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">unbroken</span> <span class="ow">and</span> <span class="n">done</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">EventException</span><span class="p">(</span><span class="s1">&#39;Invalid combination of &quot;unbroken&quot; and &quot;done&quot;.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_unbroken</span> <span class="o">=</span> <span class="n">unbroken</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_done</span> <span class="o">=</span> <span class="n">done</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event-solnlib.modular_input.event.Event.__str__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#modular_input-event-solnlib.modular_input.event.Event.__str__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">event</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">,</span>
        <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">,</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">,</span>
        <span class="s2">&quot;sourcetype&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span><span class="p">,</span>
        <span class="s2">&quot;stanza&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stanza</span><span class="p">,</span>
        <span class="s2">&quot;unbroken&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unbroken</span><span class="p">,</span>
        <span class="s2">&quot;done&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_fields&quot;</span><span class="p">):</span>
        <span class="n">event</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event-solnlib.modular_input.event.Event.format_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#modular_input-event-solnlib.modular_input.event.Event.format_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Format events to list of string.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events to format.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of formatted events string.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">format_events</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format events to list of string.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events to format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of formatted events string.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">raise</span> <span class="n">EventException</span><span class="p">(</span><span class="s1">&#39;Unimplemented &quot;format_events&quot;.&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-event-solnlib.modular_input.event.EventException" class="doc doc-heading">
        <code>EventException</code>


<a href="#modular_input-event-solnlib.modular_input.event.EventException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>



        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EventException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-event-solnlib.modular_input.event.HECEvent" class="doc doc-heading">
        <code>HECEvent</code>


<a href="#modular_input-event-solnlib.modular_input.event.HECEvent" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="solnlib.modular_input.event.Event">Event</span></code></p>

  
      <p>HEC event.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HECEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;HEC event.&quot;&quot;&quot;</span>

    <span class="n">max_hec_event_length</span> <span class="o">=</span> <span class="mi">1000000</span>

    <span class="k">def</span> <span class="nf">_to_hec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_field</span><span class="p">):</span>
        <span class="n">event</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">event</span><span class="p">[</span><span class="n">event_field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">:</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">:</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">:</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">:</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span><span class="p">:</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_fields&quot;</span><span class="p">):</span>
            <span class="n">event</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fields</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">format_events</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">event_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;event&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format events to list of string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events to format.</span>
<span class="sd">            event_field: Event field.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of formatted events string, example::</span>

<span class="sd">                [</span>
<span class="sd">                    &#39;{&quot;index&quot;: &quot;main&quot;, ... &quot;event&quot;: {&quot;kk&quot;: [1, 2, 3]}}\\n</span>
<span class="sd">                    {&quot;index&quot;: &quot;main&quot;, ... &quot;event&quot;: {&quot;kk&quot;: [3, 2, 3]}}&#39;,</span>
<span class="sd">                &#39;...&#39;</span>
<span class="sd">                ]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">new_events</span><span class="p">,</span> <span class="n">batched_events</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">_to_hec</span><span class="p">(</span><span class="n">event_field</span><span class="p">)</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="n">new_length</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">batched_events</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">new_length</span> <span class="o">&gt;=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">max_hec_event_length</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">batched_events</span><span class="p">:</span>
                    <span class="n">new_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">batched_events</span><span class="p">))</span>
                <span class="k">del</span> <span class="n">batched_events</span><span class="p">[:]</span>
                <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">batched_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">batched_events</span><span class="p">:</span>
            <span class="n">new_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">batched_events</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">new_events</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event-solnlib.modular_input.event.HECEvent.max_hec_event_length" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">max_hec_event_length</span> <span class="o">=</span> <span class="mi">1000000</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event-solnlib.modular_input.event.HECEvent.max_hec_event_length" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="modular_input-event-solnlib.modular_input.event.HECEvent.format_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">event_field</span><span class="o">=</span><span class="s1">&#39;event&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#modular_input-event-solnlib.modular_input.event.HECEvent.format_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Format events to list of string.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events to format.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>event_field</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event field.</p>
            </div>
          </td>
          <td>
                <code>&#39;event&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of formatted events string, example::</p>
<p>[
    &lsquo;{&ldquo;index&rdquo;: &ldquo;main&rdquo;, &hellip; &ldquo;event&rdquo;: {&ldquo;kk&rdquo;: [1, 2, 3]}}\n
    {&ldquo;index&rdquo;: &ldquo;main&rdquo;, &hellip; &ldquo;event&rdquo;: {&ldquo;kk&rdquo;: [3, 2, 3]}}&rsquo;,
&lsquo;&hellip;&rsquo;
]</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">format_events</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">event_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;event&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format events to list of string.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events to format.</span>
<span class="sd">        event_field: Event field.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of formatted events string, example::</span>

<span class="sd">            [</span>
<span class="sd">                &#39;{&quot;index&quot;: &quot;main&quot;, ... &quot;event&quot;: {&quot;kk&quot;: [1, 2, 3]}}\\n</span>
<span class="sd">                {&quot;index&quot;: &quot;main&quot;, ... &quot;event&quot;: {&quot;kk&quot;: [3, 2, 3]}}&#39;,</span>
<span class="sd">            &#39;...&#39;</span>
<span class="sd">            ]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">new_events</span><span class="p">,</span> <span class="n">batched_events</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">_to_hec</span><span class="p">(</span><span class="n">event_field</span><span class="p">)</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
        <span class="n">new_length</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">batched_events</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">new_length</span> <span class="o">&gt;=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">max_hec_event_length</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">batched_events</span><span class="p">:</span>
                <span class="n">new_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">batched_events</span><span class="p">))</span>
            <span class="k">del</span> <span class="n">batched_events</span><span class="p">[:]</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">batched_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">batched_events</span><span class="p">:</span>
        <span class="n">new_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">batched_events</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">new_events</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-event-solnlib.modular_input.event.XMLEvent" class="doc doc-heading">
        <code>XMLEvent</code>


<a href="#modular_input-event-solnlib.modular_input.event.XMLEvent" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="solnlib.modular_input.event.Event">Event</span></code></p>

  
      <p>XML event.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">XMLEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;XML event.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_event</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stanza</span><span class="p">:</span>
            <span class="n">_event</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;stanza&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stanza</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unbroken</span><span class="p">:</span>
            <span class="n">_event</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;unbroken&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_unbroken</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">_event</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_time</span>

        <span class="n">sub_elements</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_index</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sourcetype</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">sub_elements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">_event</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">_event</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">_event</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_done</span><span class="p">:</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">_event</span><span class="p">,</span> <span class="s2">&quot;done&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_event</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">format_events</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format events to list of string.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events to format.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of formatted events string, example::</span>

<span class="sd">                [</span>
<span class="sd">                    &#39;&lt;stream&gt;</span>
<span class="sd">                    &lt;event stanza=&quot;test_scheme://test&quot; unbroken=&quot;1&quot;&gt;</span>
<span class="sd">                    &lt;time&gt;1459919070.994&lt;/time&gt;</span>
<span class="sd">                    &lt;index&gt;main&lt;/index&gt;</span>
<span class="sd">                    &lt;host&gt;localhost&lt;/host&gt;</span>
<span class="sd">                    &lt;source&gt;test&lt;/source&gt;</span>
<span class="sd">                    &lt;sourcetype&gt;test&lt;/sourcetype&gt;</span>
<span class="sd">                    &lt;data&gt;{&quot;kk&quot;: [1, 2, 3]}&lt;/data&gt;</span>
<span class="sd">                    &lt;done /&gt;</span>
<span class="sd">                    &lt;/event&gt;</span>
<span class="sd">                    &lt;event stanza=&quot;test_scheme://test&quot; unbroken=&quot;1&quot;&gt;</span>
<span class="sd">                    &lt;time&gt;1459919082.961&lt;/time&gt;</span>
<span class="sd">                    &lt;index&gt;main&lt;/index&gt;</span>
<span class="sd">                    &lt;host&gt;localhost&lt;/host&gt;</span>
<span class="sd">                    &lt;source&gt;test&lt;/source&gt;</span>
<span class="sd">                    &lt;sourcetype&gt;test&lt;/sourcetype&gt;</span>
<span class="sd">                    &lt;data&gt;{&quot;kk&quot;: [3, 2, 3]}&lt;/data&gt;</span>
<span class="sd">                    &lt;done /&gt;</span>
<span class="sd">                    &lt;/event&gt;</span>
<span class="sd">                    &lt;/stream&gt;&#39;</span>
<span class="sd">                ]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stream</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;stream&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">_to_xml</span><span class="p">())</span>

        <span class="k">return</span> <span class="p">[</span>
            <span class="n">defused_et</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="p">]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="modular_input-event-solnlib.modular_input.event.XMLEvent.format_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#modular_input-event-solnlib.modular_input.event.XMLEvent.format_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Format events to list of string.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events to format.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of formatted events string, example::</p>
<p>[
    &lsquo;<stream>
    <event stanza="test_scheme://test" unbroken="1">
    <time>1459919070.994</time>
    <index>main</index>
    <host>localhost</host>
    <source>test</source>
    <sourcetype>test</sourcetype>
    <data>{&ldquo;kk&rdquo;: [1, 2, 3]}</data>
    <done />
    </event>
    <event stanza="test_scheme://test" unbroken="1">
    <time>1459919082.961</time>
    <index>main</index>
    <host>localhost</host>
    <source>test</source>
    <sourcetype>test</sourcetype>
    <data>{&ldquo;kk&rdquo;: [3, 2, 3]}</data>
    <done />
    </event>
    </stream>&rsquo;
]</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">format_events</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format events to list of string.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events to format.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of formatted events string, example::</span>

<span class="sd">            [</span>
<span class="sd">                &#39;&lt;stream&gt;</span>
<span class="sd">                &lt;event stanza=&quot;test_scheme://test&quot; unbroken=&quot;1&quot;&gt;</span>
<span class="sd">                &lt;time&gt;1459919070.994&lt;/time&gt;</span>
<span class="sd">                &lt;index&gt;main&lt;/index&gt;</span>
<span class="sd">                &lt;host&gt;localhost&lt;/host&gt;</span>
<span class="sd">                &lt;source&gt;test&lt;/source&gt;</span>
<span class="sd">                &lt;sourcetype&gt;test&lt;/sourcetype&gt;</span>
<span class="sd">                &lt;data&gt;{&quot;kk&quot;: [1, 2, 3]}&lt;/data&gt;</span>
<span class="sd">                &lt;done /&gt;</span>
<span class="sd">                &lt;/event&gt;</span>
<span class="sd">                &lt;event stanza=&quot;test_scheme://test&quot; unbroken=&quot;1&quot;&gt;</span>
<span class="sd">                &lt;time&gt;1459919082.961&lt;/time&gt;</span>
<span class="sd">                &lt;index&gt;main&lt;/index&gt;</span>
<span class="sd">                &lt;host&gt;localhost&lt;/host&gt;</span>
<span class="sd">                &lt;source&gt;test&lt;/source&gt;</span>
<span class="sd">                &lt;sourcetype&gt;test&lt;/sourcetype&gt;</span>
<span class="sd">                &lt;data&gt;{&quot;kk&quot;: [3, 2, 3]}&lt;/data&gt;</span>
<span class="sd">                &lt;done /&gt;</span>
<span class="sd">                &lt;/event&gt;</span>
<span class="sd">                &lt;/stream&gt;&#39;</span>
<span class="sd">            ]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stream</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;stream&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">_to_xml</span><span class="p">())</span>

    <span class="k">return</span> <span class="p">[</span>
        <span class="n">defused_et</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="modular_input-event_writer"><h1 id="modular_input-event_writer-event_writerpy">event_writer.py<a class="headerlink" href="#modular_input-event_writer-event_writerpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.modular_input.event_writer"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides two kinds of event writers (ClassicEventWriter,
HECEventWriter) to write Splunk modular input events.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="modular_input-event_writer-solnlib.modular_input.event_writer.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ClassicEventWriter&#39;</span><span class="p">,</span> <span class="s1">&#39;HECEventWriter&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="modular_input-event_writer-solnlib.modular_input.event_writer.deprecation_msg" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">deprecation_msg</span> <span class="o">=</span> <span class="s2">&quot;Function &#39;create_from_token&#39; is deprecated and incompatible with &#39;global_settings_schema=True&#39;. Use &#39;create_from_token_with_session_key&#39; instead.&quot;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.deprecation_msg" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter" class="doc doc-heading">
        <code>ClassicEventWriter</code>


<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="solnlib.modular_input.event_writer.EventWriter">EventWriter</span></code></p>

  
      <p>Classic event writer.</p>
<p>Use sys.stdout as the output.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">event_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">ClassicEventWriter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span><span class="o">.</span><span class="n">write_events</span><span class="p">([</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">])</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ClassicEventWriter</span><span class="p">(</span><span class="n">EventWriter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Classic event writer.</span>

<span class="sd">    Use sys.stdout as the output.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">        &gt;&gt;&gt; ew = event_writer.ClassicEventWriter()</span>
<span class="sd">        &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;ClassicEventWriter&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lock</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ClassicEventWriter.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            lock: (optional) lock to exclusively access stdout.</span>
<span class="sd">                by default, it is None and it will use threading safe lock.</span>
<span class="sd">                if user would like to make the lock multiple-process safe, user should</span>
<span class="sd">                pass in multiprocessing.Lock() instead</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">lock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">lock</span>

    <span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new XMLEvent object.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">XMLEvent</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
            <span class="n">stanza</span><span class="o">=</span><span class="n">stanza</span><span class="p">,</span>
            <span class="n">unbroken</span><span class="o">=</span><span class="n">unbroken</span><span class="p">,</span>
            <span class="n">done</span><span class="o">=</span><span class="n">done</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

        <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">XMLEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">)])</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;ClassicEventWriter&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">lock</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ClassicEventWriter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>lock</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional="threading">threading</span>.<span data-autorefs-optional-hover="threading.Lock">Lock</span>, <span data-autorefs-optional="multiprocessing">multiprocessing</span>.<span data-autorefs-optional-hover="multiprocessing.Lock">Lock</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) lock to exclusively access stdout.
by default, it is None and it will use threading safe lock.
if user would like to make the lock multiple-process safe, user should
pass in multiprocessing.Lock() instead</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lock</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">,</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Lock</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ClassicEventWriter.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        lock: (optional) lock to exclusively access stdout.</span>
<span class="sd">            by default, it is None and it will use threading safe lock.</span>
<span class="sd">            if user would like to make the lock multiple-process safe, user should</span>
<span class="sd">            pass in multiprocessing.Lock() instead</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">lock</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">lock</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.create_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.create_event" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new XMLEvent object.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new XMLEvent object.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">XMLEvent</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
        <span class="n">stanza</span><span class="o">=</span><span class="n">stanza</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="o">=</span><span class="n">unbroken</span><span class="p">,</span>
        <span class="n">done</span><span class="o">=</span><span class="n">done</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.write_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">write_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span></code>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.ClassicEventWriter.write_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">stdout</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>

    <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">XMLEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">)])</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter" class="doc doc-heading">
        <code>EventWriter</code>


<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Base class of event writer.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EventWriter</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class of event writer.&quot;&quot;&quot;</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;EventWriter&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">XMLEvent</span><span class="p">,</span> <span class="n">HECEvent</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new event.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data: Event data.</span>
<span class="sd">            time: (optional) Event timestamp, default is None.</span>
<span class="sd">            index: (optional) The index event will be written to, default is None.</span>
<span class="sd">            host: (optional) Event host, default is None.</span>
<span class="sd">            source: (optional) Event source, default is None.</span>
<span class="sd">            sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">            fields: (optional) Event fields, default is None.</span>
<span class="sd">            stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">            unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">            done: (optional) The last unbroken event, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; ew = event_writer.HECEventWriter(...)</span>
<span class="sd">           &gt;&gt;&gt; event = ew.create_event(</span>
<span class="sd">           &gt;&gt;&gt;     data=&#39;This is a test data.&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     time=&#39;%.3f&#39; % 1372274622.493,</span>
<span class="sd">           &gt;&gt;&gt;     index=&#39;main&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     host=&#39;localhost&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     source=&#39;Splunk&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     sourcetype=&#39;misc&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     fields={&#39;accountid&#39;: &#39;603514901691&#39;, &#39;Cloud&#39;: u&#39;AWS&#39;},</span>
<span class="sd">           &gt;&gt;&gt;     stanza=&#39;test_scheme://test&#39;,</span>
<span class="sd">           &gt;&gt;&gt;     unbroken=True,</span>
<span class="sd">           &gt;&gt;&gt;     done=True)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write events.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events to write.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">           &gt;&gt;&gt; ew = event_writer.EventWriter(...)</span>
<span class="sd">           &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;EventWriter&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter.create_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter.create_event" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new event.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code><span data-autorefs-optional="float">float</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event timestamp, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The index event will be written to, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event host, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event source, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sourcetype</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event sourcetype, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fields</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event fields, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event stanza name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>unbroken</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event unbroken flag, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>done</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The last unbroken event, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">HECEventWriter</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">event</span> <span class="o">=</span> <span class="n">ew</span><span class="o">.</span><span class="n">create_event</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span><span class="o">=</span><span class="s1">&#39;This is a test data.&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">time</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="mf">1372274622.493</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">index</span><span class="o">=</span><span class="s1">&#39;main&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">source</span><span class="o">=</span><span class="s1">&#39;Splunk&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sourcetype</span><span class="o">=</span><span class="s1">&#39;misc&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">fields</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;accountid&#39;</span><span class="p">:</span> <span class="s1">&#39;603514901691&#39;</span><span class="p">,</span> <span class="s1">&#39;Cloud&#39;</span><span class="p">:</span> <span class="sa">u</span><span class="s1">&#39;AWS&#39;</span><span class="p">},</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">stanza</span><span class="o">=</span><span class="s1">&#39;test_scheme://test&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">unbroken</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">done</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">XMLEvent</span><span class="p">,</span> <span class="n">HECEvent</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new event.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data: Event data.</span>
<span class="sd">        time: (optional) Event timestamp, default is None.</span>
<span class="sd">        index: (optional) The index event will be written to, default is None.</span>
<span class="sd">        host: (optional) Event host, default is None.</span>
<span class="sd">        source: (optional) Event source, default is None.</span>
<span class="sd">        sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">        fields: (optional) Event fields, default is None.</span>
<span class="sd">        stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">        unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">        done: (optional) The last unbroken event, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; ew = event_writer.HECEventWriter(...)</span>
<span class="sd">       &gt;&gt;&gt; event = ew.create_event(</span>
<span class="sd">       &gt;&gt;&gt;     data=&#39;This is a test data.&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     time=&#39;%.3f&#39; % 1372274622.493,</span>
<span class="sd">       &gt;&gt;&gt;     index=&#39;main&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     host=&#39;localhost&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     source=&#39;Splunk&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     sourcetype=&#39;misc&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     fields={&#39;accountid&#39;: &#39;603514901691&#39;, &#39;Cloud&#39;: u&#39;AWS&#39;},</span>
<span class="sd">       &gt;&gt;&gt;     stanza=&#39;test_scheme://test&#39;,</span>
<span class="sd">       &gt;&gt;&gt;     unbroken=True,</span>
<span class="sd">       &gt;&gt;&gt;     done=True)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter.write_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">write_events</span><span class="p">(</span><span class="n">events</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.EventWriter.write_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Write events.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events to write.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">event_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">EventWriter</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span><span class="o">.</span><span class="n">write_events</span><span class="p">([</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">])</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write events.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events to write.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">       &gt;&gt;&gt; ew = event_writer.EventWriter(...)</span>
<span class="sd">       &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-event_writer-solnlib.modular_input.event_writer.FunctionDeprecated" class="doc doc-heading">
        <code>FunctionDeprecated</code>


<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.FunctionDeprecated" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>



        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FunctionDeprecated</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter" class="doc doc-heading">
        <code>HECEventWriter</code>


<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="solnlib.modular_input.event_writer.EventWriter">EventWriter</span></code></p>

  
      <p>HEC event writer.</p>
<p>Use Splunk HEC as the output.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.modular_input</span> <span class="kn">import</span> <span class="n">event_writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span> <span class="o">=</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">HECEventWriter</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ew</span><span class="o">.</span><span class="n">write_events</span><span class="p">([</span><span class="n">event1</span><span class="p">,</span> <span class="n">event2</span><span class="p">])</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HECEventWriter</span><span class="p">(</span><span class="n">EventWriter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;HEC event writer.</span>

<span class="sd">    Use Splunk HEC as the output.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib.modular_input import event_writer</span>
<span class="sd">        &gt;&gt;&gt; ew = event_writer.HECEventWriter(hec_input_name, session_key)</span>
<span class="sd">        &gt;&gt;&gt; ew.write_events([event1, event2])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">WRITE_EVENT_RETRIES</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">HTTP_INPUT_CONFIG_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/servicesNS/nobody/splunk_httpinput/data/inputs/http&quot;</span>
    <span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/services/collector&quot;</span>
    <span class="n">TOO_MANY_REQUESTS</span> <span class="o">=</span> <span class="mi">429</span>  <span class="c1"># we exceeded rate limit</span>
    <span class="n">SERVICE_UNAVAILABLE</span> <span class="o">=</span> <span class="mi">503</span>  <span class="c1"># remote service is temporary unavailable</span>

    <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;HECEventWriter&quot;</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes HECEventWriter.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            hec_input_name: Splunk HEC input name.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            hec_uri: (optional) If hec_uri and hec_token are provided, they will</span>
<span class="sd">                higher precedence than hec_input_name.</span>
<span class="sd">            hec_token: (optional) HEC token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            logger: Logger object.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
        <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span>

        <span class="k">if</span> <span class="n">hec_uri</span> <span class="ow">and</span> <span class="n">hec_token</span><span class="p">:</span>
            <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">hec_port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">hec_uri</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
                <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>
            <span class="n">hec_port</span><span class="p">,</span> <span class="n">hec_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hec_config</span><span class="p">(</span>
                <span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
            <span class="n">scheme</span> <span class="o">=</span> <span class="n">get_scheme_from_hec_settings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">hec_token</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hec_port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_from_token</span><span class="p">(</span>
        <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given HEC URI and HEC token, create HECEventWriter object. This</span>
<span class="sd">        function simplifies the standalone mode HECEventWriter usage (not in a</span>
<span class="sd">        modinput).</span>

<span class="sd">        Arguments:</span>
<span class="sd">            hec_uri: HTTP Event Collector URI, like https://localhost:8088.</span>
<span class="sd">            hec_token: HTTP Event Collector token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            context: Other configurations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEventWriter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FunctionDeprecated</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
            <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
            <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_from_input</span><span class="p">(</span>
        <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given HEC input stanza name, splunkd URI and splunkd session key,</span>
<span class="sd">        create HECEventWriter object. HEC URI and token etc will be discovered</span>
<span class="sd">        from HEC input stanza. When hitting HEC event limit, the underlying</span>
<span class="sd">        code will increase the HEC event limit automatically by calling</span>
<span class="sd">        corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            hec_input_name: Splunk HEC input name.</span>
<span class="sd">            splunkd_uri: Splunkd URI, like https://localhost:8089</span>
<span class="sd">            session_key: Splunkd access token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            context: Other configurations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEventWriter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
            <span class="n">hec_input_name</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">create_from_token_with_session_key</span><span class="p">(</span>
        <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Given Splunkd URI, Splunkd session key, HEC URI and HEC token,</span>
<span class="sd">        create HECEventWriter object. When hitting HEC event limit, the event</span>
<span class="sd">        writer will increase the HEC event limit automatically by calling</span>
<span class="sd">        corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            splunkd_uri: Splunkd URI, like https://localhost:8089.</span>
<span class="sd">            session_key: Splunkd access token.</span>
<span class="sd">            hec_uri: Http Event Collector URI, like https://localhost:8088.</span>
<span class="sd">            hec_token: Http Event Collector token.</span>
<span class="sd">            global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">            context: Other configurations.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEventWriter.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
            <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
            <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_get_hec_config</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">):</span>
        <span class="n">hc</span> <span class="o">=</span> <span class="n">HECConfig</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">get_settings</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">)):</span>
            <span class="c1"># Enable HEC input</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Enabling HEC&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;disabled&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0&quot;</span>
            <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;enableSSL&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hec_enablessl&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;hec_port&quot;</span><span class="p">,</span> <span class="s2">&quot;8088&quot;</span><span class="p">)</span>
            <span class="n">hc</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>

        <span class="n">hec_input</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">get_input</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hec_input</span><span class="p">:</span>
            <span class="c1"># Create HEC input</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Create HEC datainput, name=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">hec_input_name</span><span class="p">)</span>
            <span class="n">hinput</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="s2">&quot;main&quot;</span><span class="p">),</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;sourcetype&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;token&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;source&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;host&quot;</span><span class="p">):</span>
                <span class="n">hinput</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">]</span>

            <span class="n">hec_input</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">create_input</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">hinput</span><span class="p">)</span>

        <span class="n">limits</span> <span class="o">=</span> <span class="n">hc</span><span class="o">.</span><span class="n">get_limits</span><span class="p">()</span>
        <span class="n">HECEvent</span><span class="o">.</span><span class="n">max_hec_event_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">limits</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;max_content_length&quot;</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span> <span class="n">hec_input</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HECEvent</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new HECEvent object.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            data: Event data.</span>
<span class="sd">            time: (optional) Event timestamp, default is None.</span>
<span class="sd">            index: (optional) The index event will be written to, default is None.</span>
<span class="sd">            host: (optional) Event host, default is None.</span>
<span class="sd">            source: (optional) Event source, default is None.</span>
<span class="sd">            sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">            fields: (optional) Event fields, default is None.</span>
<span class="sd">            stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">            unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">            done: (optional) The last unbroken event, default is False.</span>
<span class="sd">                It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created HECEvent.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">HECEvent</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
            <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
            <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
            <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
        <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">WRITE_EVENT_RETRIES</span><span class="p">,</span>
        <span class="n">event_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write events to index in bulk.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            events: List of events.</span>
<span class="sd">            retries: Number of retries for writing events to index.</span>
<span class="sd">            event_field: Event field.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">HECEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">event_field</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">retries</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span><span class="p">,</span>
                        <span class="n">body</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                        <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="s2">&quot;Write events through HEC failed. Status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span>
                    <span class="p">)</span>
                    <span class="n">last_ex</span> <span class="o">=</span> <span class="n">e</span>
                    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOO_MANY_REQUESTS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SERVICE_UNAVAILABLE</span><span class="p">]:</span>
                        <span class="c1"># wait time for n retries: 10, 20, 40, 80, 80, 80, 80, ....</span>
                        <span class="n">sleep_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">random_millisecond</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span> <span class="o">+</span> <span class="n">random_millisecond</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">last_ex</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># When failed after retry, we reraise the exception</span>
                <span class="c1"># to exit the function to let client handle this situation</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Write events through HEC failed: </span><span class="si">%s</span><span class="s2">. status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                    <span class="n">last_ex</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="n">last_ex</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.HTTP_EVENT_COLLECTOR_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/services/collector&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.HTTP_EVENT_COLLECTOR_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.HTTP_INPUT_CONFIG_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">HTTP_INPUT_CONFIG_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/servicesNS/nobody/splunk_httpinput/data/inputs/http&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.HTTP_INPUT_CONFIG_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.SERVICE_UNAVAILABLE" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">SERVICE_UNAVAILABLE</span> <span class="o">=</span> <span class="mi">503</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.SERVICE_UNAVAILABLE" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.TOO_MANY_REQUESTS" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">TOO_MANY_REQUESTS</span> <span class="o">=</span> <span class="mi">429</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.TOO_MANY_REQUESTS" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.WRITE_EVENT_RETRIES" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">WRITE_EVENT_RETRIES</span> <span class="o">=</span> <span class="mi">5</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.WRITE_EVENT_RETRIES" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;HECEventWriter&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.headers" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.headers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.logger" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.logger" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hec_uri</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hec_token</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes HECEventWriter.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hec_input_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk HEC input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hec_uri</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) If hec_uri and hec_token are provided, they will
higher precedence than hec_input_name.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hec_token</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) HEC token.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span data-autorefs-optional="logging">logging</span>.<span data-autorefs-optional-hover="logging.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logger object.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes HECEventWriter.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hec_input_name: Splunk HEC input name.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        hec_uri: (optional) If hec_uri and hec_token are provided, they will</span>
<span class="sd">            higher precedence than hec_input_name.</span>
<span class="sd">        hec_token: (optional) HEC token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        logger: Logger object.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
    <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span>

    <span class="k">if</span> <span class="n">hec_uri</span> <span class="ow">and</span> <span class="n">hec_token</span><span class="p">:</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">hec_port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">hec_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
            <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>
        <span class="n">hec_port</span><span class="p">,</span> <span class="n">hec_token</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_hec_config</span><span class="p">(</span>
            <span class="n">hec_input_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="n">get_scheme_from_hec_settings</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">):</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_connections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">):</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;pool_maxsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">hec_token</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">hec_port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_event</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sourcetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unbroken</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_event" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create a new HECEvent object.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>time</code></td>
          <td>
                <code><span data-autorefs-optional="float">float</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event timestamp, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The index event will be written to, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event host, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>source</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event source, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>sourcetype</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event sourcetype, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>fields</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event fields, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event stanza name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>unbroken</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Event unbroken flag, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>done</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The last unbroken event, default is False.
It is only meaningful when for XMLEvent when using ClassicEventWriter.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.event.HECEvent">HECEvent</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEvent.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_event</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fields</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unbroken</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">done</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HECEvent</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new HECEvent object.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        data: Event data.</span>
<span class="sd">        time: (optional) Event timestamp, default is None.</span>
<span class="sd">        index: (optional) The index event will be written to, default is None.</span>
<span class="sd">        host: (optional) Event host, default is None.</span>
<span class="sd">        source: (optional) Event source, default is None.</span>
<span class="sd">        sourcetype: (optional) Event sourcetype, default is None.</span>
<span class="sd">        fields: (optional) Event fields, default is None.</span>
<span class="sd">        stanza: (optional) Event stanza name, default is None.</span>
<span class="sd">        unbroken: (optional) Event unbroken flag, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>
<span class="sd">        done: (optional) The last unbroken event, default is False.</span>
<span class="sd">            It is only meaningful when for XMLEvent when using ClassicEventWriter.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEvent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">HECEvent</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span>
        <span class="n">sourcetype</span><span class="o">=</span><span class="n">sourcetype</span><span class="p">,</span>
        <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_from_input" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_from_input</span><span class="p">(</span><span class="n">hec_input_name</span><span class="p">,</span> <span class="n">splunkd_uri</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_from_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given HEC input stanza name, splunkd URI and splunkd session key,
create HECEventWriter object. HEC URI and token etc will be discovered
from HEC input stanza. When hitting HEC event limit, the underlying
code will increase the HEC event limit automatically by calling
corresponding REST API against splunkd_uri by using session_key.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hec_input_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk HEC input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>splunkd_uri</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd URI, like https://localhost:8089</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.event_writer.HECEventWriter">HECEventWriter</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEventWriter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_from_input</span><span class="p">(</span>
    <span class="n">hec_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given HEC input stanza name, splunkd URI and splunkd session key,</span>
<span class="sd">    create HECEventWriter object. HEC URI and token etc will be discovered</span>
<span class="sd">    from HEC input stanza. When hitting HEC event limit, the underlying</span>
<span class="sd">    code will increase the HEC event limit automatically by calling</span>
<span class="sd">    corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hec_input_name: Splunk HEC input name.</span>
<span class="sd">        splunkd_uri: Splunkd URI, like https://localhost:8089</span>
<span class="sd">        session_key: Splunkd access token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        context: Other configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEventWriter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
        <span class="n">hec_input_name</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_from_token" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_from_token</span><span class="p">(</span><span class="n">hec_uri</span><span class="p">,</span> <span class="n">hec_token</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_from_token" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given HEC URI and HEC token, create HECEventWriter object. This
function simplifies the standalone mode HECEventWriter usage (not in a
modinput).</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hec_uri</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP Event Collector URI, like https://localhost:8088.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hec_token</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP Event Collector token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.event_writer.HECEventWriter">HECEventWriter</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEventWriter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_from_token</span><span class="p">(</span>
    <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given HEC URI and HEC token, create HECEventWriter object. This</span>
<span class="sd">    function simplifies the standalone mode HECEventWriter usage (not in a</span>
<span class="sd">    modinput).</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hec_uri: HTTP Event Collector URI, like https://localhost:8088.</span>
<span class="sd">        hec_token: HTTP Event Collector token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        context: Other configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEventWriter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">global_settings_schema</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">FunctionDeprecated</span><span class="p">(</span><span class="n">deprecation_msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_from_token_with_session_key" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_from_token_with_session_key</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">hec_uri</span><span class="p">,</span> <span class="n">hec_token</span><span class="p">,</span> <span class="n">global_settings_schema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.create_from_token_with_session_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Given Splunkd URI, Splunkd session key, HEC URI and HEC token,
create HECEventWriter object. When hitting HEC event limit, the event
writer will increase the HEC event limit automatically by calling
corresponding REST API against splunkd_uri by using session_key.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>splunkd_uri</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd URI, like https://localhost:8089.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hec_uri</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Http Event Collector URI, like https://localhost:8088.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>hec_token</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Http Event Collector token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>global_settings_schema</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) if True, scheme will be set based on HEC global settings, default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.event_writer.HECEventWriter">HECEventWriter</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created HECEventWriter.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">create_from_token_with_session_key</span><span class="p">(</span>
    <span class="n">splunkd_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">hec_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">hec_token</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">global_settings_schema</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HECEventWriter&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Given Splunkd URI, Splunkd session key, HEC URI and HEC token,</span>
<span class="sd">    create HECEventWriter object. When hitting HEC event limit, the event</span>
<span class="sd">    writer will increase the HEC event limit automatically by calling</span>
<span class="sd">    corresponding REST API against splunkd_uri by using session_key.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        splunkd_uri: Splunkd URI, like https://localhost:8089.</span>
<span class="sd">        session_key: Splunkd access token.</span>
<span class="sd">        hec_uri: Http Event Collector URI, like https://localhost:8088.</span>
<span class="sd">        hec_token: Http Event Collector token.</span>
<span class="sd">        global_settings_schema: (optional) if True, scheme will be set based on HEC global settings, default False.</span>
<span class="sd">        context: Other configurations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created HECEventWriter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">splunkd_uri</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HECEventWriter</span><span class="p">(</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="p">,</span>
        <span class="n">hec_uri</span><span class="o">=</span><span class="n">hec_uri</span><span class="p">,</span>
        <span class="n">hec_token</span><span class="o">=</span><span class="n">hec_token</span><span class="p">,</span>
        <span class="n">global_settings_schema</span><span class="o">=</span><span class="n">global_settings_schema</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.write_events" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">write_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">retries</span><span class="o">=</span><span class="n">WRITE_EVENT_RETRIES</span><span class="p">,</span> <span class="n">event_field</span><span class="o">=</span><span class="s1">&#39;event&#39;</span><span class="p">)</span></code>

<a href="#modular_input-event_writer-solnlib.modular_input.event_writer.HECEventWriter.write_events" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Write events to index in bulk.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>events</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of events.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>retries</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of retries for writing events to index.</p>
            </div>
          </td>
          <td>
                <code>WRITE_EVENT_RETRIES</code>
          </td>
        </tr>
        <tr>
          <td><code>event_field</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event field.</p>
            </div>
          </td>
          <td>
                <code>&#39;event&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/event_writer.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_events</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">events</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span>
    <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">WRITE_EVENT_RETRIES</span><span class="p">,</span>
    <span class="n">event_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write events to index in bulk.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        events: List of events.</span>
<span class="sd">        retries: Number of retries for writing events to index.</span>
<span class="sd">        event_field: Event field.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">HECEvent</span><span class="o">.</span><span class="n">format_events</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">event_field</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">retries</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">HTTP_EVENT_COLLECTOR_ENDPOINT</span><span class="p">,</span>
                    <span class="n">body</span><span class="o">=</span><span class="n">event</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">),</span>
                    <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Write events through HEC failed. Status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span>
                <span class="p">)</span>
                <span class="n">last_ex</span> <span class="o">=</span> <span class="n">e</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TOO_MANY_REQUESTS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SERVICE_UNAVAILABLE</span><span class="p">]:</span>
                    <span class="c1"># wait time for n retries: 10, 20, 40, 80, 80, 80, 80, ....</span>
                    <span class="n">sleep_time</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(((</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">80</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">retries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">random_millisecond</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_time</span> <span class="o">+</span> <span class="n">random_millisecond</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">last_ex</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># When failed after retry, we reraise the exception</span>
            <span class="c1"># to exit the function to let client handle this situation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Write events through HEC failed: </span><span class="si">%s</span><span class="s2">. status=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                <span class="n">last_ex</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">last_ex</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="modular_input-modular_input"><h1 id="modular_input-modular_input-modular_inputpy">modular_input.py<a class="headerlink" href="#modular_input-modular_input-modular_inputpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.modular_input.modular_input"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides a base class of Splunk modular input.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="modular_input-modular_input-solnlib.modular_input.modular_input.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ModularInputException&#39;</span><span class="p">,</span> <span class="s1">&#39;ModularInput&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput" class="doc doc-heading">
        <code>ModularInput</code>


<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Base class of Splunk modular input.</p>
<p>It&rsquo;s a base modular input, it should be inherited by sub modular input. For
sub modular input, properties: &lsquo;app&rsquo;, &lsquo;name&rsquo;, &lsquo;title&rsquo; and &lsquo;description&rsquo; must
be overriden, also there are some other optional properties can be overriden
like: &lsquo;use_external_validation&rsquo;, &lsquo;use_single_instance&rsquo;, &lsquo;use_kvstore_checkpointer&rsquo;
and &lsquo;use_hec_event_writer&rsquo;.</p>
<p>Notes: If you set &lsquo;KVStoreCheckpointer&rsquo; or &lsquo;use_hec_event_writer&rsquo; to True,
you must override the corresponding &lsquo;kvstore_checkpointer_collection_name&rsquo;
and &lsquo;hec_input_name&rsquo;.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TestModularInput</span><span class="p">(</span><span class="n">ModularInput</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">app</span> <span class="o">=</span> <span class="s1">&#39;TestApp&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;test_modular_input&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Test modular input&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">description</span> <span class="o">=</span> <span class="s1">&#39;This is a test modular input&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">use_external_validation</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">use_single_instance</span> <span class="o">=</span> <span class="kc">False</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">use_kvstore_checkpointer</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">kvstore_checkpointer_collection_name</span> <span class="o">=</span> <span class="s1">&#39;TestCheckpoint&#39;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">use_hec_event_writer</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">hec_input_name</span> <span class="o">=</span> <span class="s1">&#39;TestEventWriter&#39;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">extra_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span> <span class="o">..</span> <span class="o">.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">do_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span> <span class="o">..</span> <span class="o">.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">do_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span> <span class="o">..</span> <span class="o">.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">md</span> <span class="o">=</span> <span class="n">TestModularInput</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">md</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ModularInput</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">ABCMeta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base class of Splunk modular input.</span>

<span class="sd">    It&#39;s a base modular input, it should be inherited by sub modular input. For</span>
<span class="sd">    sub modular input, properties: &#39;app&#39;, &#39;name&#39;, &#39;title&#39; and &#39;description&#39; must</span>
<span class="sd">    be overriden, also there are some other optional properties can be overriden</span>
<span class="sd">    like: &#39;use_external_validation&#39;, &#39;use_single_instance&#39;, &#39;use_kvstore_checkpointer&#39;</span>
<span class="sd">    and &#39;use_hec_event_writer&#39;.</span>

<span class="sd">    Notes: If you set &#39;KVStoreCheckpointer&#39; or &#39;use_hec_event_writer&#39; to True,</span>
<span class="sd">    you must override the corresponding &#39;kvstore_checkpointer_collection_name&#39;</span>
<span class="sd">    and &#39;hec_input_name&#39;.</span>

<span class="sd">    Examples:</span>

<span class="sd">       &gt;&gt;&gt; class TestModularInput(ModularInput):</span>
<span class="sd">       &gt;&gt;&gt;     app = &#39;TestApp&#39;</span>
<span class="sd">       &gt;&gt;&gt;     name = &#39;test_modular_input&#39;</span>
<span class="sd">       &gt;&gt;&gt;     title = &#39;Test modular input&#39;</span>
<span class="sd">       &gt;&gt;&gt;     description = &#39;This is a test modular input&#39;</span>
<span class="sd">       &gt;&gt;&gt;     use_external_validation = True</span>
<span class="sd">       &gt;&gt;&gt;     use_single_instance = False</span>
<span class="sd">       &gt;&gt;&gt;     use_kvstore_checkpointer = True</span>
<span class="sd">       &gt;&gt;&gt;     kvstore_checkpointer_collection_name = &#39;TestCheckpoint&#39;</span>
<span class="sd">       &gt;&gt;&gt;     use_hec_event_writer = True</span>
<span class="sd">       &gt;&gt;&gt;     hec_input_name = &#39;TestEventWriter&#39;</span>
<span class="sd">       &gt;&gt;&gt;</span>
<span class="sd">       &gt;&gt;&gt;     def extra_arguments(self):</span>
<span class="sd">       &gt;&gt;&gt;         ... .. .</span>
<span class="sd">       &gt;&gt;&gt;</span>
<span class="sd">       &gt;&gt;&gt;     def do_validation(self, parameters):</span>
<span class="sd">       &gt;&gt;&gt;         ... .. .</span>
<span class="sd">       &gt;&gt;&gt;</span>
<span class="sd">       &gt;&gt;&gt;     def do_run(self, inputs):</span>
<span class="sd">       &gt;&gt;&gt;         ... .. .</span>
<span class="sd">       &gt;&gt;&gt;</span>
<span class="sd">       &gt;&gt;&gt; if __name__ == &#39;__main__&#39;:</span>
<span class="sd">       &gt;&gt;&gt;     md = TestModularInput()</span>
<span class="sd">       &gt;&gt;&gt;     md.execute()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># App name, must be overridden</span>
    <span class="n">app</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Modular input name, must be overridden</span>
    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Modular input scheme title, must be overridden</span>
    <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Modular input scheme description, must be overridden</span>
    <span class="n">description</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Modular input scheme use external validation, default is False</span>
    <span class="n">use_external_validation</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Modular input scheme use single instance mode, default is False</span>
    <span class="n">use_single_instance</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Use kvstore as checkpointer, default is True</span>
    <span class="n">use_kvstore_checkpointer</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># Collection name of kvstore checkpointer, must be overridden if</span>
    <span class="c1"># use_kvstore_checkpointer is True</span>
    <span class="n">kvstore_checkpointer_collection_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Use hec event writer</span>
    <span class="n">use_hec_event_writer</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># Input name of Splunk HEC, must be overridden if use_hec_event_writer</span>
    <span class="c1"># is True</span>
    <span class="n">hec_input_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">hec_global_settings_schema</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Validate properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_properties</span><span class="p">()</span>
        <span class="c1"># Modular input state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">should_exit</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Metadata</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_host_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_uri</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_scheme</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_host</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_port</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Modular input config name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Checkpoint dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Checkpointer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpointer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Orphan process monitor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Event writer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_event_writer</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_validate_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="n">ModularInputException</span><span class="p">(</span>
                <span class="s1">&#39;Attributes: &quot;app&quot;, &quot;name&quot;, &quot;title&quot;, &quot;description&quot; must &#39;</span>
                <span class="s2">&quot;be overriden.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_kvstore_checkpointer</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kvstore_checkpointer_collection_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModularInputException</span><span class="p">(</span>
                    <span class="s1">&#39;Attribute: &quot;kvstore_checkpointer_collection_name&quot; must&#39;</span>
                    <span class="s1">&#39;be overriden if &quot;use_kvstore_checkpointer&quot; is True&quot;.&#39;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kvstore_checkpointer_collection_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModularInputException</span><span class="p">(</span>
                    <span class="s1">&#39;Attribute: &quot;kvstore_checkpointer_collection_name&quot; can&#39;</span>
                    <span class="s2">&quot; not be empty.&quot;</span>
                <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_hec_event_writer</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hec_input_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModularInputException</span><span class="p">(</span>
                    <span class="s1">&#39;Attribute: &quot;hec_input_name&quot; must be overriden &#39;</span>
                    <span class="s1">&#39;if &quot;use_hec_event_writer&quot; is True.&#39;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">hec_input_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModularInputException</span><span class="p">(</span>
                    <span class="s1">&#39;Attribute: &quot;hec_input_name&quot; can not be empty.&#39;</span>
                <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">checkpointer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">checkpointer</span><span class="o">.</span><span class="n">Checkpointer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get checkpointer object.</span>

<span class="sd">        The checkpointer returned depends on use_kvstore_checkpointer flag,</span>
<span class="sd">        if use_kvstore_checkpointer is true will return an KVStoreCheckpointer</span>
<span class="sd">        object else an FileCheckpointer object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A checkpointer object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkpointer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkpointer</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpointer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_checkpointer</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checkpointer</span>

    <span class="k">def</span> <span class="nf">_create_checkpointer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_kvstore_checkpointer</span><span class="p">:</span>
            <span class="n">checkpointer_name</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kvstore_checkpointer_collection_name</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">checkpointer</span><span class="o">.</span><span class="n">KVStoreCheckpointer</span><span class="p">(</span>
                    <span class="n">checkpointer_name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
                    <span class="n">owner</span><span class="o">=</span><span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
                    <span class="n">scheme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">server_scheme</span><span class="p">,</span>
                    <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">server_host</span><span class="p">,</span>
                    <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">server_port</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to init kvstore checkpointer: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">checkpointer</span><span class="o">.</span><span class="n">FileCheckpointer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">event_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">EventWriter</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get event writer object.</span>

<span class="sd">        The event writer returned depends on use_hec_event_writer flag,</span>
<span class="sd">        if use_hec_event_writer is true will return an HECEventWriter</span>
<span class="sd">        object else an ClassicEventWriter object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Event writer object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_writer</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_event_writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_event_writer</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_event_writer</span>

    <span class="k">def</span> <span class="nf">_create_event_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_hec_event_writer</span><span class="p">:</span>
            <span class="n">hec_input_name</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hec_input_name</span><span class="p">])</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">HECEventWriter</span><span class="p">(</span>
                    <span class="n">hec_input_name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span><span class="p">,</span>
                    <span class="n">scheme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">server_scheme</span><span class="p">,</span>
                    <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">server_host</span><span class="p">,</span>
                    <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">server_port</span><span class="p">,</span>
                    <span class="n">global_settings_schema</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hec_global_settings_schema</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Failed to init HECEventWriter: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="k">raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">ClassicEventWriter</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_update_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_host_name</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;server_host&quot;</span><span class="p">]</span>
        <span class="n">splunkd</span> <span class="o">=</span> <span class="n">urlparse</span><span class="o">.</span><span class="n">urlsplit</span><span class="p">(</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;server_uri&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_uri</span> <span class="o">=</span> <span class="n">splunkd</span><span class="o">.</span><span class="n">geturl</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_scheme</span> <span class="o">=</span> <span class="n">splunkd</span><span class="o">.</span><span class="n">scheme</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_host</span> <span class="o">=</span> <span class="n">splunkd</span><span class="o">.</span><span class="n">hostname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_port</span> <span class="o">=</span> <span class="n">splunkd</span><span class="o">.</span><span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;session_key&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;checkpoint_dir&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_do_scheme</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="n">Scheme</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="n">scheme</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span>
        <span class="n">scheme</span><span class="o">.</span><span class="n">use_external_validation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_external_validation</span>
        <span class="n">scheme</span><span class="o">.</span><span class="n">streaming_mode</span> <span class="o">=</span> <span class="n">Scheme</span><span class="o">.</span><span class="n">streaming_mode_xml</span>
        <span class="n">scheme</span><span class="o">.</span><span class="n">use_single_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_single_instance</span>

        <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extra_arguments</span><span class="p">():</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">argument</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">validation</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_type&quot;</span><span class="p">,</span> <span class="n">Argument</span><span class="o">.</span><span class="n">data_type_string</span><span class="p">)</span>
            <span class="n">required_on_edit</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required_on_edit&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">required_on_create</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;required_on_create&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

            <span class="n">scheme</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
                <span class="n">Argument</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                    <span class="n">validation</span><span class="o">=</span><span class="n">validation</span><span class="p">,</span>
                    <span class="n">data_type</span><span class="o">=</span><span class="n">data_type</span><span class="p">,</span>
                    <span class="n">required_on_edit</span><span class="o">=</span><span class="n">required_on_edit</span><span class="p">,</span>
                    <span class="n">required_on_create</span><span class="o">=</span><span class="n">required_on_create</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">defused_et</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">scheme</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;unicode&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">extra_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extra arguments for modular input.</span>

<span class="sd">        Default implementation is returning an empty list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of arguments like::</span>

<span class="sd">                [</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;name&#39;: &#39;arg1&#39;,</span>
<span class="sd">                        &#39;title&#39;: &#39;arg1 title&#39;,</span>
<span class="sd">                        &#39;description&#39;: &#39;arg1 description&#39;,</span>
<span class="sd">                        &#39;validation&#39;: &#39;arg1 validation statement&#39;,</span>
<span class="sd">                        &#39;data_type&#39;: Argument.data_type_string,</span>
<span class="sd">                        &#39;required_on_edit&#39;: False,</span>
<span class="sd">                        &#39;required_on_create&#39;: False</span>
<span class="sd">                    },</span>
<span class="sd">                    {...},</span>
<span class="sd">                    {...}</span>
<span class="sd">                ]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">do_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handles external validation for modular input kinds.</span>

<span class="sd">        When Splunk calls a modular input script in validation mode, it will</span>
<span class="sd">        pass in an XML document giving information about the Splunk instance</span>
<span class="sd">        (so you can call back into it if needed) and the name and parameters</span>
<span class="sd">        of the proposed input. If this function does not throw an exception,</span>
<span class="sd">        the validation is assumed to succeed. Otherwise any errors thrown will</span>
<span class="sd">        be turned into a string and logged back to Splunk.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            parameters: The parameters of input passed by splunkd.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Exception: If validation is failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">do_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs this modular input.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            inputs: Command line arguments passed to this modular input.</span>
<span class="sd">                For single instance mode, inputs like::</span>

<span class="sd">                    {</span>
<span class="sd">                    &#39;stanza_name1&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                    &#39;stanza_name2&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                    &#39;stanza_name3&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                    }</span>

<span class="sd">                For multiple instance mode, inputs like::</span>

<span class="sd">                    {</span>
<span class="sd">                    &#39;stanza_name1&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                    }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">register_teardown_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register teardown signal handler.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            handler: Teardown signal handler.</span>
<span class="sd">            args: Arguments to the handler.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; mi = ModularInput(...)</span>
<span class="sd">           &gt;&gt;&gt; def teardown_handler(arg1, arg2, ...):</span>
<span class="sd">           &gt;&gt;&gt;     ...</span>
<span class="sd">           &gt;&gt;&gt; mi.register_teardown_handler(teardown_handler, arg1, arg2, ...)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_teardown_handler</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
            <span class="n">handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="n">utils</span><span class="o">.</span><span class="n">handle_teardown_signals</span><span class="p">(</span><span class="n">_teardown_handler</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_orphan_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register orphan process handler.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            handler: Teardown signal handler.</span>
<span class="sd">            args: Arguments to the handler.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; mi = ModularInput(...)</span>
<span class="sd">           &gt;&gt;&gt; def orphan_handler(arg1, arg2, ...):</span>
<span class="sd">           &gt;&gt;&gt;     ...</span>
<span class="sd">           &gt;&gt;&gt; mi.register_orphan_handler(orphan_handler, arg1, arg2, ...)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_orphan_handler</span><span class="p">():</span>
            <span class="n">handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span> <span class="o">=</span> <span class="n">OrphanProcessMonitor</span><span class="p">(</span><span class="n">_orphan_handler</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_validation_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get validation definition.</span>

<span class="sd">        This method can be overwritten to get validation definition from</span>
<span class="sd">        other input instead `stdin`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict object must contains `metadata` and `parameters`::</span>

<span class="sd">                example: {</span>
<span class="sd">                    &#39;metadata&#39;: {</span>
<span class="sd">                    &#39;session_key&#39;: &#39;iCKPS0cvmpyeJk...sdaf&#39;,</span>
<span class="sd">                    &#39;server_host&#39;: &#39;test-test.com&#39;,</span>
<span class="sd">                    &#39;server_uri&#39;: &#39;https://127.0.0.1:8089&#39;,</span>
<span class="sd">                    &#39;checkpoint_dir&#39;: &#39;/tmp&#39;</span>
<span class="sd">                    },</span>
<span class="sd">                    parameters: {&#39;args1&#39;: value1, &#39;args2&#39;: value2}</span>
<span class="sd">                }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">validation_definition</span> <span class="o">=</span> <span class="n">ValidationDefinition</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">validation_definition</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="n">validation_definition</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">get_input_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get input definition.</span>

<span class="sd">        This method can be overwritten to get input definition from</span>
<span class="sd">        other input instead `stdin`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict object must contain `metadata` and `inputs`::</span>

<span class="sd">                example: {</span>
<span class="sd">                    &#39;metadata&#39;: {</span>
<span class="sd">                    &#39;session_key&#39;: &#39;iCKPS0cvmpyeJk...sdaf&#39;,</span>
<span class="sd">                    &#39;server_host&#39;: &#39;test-test.com&#39;,</span>
<span class="sd">                    &#39;server_uri&#39;: &#39;https://127.0.0.1:8089&#39;,</span>
<span class="sd">                    &#39;checkpoint_dir&#39;: &#39;/tmp&#39;</span>
<span class="sd">                    },</span>
<span class="sd">                    inputs: {</span>
<span class="sd">                    &#39;stanza1&#39;: {&#39;arg1&#39;: value1, &#39;arg2&#39;: value2},</span>
<span class="sd">                    &#39;stanza2&#39;: {&#39;arg1&#39;: value1, &#39;arg2&#39;: value2}</span>
<span class="sd">                    }</span>
<span class="sd">                }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">input_definition</span> <span class="o">=</span> <span class="n">InputDefinition</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">input_definition</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="n">input_definition</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modular input entry.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; class TestModularInput(ModularInput):</span>
<span class="sd">           &gt;&gt;&gt;         ... .. .</span>
<span class="sd">           &gt;&gt;&gt;</span>
<span class="sd">           &gt;&gt;&gt; if __name__ == &#39;__main__&#39;:</span>
<span class="sd">           &gt;&gt;&gt;     md = TestModularInput()</span>
<span class="sd">           &gt;&gt;&gt;     md.execute()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">input_definition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_input_definition</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata</span><span class="p">(</span><span class="n">input_definition</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_single_instance</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_definition</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">do_run</span><span class="p">(</span><span class="n">input_definition</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">])</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Modular input: </span><span class="si">%s</span><span class="s2"> exit normally.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Modular input: </span><span class="si">%s</span><span class="s2"> exit with exception: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="mi">1</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="c1"># Stop orphan monitor if any</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;--scheme&quot;</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_scheme</span><span class="p">())</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="k">return</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;--validate-arguments&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">validation_definition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_validation_definition</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata</span><span class="p">(</span><span class="n">validation_definition</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">do_validation</span><span class="p">(</span><span class="n">validation_definition</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">])</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                    <span class="s2">&quot;Modular input: </span><span class="si">%s</span><span class="s2"> validate arguments with exception: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                <span class="p">)</span>
                <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
                <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">defused_et</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;Modular input: </span><span class="si">%s</span><span class="s1"> run with invalid arguments: &quot;</span><span class="si">%s</span><span class="s1">&quot;.&#39;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.app" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">app</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.app" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.checkpointer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">checkpointer</span><span class="p">:</span> <span class="n">checkpointer</span><span class="o">.</span><span class="n">Checkpointer</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.checkpointer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get checkpointer object.</p>
<p>The checkpointer returned depends on use_kvstore_checkpointer flag,
if use_kvstore_checkpointer is true will return an KVStoreCheckpointer
object else an FileCheckpointer object.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.modular_input.ModularInput.checkpointer">checkpointer</span>.<span data-autorefs-optional-hover="solnlib.modular_input.modular_input.ModularInput.checkpointer.Checkpointer">Checkpointer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A checkpointer object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.config_name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">config_name</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.config_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.description" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">description</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.description" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.event_writer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">event_writer</span><span class="p">:</span> <span class="n">event_writer</span><span class="o">.</span><span class="n">EventWriter</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.event_writer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get event writer object.</p>
<p>The event writer returned depends on use_hec_event_writer flag,
if use_hec_event_writer is true will return an HECEventWriter
object else an ClassicEventWriter object.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.modular_input.modular_input.ModularInput.event_writer">event_writer</span>.<span data-autorefs-optional-hover="solnlib.modular_input.modular_input.ModularInput.event_writer.EventWriter">EventWriter</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Event writer object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.hec_global_settings_schema" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">hec_global_settings_schema</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.hec_global_settings_schema" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.hec_input_name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">hec_input_name</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.hec_input_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.kvstore_checkpointer_collection_name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">kvstore_checkpointer_collection_name</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.kvstore_checkpointer_collection_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_host" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">server_host</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_host" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_host_name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">server_host_name</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_host_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_port" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">server_port</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_port" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_scheme" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">server_scheme</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_scheme" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_uri" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">server_uri</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.server_uri" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.session_key" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">session_key</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.session_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.should_exit" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">should_exit</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.should_exit" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.title" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">title</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.title" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_external_validation" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">use_external_validation</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_external_validation" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_hec_event_writer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">use_hec_event_writer</span> <span class="o">=</span> <span class="kc">True</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_hec_event_writer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_kvstore_checkpointer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">use_kvstore_checkpointer</span> <span class="o">=</span> <span class="kc">True</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_kvstore_checkpointer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_single_instance" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">use_single_instance</span> <span class="o">=</span> <span class="kc">False</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.use_single_instance" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># Validate properties</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_properties</span><span class="p">()</span>
    <span class="c1"># Modular input state</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">should_exit</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># Metadata</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">server_host_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">server_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">server_scheme</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">server_host</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">server_port</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Modular input config name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Checkpoint dir</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint_dir</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Checkpointer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_checkpointer</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Orphan process monitor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Event writer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_event_writer</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.do_run" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">do_run</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.do_run" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Runs this modular input.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Command line arguments passed to this modular input.
For single instance mode, inputs like::</p>
<div class="codehilite"><pre><span></span><code>{
&#39;stanza_name1&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}
&#39;stanza_name2&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}
&#39;stanza_name3&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}
}
</code></pre></div>

<p>For multiple instance mode, inputs like::</p>
<div class="codehilite"><pre><span></span><code>{
&#39;stanza_name1&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}
}
</code></pre></div>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">do_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runs this modular input.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        inputs: Command line arguments passed to this modular input.</span>
<span class="sd">            For single instance mode, inputs like::</span>

<span class="sd">                {</span>
<span class="sd">                &#39;stanza_name1&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                &#39;stanza_name2&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                &#39;stanza_name3&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                }</span>

<span class="sd">            For multiple instance mode, inputs like::</span>

<span class="sd">                {</span>
<span class="sd">                &#39;stanza_name1&#39;: {&#39;arg1&#39;: &#39;arg1_value&#39;, &#39;arg2&#39;: &#39;arg2_value&#39;, ...}</span>
<span class="sd">                }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.do_validation" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">do_validation</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.do_validation" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Handles external validation for modular input kinds.</p>
<p>When Splunk calls a modular input script in validation mode, it will
pass in an XML document giving information about the Splunk instance
(so you can call back into it if needed) and the name and parameters
of the proposed input. If this function does not throw an exception,
the validation is assumed to succeed. Otherwise any errors thrown will
be turned into a string and logged back to Splunk.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parameters</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The parameters of input passed by splunkd.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If validation is failed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">do_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Handles external validation for modular input kinds.</span>

<span class="sd">    When Splunk calls a modular input script in validation mode, it will</span>
<span class="sd">    pass in an XML document giving information about the Splunk instance</span>
<span class="sd">    (so you can call back into it if needed) and the name and parameters</span>
<span class="sd">    of the proposed input. If this function does not throw an exception,</span>
<span class="sd">    the validation is assumed to succeed. Otherwise any errors thrown will</span>
<span class="sd">    be turned into a string and logged back to Splunk.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        parameters: The parameters of input passed by splunkd.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: If validation is failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.execute" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">execute</span><span class="p">()</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.execute" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Modular input entry.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">TestModularInput</span><span class="p">(</span><span class="n">ModularInput</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="o">...</span> <span class="o">..</span> <span class="o">.</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">md</span> <span class="o">=</span> <span class="n">TestModularInput</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">md</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Modular input entry.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; class TestModularInput(ModularInput):</span>
<span class="sd">       &gt;&gt;&gt;         ... .. .</span>
<span class="sd">       &gt;&gt;&gt;</span>
<span class="sd">       &gt;&gt;&gt; if __name__ == &#39;__main__&#39;:</span>
<span class="sd">       &gt;&gt;&gt;     md = TestModularInput()</span>
<span class="sd">       &gt;&gt;&gt;     md.execute()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">input_definition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_input_definition</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata</span><span class="p">(</span><span class="n">input_definition</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_single_instance</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">input_definition</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_run</span><span class="p">(</span><span class="n">input_definition</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">])</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Modular input: </span><span class="si">%s</span><span class="s2"> exit normally.&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Modular input: </span><span class="si">%s</span><span class="s2"> exit with exception: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="mi">1</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="c1"># Stop orphan monitor if any</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;--scheme&quot;</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_scheme</span><span class="p">())</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">elif</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;--validate-arguments&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">validation_definition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_validation_definition</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_metadata</span><span class="p">(</span><span class="n">validation_definition</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">do_validation</span><span class="p">(</span><span class="n">validation_definition</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">])</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Modular input: </span><span class="si">%s</span><span class="s2"> validate arguments with exception: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">)</span>
            <span class="n">ET</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">defused_et</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">root</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s1">&#39;Modular input: </span><span class="si">%s</span><span class="s1"> run with invalid arguments: &quot;</span><span class="si">%s</span><span class="s1">&quot;.&#39;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.extra_arguments" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">extra_arguments</span><span class="p">()</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.extra_arguments" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Extra arguments for modular input.</p>
<p>Default implementation is returning an empty list.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of arguments like::</p>
<p>[
    {
        &lsquo;name&rsquo;: &lsquo;arg1&rsquo;,
        &lsquo;title&rsquo;: &lsquo;arg1 title&rsquo;,
        &lsquo;description&rsquo;: &lsquo;arg1 description&rsquo;,
        &lsquo;validation&rsquo;: &lsquo;arg1 validation statement&rsquo;,
        &lsquo;data_type&rsquo;: Argument.data_type_string,
        &lsquo;required_on_edit&rsquo;: False,
        &lsquo;required_on_create&rsquo;: False
    },
    {&hellip;},
    {&hellip;}
]</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extra_arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extra arguments for modular input.</span>

<span class="sd">    Default implementation is returning an empty list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of arguments like::</span>

<span class="sd">            [</span>
<span class="sd">                {</span>
<span class="sd">                    &#39;name&#39;: &#39;arg1&#39;,</span>
<span class="sd">                    &#39;title&#39;: &#39;arg1 title&#39;,</span>
<span class="sd">                    &#39;description&#39;: &#39;arg1 description&#39;,</span>
<span class="sd">                    &#39;validation&#39;: &#39;arg1 validation statement&#39;,</span>
<span class="sd">                    &#39;data_type&#39;: Argument.data_type_string,</span>
<span class="sd">                    &#39;required_on_edit&#39;: False,</span>
<span class="sd">                    &#39;required_on_create&#39;: False</span>
<span class="sd">                },</span>
<span class="sd">                {...},</span>
<span class="sd">                {...}</span>
<span class="sd">            ]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.get_input_definition" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_input_definition</span><span class="p">()</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.get_input_definition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get input definition.</p>
<p>This method can be overwritten to get input definition from
other input instead <code>stdin</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dict object must contain <code>metadata</code> and <code>inputs</code>::</p>
<p>example: {
    &lsquo;metadata&rsquo;: {
    &lsquo;session_key&rsquo;: &lsquo;iCKPS0cvmpyeJk&hellip;sdaf&rsquo;,
    &lsquo;server_host&rsquo;: &lsquo;test-test.com&rsquo;,
    &lsquo;server_uri&rsquo;: &lsquo;https://127.0.0.1:8089&rsquo;,
    &lsquo;checkpoint_dir&rsquo;: &lsquo;/tmp&rsquo;
    },
    inputs: {
    &lsquo;stanza1&rsquo;: {&lsquo;arg1&rsquo;: value1, &lsquo;arg2&rsquo;: value2},
    &lsquo;stanza2&rsquo;: {&lsquo;arg1&rsquo;: value1, &lsquo;arg2&rsquo;: value2}
    }
}</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_input_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get input definition.</span>

<span class="sd">    This method can be overwritten to get input definition from</span>
<span class="sd">    other input instead `stdin`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict object must contain `metadata` and `inputs`::</span>

<span class="sd">            example: {</span>
<span class="sd">                &#39;metadata&#39;: {</span>
<span class="sd">                &#39;session_key&#39;: &#39;iCKPS0cvmpyeJk...sdaf&#39;,</span>
<span class="sd">                &#39;server_host&#39;: &#39;test-test.com&#39;,</span>
<span class="sd">                &#39;server_uri&#39;: &#39;https://127.0.0.1:8089&#39;,</span>
<span class="sd">                &#39;checkpoint_dir&#39;: &#39;/tmp&#39;</span>
<span class="sd">                },</span>
<span class="sd">                inputs: {</span>
<span class="sd">                &#39;stanza1&#39;: {&#39;arg1&#39;: value1, &#39;arg2&#39;: value2},</span>
<span class="sd">                &#39;stanza2&#39;: {&#39;arg1&#39;: value1, &#39;arg2&#39;: value2}</span>
<span class="sd">                }</span>
<span class="sd">            }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">input_definition</span> <span class="o">=</span> <span class="n">InputDefinition</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">input_definition</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="s2">&quot;inputs&quot;</span><span class="p">:</span> <span class="n">input_definition</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.get_validation_definition" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_validation_definition</span><span class="p">()</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.get_validation_definition" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get validation definition.</p>
<p>This method can be overwritten to get validation definition from
other input instead <code>stdin</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dict object must contains <code>metadata</code> and <code>parameters</code>::</p>
<p>example: {
    &lsquo;metadata&rsquo;: {
    &lsquo;session_key&rsquo;: &lsquo;iCKPS0cvmpyeJk&hellip;sdaf&rsquo;,
    &lsquo;server_host&rsquo;: &lsquo;test-test.com&rsquo;,
    &lsquo;server_uri&rsquo;: &lsquo;https://127.0.0.1:8089&rsquo;,
    &lsquo;checkpoint_dir&rsquo;: &lsquo;/tmp&rsquo;
    },
    parameters: {&lsquo;args1&rsquo;: value1, &lsquo;args2&rsquo;: value2}
}</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_validation_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get validation definition.</span>

<span class="sd">    This method can be overwritten to get validation definition from</span>
<span class="sd">    other input instead `stdin`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict object must contains `metadata` and `parameters`::</span>

<span class="sd">            example: {</span>
<span class="sd">                &#39;metadata&#39;: {</span>
<span class="sd">                &#39;session_key&#39;: &#39;iCKPS0cvmpyeJk...sdaf&#39;,</span>
<span class="sd">                &#39;server_host&#39;: &#39;test-test.com&#39;,</span>
<span class="sd">                &#39;server_uri&#39;: &#39;https://127.0.0.1:8089&#39;,</span>
<span class="sd">                &#39;checkpoint_dir&#39;: &#39;/tmp&#39;</span>
<span class="sd">                },</span>
<span class="sd">                parameters: {&#39;args1&#39;: value1, &#39;args2&#39;: value2}</span>
<span class="sd">            }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">validation_definition</span> <span class="o">=</span> <span class="n">ValidationDefinition</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="n">validation_definition</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="n">validation_definition</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.register_orphan_handler" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">register_orphan_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.register_orphan_handler" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Register orphan process handler.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>handler</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Teardown signal handler.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments to the handler.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">mi</span> <span class="o">=</span> <span class="n">ModularInput</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">orphan_handler</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mi</span><span class="o">.</span><span class="n">register_orphan_handler</span><span class="p">(</span><span class="n">orphan_handler</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_orphan_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register orphan process handler.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        handler: Teardown signal handler.</span>
<span class="sd">        args: Arguments to the handler.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; mi = ModularInput(...)</span>
<span class="sd">       &gt;&gt;&gt; def orphan_handler(arg1, arg2, ...):</span>
<span class="sd">       &gt;&gt;&gt;     ...</span>
<span class="sd">       &gt;&gt;&gt; mi.register_orphan_handler(orphan_handler, arg1, arg2, ...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_orphan_handler</span><span class="p">():</span>
        <span class="n">handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span> <span class="o">=</span> <span class="n">OrphanProcessMonitor</span><span class="p">(</span><span class="n">_orphan_handler</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orphan_monitor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.register_teardown_handler" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">register_teardown_handler</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInput.register_teardown_handler" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Register teardown signal handler.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>handler</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Teardown signal handler.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arguments to the handler.</p>
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">mi</span> <span class="o">=</span> <span class="n">ModularInput</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">teardown_handler</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mi</span><span class="o">.</span><span class="n">register_teardown_handler</span><span class="p">(</span><span class="n">teardown_handler</span><span class="p">,</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_teardown_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register teardown signal handler.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        handler: Teardown signal handler.</span>
<span class="sd">        args: Arguments to the handler.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; mi = ModularInput(...)</span>
<span class="sd">       &gt;&gt;&gt; def teardown_handler(arg1, arg2, ...):</span>
<span class="sd">       &gt;&gt;&gt;     ...</span>
<span class="sd">       &gt;&gt;&gt; mi.register_teardown_handler(teardown_handler, arg1, arg2, ...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_teardown_handler</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="n">handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="n">utils</span><span class="o">.</span><span class="n">handle_teardown_signals</span><span class="p">(</span><span class="n">_teardown_handler</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="modular_input-modular_input-solnlib.modular_input.modular_input.ModularInputException" class="doc doc-heading">
        <code>ModularInputException</code>


<a href="#modular_input-modular_input-solnlib.modular_input.modular_input.ModularInputException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for ModularInput class.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/modular_input/modular_input.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ModularInputException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for ModularInput class.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>




  </div>

  </div>

</div></section><h1 class='nav-section-title-end'>Ended: modular_input</h1><section class="print-page" id="acl"><h1 id="acl-aclpy">acl.py<a class="headerlink" href="#acl-aclpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.acl"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains interfaces that support CRUD operations on ACL.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="acl-solnlib.acl.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ACLException&#39;</span><span class="p">,</span> <span class="s1">&#39;ACLManager&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#acl-solnlib.acl.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="acl-solnlib.acl.ACLException" class="doc doc-heading">
        <code>ACLException</code>


<a href="#acl-solnlib.acl.ACLException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception raised by ACLManager.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/acl.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ACLException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised by ACLManager.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="acl-solnlib.acl.ACLManager" class="doc doc-heading">
        <code>ACLManager</code>


<a href="#acl-solnlib.acl.ACLManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>ACL manager.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">solnlib.acl</span> <span class="k">as</span> <span class="nn">sacl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saclm</span> <span class="o">=</span> <span class="n">sacl</span><span class="o">.</span><span class="n">ACLManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="s1">&#39;Splunk_TA_test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saclm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data/transforms/extractions&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saclm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;data/transforms/extractions/_acl&#39;</span><span class="p">,</span>
<span class="go">                 perms_read=[&#39;*&#39;], perms_write=[&#39;*&#39;])</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/acl.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ACLManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ACL manager.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; import solnlib.acl as sacl</span>
<span class="sd">       &gt;&gt;&gt; saclm = sacl.ACLManager(session_key, &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; saclm.get(&#39;data/transforms/extractions&#39;)</span>
<span class="sd">       &gt;&gt;&gt; saclm.update(&#39;data/transforms/extractions/_acl&#39;,</span>
<span class="sd">                        perms_read=[&#39;*&#39;], perms_write=[&#39;*&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ACLManager.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app</span><span class="p">,</span>
            <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get ACL of  /servicesNS/{`owner`}/{`app`}/{`path`}.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            path: Path of ACL relative to /servicesNS/{`owner`}/{`app`}</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict contains ACL.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ACLException: If `path` is invalid.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; aclm = acl.ACLManager(session_key, &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; perms = aclm.get(&#39;data/transforms/extractions/_acl&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">ACLException</span><span class="p">(</span><span class="s2">&quot;Invalid endpoint: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;acl&quot;</span><span class="p">]</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">perms_read</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">perms_write</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update ACL of /servicesNS/{`owner`}/{`app`}/{`path`}.</span>

<span class="sd">        If the ACL is per-entity (ends in /acl), owner can be reassigned. If</span>
<span class="sd">        the acl is endpoint-level (ends in _acl), owner will be ignored. The</span>
<span class="sd">        &#39;sharing&#39; setting is always retrieved from the current.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            path: Path of ACL relative to /servicesNS/{owner}/{app}. MUST</span>
<span class="sd">                end with /acl or /_acl indicating whether the permission is applied</span>
<span class="sd">                at the per-entity level or endpoint level respectively.</span>
<span class="sd">            owner: (optional) New owner of ACL, default is `nobody`.</span>
<span class="sd">            perms_read: (optional) List of roles ([&#39;*&#39;] for all roles). If</span>
<span class="sd">                unspecified we will POST with current (if available) perms.read,</span>
<span class="sd">                default is None.</span>
<span class="sd">            perms_write: (optional) List of roles ([&#39;*&#39;] for all roles). If</span>
<span class="sd">                unspecified we will POST with current (if available) perms.write,</span>
<span class="sd">                default is None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dict contains ACL after update.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ACLException: If `path` is invalid.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; aclm = acl.ACLManager(session_key, &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; perms = aclm.update(&#39;data/transforms/extractions/_acl&#39;,</span>
<span class="sd">                                   perms_read=[&#39;admin&#39;], perms_write=[&#39;admin&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/acl&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/_acl&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ACLException</span><span class="p">(</span>
                <span class="s2">&quot;Invalid endpoint: </span><span class="si">%s</span><span class="s2">, must end with /acl or /_acl.&quot;</span> <span class="o">%</span> <span class="n">path</span>
            <span class="p">)</span>

        <span class="n">curr_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="n">postargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">perms_read</span><span class="p">:</span>
            <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">perms_read</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">curr_read</span> <span class="o">=</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;perms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">curr_read</span><span class="p">:</span>
                <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curr_read</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">perms_write</span><span class="p">:</span>
            <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">perms_write</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">curr_write</span> <span class="o">=</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;perms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">curr_write</span><span class="p">:</span>
                <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curr_write</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/acl&quot;</span><span class="p">):</span>
            <span class="c1"># Allow ownership to be reset only at entity level.</span>
            <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span> <span class="ow">or</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span>

        <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;sharing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;sharing&quot;</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                <span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">binding</span><span class="o">.</span><span class="n">_encode</span><span class="p">(</span><span class="o">**</span><span class="n">postargs</span><span class="p">),</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">ACLException</span><span class="p">(</span><span class="s2">&quot;Invalid endpoint: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;acl&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="acl-solnlib.acl.ACLManager.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#acl-solnlib.acl.ACLManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ACLManager.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/acl.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ACLManager.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">app</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="acl-solnlib.acl.ACLManager.get" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

<a href="#acl-solnlib.acl.ACLManager.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get ACL of  /servicesNS/{<code>owner</code>}/{<code>app</code>}/{<code>path</code>}.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path of ACL relative to /servicesNS/{<code>owner</code>}/{<code>app</code>}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dict contains ACL.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.acl.ACLException">ACLException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>path</code> is invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">aclm</span> <span class="o">=</span> <span class="n">acl</span><span class="o">.</span><span class="n">ACLManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="s1">&#39;Splunk_TA_test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perms</span> <span class="o">=</span> <span class="n">aclm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;data/transforms/extractions/_acl&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/acl.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get ACL of  /servicesNS/{`owner`}/{`app`}/{`path`}.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        path: Path of ACL relative to /servicesNS/{`owner`}/{`app`}</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict contains ACL.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ACLException: If `path` is invalid.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; aclm = acl.ACLManager(session_key, &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; perms = aclm.get(&#39;data/transforms/extractions/_acl&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">ACLException</span><span class="p">(</span><span class="s2">&quot;Invalid endpoint: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;acl&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="acl-solnlib.acl.ACLManager.update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">perms_read</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">perms_write</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#acl-solnlib.acl.ACLManager.update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update ACL of /servicesNS/{<code>owner</code>}/{<code>app</code>}/{<code>path</code>}.</p>
<p>If the ACL is per-entity (ends in /acl), owner can be reassigned. If
the acl is endpoint-level (ends in _acl), owner will be ignored. The
&lsquo;sharing&rsquo; setting is always retrieved from the current.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path of ACL relative to /servicesNS/{owner}/{app}. MUST
end with /acl or /_acl indicating whether the permission is applied
at the per-entity level or endpoint level respectively.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) New owner of ACL, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>perms_read</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) List of roles ([&lsquo;*&rsquo;] for all roles). If
unspecified we will POST with current (if available) perms.read,
default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>perms_write</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) List of roles ([&lsquo;*&rsquo;] for all roles). If
unspecified we will POST with current (if available) perms.write,
default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dict contains ACL after update.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.acl.ACLException">ACLException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>path</code> is invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">aclm</span> <span class="o">=</span> <span class="n">acl</span><span class="o">.</span><span class="n">ACLManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="s1">&#39;Splunk_TA_test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">perms</span> <span class="o">=</span> <span class="n">aclm</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;data/transforms/extractions/_acl&#39;</span><span class="p">,</span>
<span class="go">                        perms_read=[&#39;admin&#39;], perms_write=[&#39;admin&#39;])</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/acl.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">perms_read</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">perms_write</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update ACL of /servicesNS/{`owner`}/{`app`}/{`path`}.</span>

<span class="sd">    If the ACL is per-entity (ends in /acl), owner can be reassigned. If</span>
<span class="sd">    the acl is endpoint-level (ends in _acl), owner will be ignored. The</span>
<span class="sd">    &#39;sharing&#39; setting is always retrieved from the current.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        path: Path of ACL relative to /servicesNS/{owner}/{app}. MUST</span>
<span class="sd">            end with /acl or /_acl indicating whether the permission is applied</span>
<span class="sd">            at the per-entity level or endpoint level respectively.</span>
<span class="sd">        owner: (optional) New owner of ACL, default is `nobody`.</span>
<span class="sd">        perms_read: (optional) List of roles ([&#39;*&#39;] for all roles). If</span>
<span class="sd">            unspecified we will POST with current (if available) perms.read,</span>
<span class="sd">            default is None.</span>
<span class="sd">        perms_write: (optional) List of roles ([&#39;*&#39;] for all roles). If</span>
<span class="sd">            unspecified we will POST with current (if available) perms.write,</span>
<span class="sd">            default is None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict contains ACL after update.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ACLException: If `path` is invalid.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; aclm = acl.ACLManager(session_key, &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; perms = aclm.update(&#39;data/transforms/extractions/_acl&#39;,</span>
<span class="sd">                               perms_read=[&#39;admin&#39;], perms_write=[&#39;admin&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/acl&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/_acl&quot;</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ACLException</span><span class="p">(</span>
            <span class="s2">&quot;Invalid endpoint: </span><span class="si">%s</span><span class="s2">, must end with /acl or /_acl.&quot;</span> <span class="o">%</span> <span class="n">path</span>
        <span class="p">)</span>

    <span class="n">curr_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="n">postargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">perms_read</span><span class="p">:</span>
        <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">perms_read</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">curr_read</span> <span class="o">=</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;perms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;read&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">curr_read</span><span class="p">:</span>
            <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curr_read</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">perms_write</span><span class="p">:</span>
        <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">perms_write</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">curr_write</span> <span class="o">=</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;perms&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;write&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">curr_write</span><span class="p">:</span>
            <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;perms.write&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curr_write</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/acl&quot;</span><span class="p">):</span>
        <span class="c1"># Allow ownership to be reset only at entity level.</span>
        <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">owner</span> <span class="ow">or</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;owner&quot;</span><span class="p">]</span>

    <span class="n">postargs</span><span class="p">[</span><span class="s2">&quot;sharing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">curr_acl</span><span class="p">[</span><span class="s2">&quot;sharing&quot;</span><span class="p">]</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">binding</span><span class="o">.</span><span class="n">_encode</span><span class="p">(</span><span class="o">**</span><span class="n">postargs</span><span class="p">),</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">ACLException</span><span class="p">(</span><span class="s2">&quot;Invalid endpoint: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;acl&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="credentials"><h1 id="credentials-credentialspy">credentials.py<a class="headerlink" href="#credentials-credentialspy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.credentials"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains Splunk credential related interfaces.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="credentials-solnlib.credentials.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CredentialException&#39;</span><span class="p">,</span> <span class="s1">&#39;CredentialNotExistException&#39;</span><span class="p">,</span> <span class="s1">&#39;CredentialManager&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#credentials-solnlib.credentials.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="credentials-solnlib.credentials.CredentialException" class="doc doc-heading">
        <code>CredentialException</code>


<a href="#credentials-solnlib.credentials.CredentialException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>General exception regarding credentials.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/credentials.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CredentialException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;General exception regarding credentials.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="credentials-solnlib.credentials.CredentialManager" class="doc doc-heading">
        <code>CredentialManager</code>


<a href="#credentials-solnlib.credentials.CredentialManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Credential manager.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">CredentialManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                       &#39;Splunk_TA_test&#39;,</span>
<span class="go">                                       realm=&#39;realm_test&#39;)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/credentials.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CredentialManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Credential manager.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">       &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                              realm=&#39;realm_test&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Splunk can only encrypt string with length &lt;=255</span>
    <span class="n">SPLUNK_CRED_LEN_LIMIT</span> <span class="o">=</span> <span class="mi">255</span>

    <span class="c1"># Splunk credential separator</span>
    <span class="n">SEP</span> <span class="o">=</span> <span class="s2">&quot;``splunk_cred_sep``&quot;</span>

    <span class="c1"># Splunk credential end mark</span>
    <span class="n">END_MARK</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;``splunk_cred_sep``S``splunk_cred_sep``P``splunk_cred_sep``L``splunk_cred_sep``&quot;</span>
        <span class="s2">&quot;U``splunk_cred_sep``N``splunk_cred_sep``K``splunk_cred_sep``&quot;</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes CredentialManager.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            realm: (optional) Realm of credential, default is None.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="n">realm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app</span><span class="p">,</span>
            <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">storage_passwords</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get password.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            user: User name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Clear user password.</span>

<span class="sd">        Raises:</span>
<span class="sd">            CredentialNotExistException: If password for &#39;realm:user&#39; doesn&#39;t exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">           &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                                  &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                                  realm=&#39;realm_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; cm.get_password(&#39;testuser2&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_clear_passwords_in_realm</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_clear_passwords</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">password</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">password</span><span class="p">[</span><span class="s2">&quot;realm&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">password</span><span class="p">[</span><span class="s2">&quot;clear_password&quot;</span><span class="p">]</span>

        <span class="k">raise</span> <span class="n">CredentialNotExistException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Failed to get password of realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">, user=</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">set_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set password.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            user: User name.</span>
<span class="sd">            password: User password.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">           &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                                  &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                                  realm=&#39;realm_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; cm.set_password(&#39;testuser1&#39;, &#39;password1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
            <span class="n">curr_str</span> <span class="o">=</span> <span class="n">password</span><span class="p">[</span>
                <span class="n">length</span> <span class="p">:</span> <span class="n">length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPLUNK_CRED_LEN_LIMIT</span>  <span class="c1"># noqa: E203</span>
            <span class="p">]</span>
            <span class="n">partial_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_password</span><span class="p">(</span><span class="n">partial_user</span><span class="p">,</span> <span class="n">curr_str</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPLUNK_CRED_LEN_LIMIT</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Append another stanza to mark the end of the password</span>
        <span class="n">partial_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_password</span><span class="p">(</span><span class="n">partial_user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">END_MARK</span><span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_update_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update password.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            user: User name.</span>
<span class="sd">            password: User password.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">           &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                                  &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                                  realm=&#39;realm_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; cm._update_password(&#39;testuser1&#39;, &#39;password1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">password</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ex</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">409</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords_in_realm</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">pwd_stanza</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">pwd_stanza</span><span class="o">.</span><span class="n">realm</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">and</span> <span class="n">pwd_stanza</span><span class="o">.</span><span class="n">username</span> <span class="o">==</span> <span class="n">user</span><span class="p">:</span>
                        <span class="n">pwd_stanza</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">)</span>
                        <span class="k">return</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Can not get the password object for realm: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2"> user: </span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ex</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete password.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            user: User name.</span>

<span class="sd">        Raises:</span>
<span class="sd">             CredentialNotExistException: If password of realm:user doesn&#39;t exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">           &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                                  &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                                  realm=&#39;realm_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; cm.delete_password(&#39;testuser1&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords_in_realm</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords</span><span class="p">()</span>
        <span class="n">deleted</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">ent_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
            <span class="sa">r</span><span class="s2">&quot;(</span><span class="si">{}{}</span><span class="s2">\d+)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="p">(</span><span class="n">user</span> <span class="o">==</span> <span class="n">password</span><span class="o">.</span><span class="n">username</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ent_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span> <span class="ow">and</span> <span class="n">password</span><span class="o">.</span><span class="n">realm</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">:</span>
                <span class="n">password</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
                <span class="n">deleted</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">deleted</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">CredentialNotExistException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to delete password of realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">, user=</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_raw_passwords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">StoragePassword</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all passwords in the &quot;raw&quot; format.&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Please pass realm to the CredentialManager, &quot;</span>
            <span class="s2">&quot;so it can utilize get_raw_passwords_in_realm method instead.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_raw_passwords_in_realm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">StoragePassword</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all passwords within the realm in the &quot;raw&quot; format.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No realm was specified&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_clear_passwords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all passwords in the &quot;clear&quot; format.&quot;&quot;&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Please pass realm to the CredentialManager, &quot;</span>
            <span class="s2">&quot;so it can utilize get_clear_passwords_in_realm method instead.&quot;</span>
        <span class="p">)</span>
        <span class="n">raw_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_clear_passwords</span><span class="p">(</span><span class="n">raw_passwords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_clear_passwords_in_realm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all passwords within the realm in the &quot;clear&quot; format.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No realm was specified&quot;</span><span class="p">)</span>
        <span class="n">raw_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords_in_realm</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_clear_passwords</span><span class="p">(</span><span class="n">raw_passwords</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_all_passwords_in_realm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">StoragePassword</span><span class="p">]:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;_get_all_passwords_in_realm is deprecated, &quot;</span>
            <span class="s2">&quot;please use get_raw_passwords_in_realm instead.&quot;</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">:</span>
            <span class="n">all_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
                <span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">all_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_passwords</span>

    <span class="k">def</span> <span class="nf">_get_clear_passwords</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">passwords</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">StoragePassword</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">ptn</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(.+)</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="si">}</span><span class="s2">(\d+)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">ptn</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
                <span class="n">actual_name</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span>
                <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">actual_name</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
                    <span class="n">exist_stanza</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">actual_name</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">exist_stanza</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">exist_stanza</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">actual_name</span>
                    <span class="n">exist_stanza</span><span class="p">[</span><span class="s2">&quot;realm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">realm</span>
                    <span class="n">exist_stanza</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">username</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">exist_stanza</span><span class="p">[</span><span class="s2">&quot;clears&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">results</span><span class="p">[</span><span class="n">actual_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">exist_stanza</span>

                <span class="n">exist_stanza</span><span class="p">[</span><span class="s2">&quot;clears&quot;</span><span class="p">][</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span><span class="o">.</span><span class="n">clear_password</span>

        <span class="c1"># Backward compatibility</span>
        <span class="c1"># To deal with the password with only one stanza which is generated by the old version.</span>
        <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
            <span class="n">match</span> <span class="o">=</span> <span class="n">ptn</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">match</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">results</span><span class="p">):</span>
                <span class="n">results</span><span class="p">[</span><span class="n">password</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">password</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="s2">&quot;realm&quot;</span><span class="p">:</span> <span class="n">password</span><span class="o">.</span><span class="n">realm</span><span class="p">,</span>
                    <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">password</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
                    <span class="s2">&quot;clear_password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="o">.</span><span class="n">clear_password</span><span class="p">,</span>
                <span class="p">}</span>

        <span class="c1"># Merge password by index</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">field_clear</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;clears&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field_clear</span><span class="p">:</span>
                <span class="n">clear_password</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">field_clear</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="k">if</span> <span class="n">field_clear</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">END_MARK</span><span class="p">:</span>
                        <span class="n">clear_password</span> <span class="o">+=</span> <span class="n">field_clear</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="n">values</span><span class="p">[</span><span class="s2">&quot;clear_password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clear_password</span>

                <span class="k">del</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;clears&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_get_all_passwords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;_get_all_passwords is deprecated, &quot;</span>
            <span class="s2">&quot;please use get_all_passwords_in_realm instead.&quot;</span><span class="p">,</span>
            <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_clear_passwords</span><span class="p">(</span><span class="n">passwords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="credentials-solnlib.credentials.CredentialManager.END_MARK" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">END_MARK</span> <span class="o">=</span> <span class="s1">&#39;``splunk_cred_sep``S``splunk_cred_sep``P``splunk_cred_sep``L``splunk_cred_sep``U``splunk_cred_sep``N``splunk_cred_sep``K``splunk_cred_sep``&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#credentials-solnlib.credentials.CredentialManager.END_MARK" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="credentials-solnlib.credentials.CredentialManager.SEP" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">SEP</span> <span class="o">=</span> <span class="s1">&#39;``splunk_cred_sep``&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#credentials-solnlib.credentials.CredentialManager.SEP" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="credentials-solnlib.credentials.CredentialManager.SPLUNK_CRED_LEN_LIMIT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">SPLUNK_CRED_LEN_LIMIT</span> <span class="o">=</span> <span class="mi">255</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#credentials-solnlib.credentials.CredentialManager.SPLUNK_CRED_LEN_LIMIT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="credentials-solnlib.credentials.CredentialManager.service" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">service</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="kc">None</span><span class="o">=</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#credentials-solnlib.credentials.CredentialManager.service" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">realm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes CredentialManager.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>realm</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Realm of credential, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes CredentialManager.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        realm: (optional) Realm of credential, default is None.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="n">realm</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">app</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">service</span><span class="o">.</span><span class="n">storage_passwords</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.delete_password" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete_password</span><span class="p">(</span><span class="n">user</span><span class="p">)</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.delete_password" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Delete password.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.credentials.CredentialNotExistException">CredentialNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If password of realm:user doesn&rsquo;t exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">CredentialManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                       &#39;Splunk_TA_test&#39;,</span>
<span class="go">                                       realm=&#39;realm_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">delete_password</span><span class="p">(</span><span class="s1">&#39;testuser1&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete password.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        user: User name.</span>

<span class="sd">    Raises:</span>
<span class="sd">         CredentialNotExistException: If password of realm:user doesn&#39;t exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">       &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                              realm=&#39;realm_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; cm.delete_password(&#39;testuser1&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords_in_realm</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords</span><span class="p">()</span>
    <span class="n">deleted</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ent_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;(</span><span class="si">{}{}</span><span class="s2">\d+)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\\\</span><span class="s2">&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
        <span class="n">match</span> <span class="o">=</span> <span class="p">(</span><span class="n">user</span> <span class="o">==</span> <span class="n">password</span><span class="o">.</span><span class="n">username</span><span class="p">)</span> <span class="ow">or</span> <span class="n">ent_pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">password</span><span class="o">.</span><span class="n">username</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">match</span> <span class="ow">and</span> <span class="n">password</span><span class="o">.</span><span class="n">realm</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">:</span>
            <span class="n">password</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="n">deleted</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">deleted</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">CredentialNotExistException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Failed to delete password of realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">, user=</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.get_clear_passwords" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_clear_passwords</span><span class="p">()</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.get_clear_passwords" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns all passwords in the &ldquo;clear&rdquo; format.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_clear_passwords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all passwords in the &quot;clear&quot; format.&quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;Please pass realm to the CredentialManager, &quot;</span>
        <span class="s2">&quot;so it can utilize get_clear_passwords_in_realm method instead.&quot;</span>
    <span class="p">)</span>
    <span class="n">raw_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_clear_passwords</span><span class="p">(</span><span class="n">raw_passwords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.get_clear_passwords_in_realm" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_clear_passwords_in_realm</span><span class="p">()</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.get_clear_passwords_in_realm" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns all passwords within the realm in the &ldquo;clear&rdquo; format.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_clear_passwords_in_realm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all passwords within the realm in the &quot;clear&quot; format.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No realm was specified&quot;</span><span class="p">)</span>
    <span class="n">raw_passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_raw_passwords_in_realm</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_clear_passwords</span><span class="p">(</span><span class="n">raw_passwords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.get_password" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_password</span><span class="p">(</span><span class="n">user</span><span class="p">)</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.get_password" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get password.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Clear user password.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.credentials.CredentialNotExistException">CredentialNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If password for &lsquo;realm:user&rsquo; doesn&rsquo;t exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">CredentialManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                       &#39;Splunk_TA_test&#39;,</span>
<span class="go">                                       realm=&#39;realm_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">get_password</span><span class="p">(</span><span class="s1">&#39;testuser2&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get password.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        user: User name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Clear user password.</span>

<span class="sd">    Raises:</span>
<span class="sd">        CredentialNotExistException: If password for &#39;realm:user&#39; doesn&#39;t exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">       &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                              realm=&#39;realm_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; cm.get_password(&#39;testuser2&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_clear_passwords_in_realm</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">passwords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_clear_passwords</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">password</span><span class="p">[</span><span class="s2">&quot;username&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">user</span> <span class="ow">and</span> <span class="n">password</span><span class="p">[</span><span class="s2">&quot;realm&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">password</span><span class="p">[</span><span class="s2">&quot;clear_password&quot;</span><span class="p">]</span>

    <span class="k">raise</span> <span class="n">CredentialNotExistException</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Failed to get password of realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">, user=</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">.&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.get_raw_passwords" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_raw_passwords</span><span class="p">()</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.get_raw_passwords" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns all passwords in the &ldquo;raw&rdquo; format.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_raw_passwords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">StoragePassword</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all passwords in the &quot;raw&quot; format.&quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;Please pass realm to the CredentialManager, &quot;</span>
        <span class="s2">&quot;so it can utilize get_raw_passwords_in_realm method instead.&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.get_raw_passwords_in_realm" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_raw_passwords_in_realm</span><span class="p">()</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.get_raw_passwords_in_realm" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns all passwords within the realm in the &ldquo;raw&rdquo; format.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_raw_passwords_in_realm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">client</span><span class="o">.</span><span class="n">StoragePassword</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns all passwords within the realm in the &quot;raw&quot; format.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No realm was specified&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_storage_passwords</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">count</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">search</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;realm=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="credentials-solnlib.credentials.CredentialManager.set_password" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">set_password</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span></code>

<a href="#credentials-solnlib.credentials.CredentialManager.set_password" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set password.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>password</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User password.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">credentials</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span> <span class="o">=</span> <span class="n">credentials</span><span class="o">.</span><span class="n">CredentialManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                       &#39;Splunk_TA_test&#39;,</span>
<span class="go">                                       realm=&#39;realm_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cm</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="s1">&#39;testuser1&#39;</span><span class="p">,</span> <span class="s1">&#39;password1&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/credentials.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">set_password</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set password.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        user: User name.</span>
<span class="sd">        password: User password.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import credentials</span>
<span class="sd">       &gt;&gt;&gt; cm = credentials.CredentialManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                                              realm=&#39;realm_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; cm.set_password(&#39;testuser1&#39;, &#39;password1&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">):</span>
        <span class="n">curr_str</span> <span class="o">=</span> <span class="n">password</span><span class="p">[</span>
            <span class="n">length</span> <span class="p">:</span> <span class="n">length</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPLUNK_CRED_LEN_LIMIT</span>  <span class="c1"># noqa: E203</span>
        <span class="p">]</span>
        <span class="n">partial_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_password</span><span class="p">(</span><span class="n">partial_user</span><span class="p">,</span> <span class="n">curr_str</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SPLUNK_CRED_LEN_LIMIT</span>
        <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Append another stanza to mark the end of the password</span>
    <span class="n">partial_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">SEP</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">user</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_update_password</span><span class="p">(</span><span class="n">partial_user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">END_MARK</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="credentials-solnlib.credentials.CredentialNotExistException" class="doc doc-heading">
        <code>CredentialNotExistException</code>


<a href="#credentials-solnlib.credentials.CredentialNotExistException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception is raised when credentials do not exist.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/credentials.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CredentialNotExistException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception is raised when credentials do not exist.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="conf_manager"><h1 id="conf_manager-conf_managerpy">conf_manager.py<a class="headerlink" href="#conf_manager-conf_managerpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.conf_manager"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains simple interfaces for Splunk config file management,
you can update/get/delete stanzas and encrypt/decrypt some fields of stanza
automatically.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="conf_manager-solnlib.conf_manager.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ConfFile&#39;</span><span class="p">,</span> <span class="s1">&#39;ConfManager&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#conf_manager-solnlib.conf_manager.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="conf_manager-solnlib.conf_manager.ConfFile" class="doc doc-heading">
        <code>ConfFile</code>


<a href="#conf_manager-solnlib.conf_manager.ConfFile" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Configuration file.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ConfFile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration file.&quot;&quot;&quot;</span>

    <span class="n">ENCRYPTED_TOKEN</span> <span class="o">=</span> <span class="s2">&quot;******&quot;</span>

    <span class="n">reserved_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;userName&quot;</span><span class="p">,</span> <span class="s2">&quot;appName&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">conf</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">ConfigurationFile</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ConfFile.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: Configuration file name.</span>
<span class="sd">            conf: Configuration file object.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            realm: (optional) Realm of credential, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span> <span class="o">=</span> <span class="n">conf</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span> <span class="o">=</span> <span class="n">app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="o">=</span> <span class="n">scheme</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cred_manager</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># &#39;realm&#39; is set to provided &#39;realm&#39; argument otherwise as default</span>
        <span class="c1"># behaviour it is set to &#39;APP_NAME&#39;.</span>
        <span class="k">if</span> <span class="n">realm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="n">realm</span>

    <span class="nd">@property</span>
    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_cred_mgr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cred_manager</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cred_manager</span> <span class="o">=</span> <span class="n">CredentialManager</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
                <span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
                <span class="n">realm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">,</span>
                <span class="n">scheme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
                <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cred_manager</span>

    <span class="k">def</span> <span class="nf">_filter_stanza</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">stanza</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">stanza</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">stanza</span>

    <span class="k">def</span> <span class="nf">_encrypt_stanza</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">,</span> <span class="n">encrypt_keys</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">encrypt_keys</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">stanza</span>

        <span class="n">encrypt_stanza_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">encrypt_keys</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">stanza</span><span class="p">]</span>
        <span class="n">encrypt_fields</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">stanza</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">encrypt_stanza_keys</span><span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">encrypt_fields</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">stanza</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cred_mgr</span><span class="o">.</span><span class="n">set_password</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">encrypt_fields</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">encrypt_stanza_keys</span><span class="p">:</span>
            <span class="n">stanza</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ENCRYPTED_TOKEN</span>

        <span class="k">return</span> <span class="n">stanza</span>

    <span class="k">def</span> <span class="nf">_decrypt_stanza</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">,</span> <span class="n">encrypted_stanza</span><span class="p">):</span>
        <span class="n">encrypted_keys</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">key</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">encrypted_stanza</span>
            <span class="k">if</span> <span class="n">encrypted_stanza</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ENCRYPTED_TOKEN</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">encrypted_keys</span><span class="p">:</span>
            <span class="n">encrypted_fields</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cred_mgr</span><span class="o">.</span><span class="n">get_password</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">encrypted_keys</span><span class="p">:</span>
                <span class="n">encrypted_stanza</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">encrypted_fields</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">encrypted_stanza</span>

    <span class="k">def</span> <span class="nf">_delete_stanza_creds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cred_mgr</span><span class="o">.</span><span class="n">delete_password</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">stanza_exist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether stanza exists.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            stanza_name: Stanza name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if stanza exists else False.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">           &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf.stanza_exist(&#39;test_stanza&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stanza_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">only_current_app</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get stanza from configuration file.</span>

<span class="sd">        Result is like:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;disabled&#39;: &#39;0&#39;,</span>
<span class="sd">                &#39;eai:appName&#39;: &#39;solnlib_demo&#39;,</span>
<span class="sd">                &#39;eai:userName&#39;: &#39;nobody&#39;,</span>
<span class="sd">                &#39;k1&#39;: &#39;1&#39;,</span>
<span class="sd">                &#39;k2&#39;: &#39;2&#39;</span>
<span class="sd">            }</span>

<span class="sd">        Arguments:</span>
<span class="sd">            stanza_name: Stanza name.</span>
<span class="sd">            only_current_app: Only include current app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Stanza.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ConfStanzaNotExistException: If stanza does not exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">           &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf.get(&#39;test_stanza&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">only_current_app</span><span class="p">:</span>
                <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
                    <span class="n">search</span><span class="o">=</span><span class="s2">&quot;eai:acl.app=</span><span class="si">{}</span><span class="s2"> name=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span> <span class="n">stanza_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\=&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stanza_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Stanza: </span><span class="si">{</span><span class="n">stanza_name</span><span class="si">}</span><span class="s2"> does not exist in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">.conf&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stanza_mgrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Stanza: </span><span class="si">{</span><span class="n">stanza_name</span><span class="si">}</span><span class="s2"> does not exist in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">.conf&quot;</span>
            <span class="p">)</span>

        <span class="n">stanza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrypt_stanza</span><span class="p">(</span><span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">stanza</span><span class="p">[</span><span class="s2">&quot;eai:access&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">access</span>
        <span class="n">stanza</span><span class="p">[</span><span class="s2">&quot;eai:appName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">app</span>
        <span class="k">return</span> <span class="n">stanza</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_current_app</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all stanzas from configuration file.</span>

<span class="sd">        Result is like:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;test&#39;:</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;disabled&#39;: &#39;0&#39;,</span>
<span class="sd">                        &#39;eai:appName&#39;: &#39;solnlib_demo&#39;,</span>
<span class="sd">                        &#39;eai:userName&#39;: &#39;nobody&#39;,</span>
<span class="sd">                        &#39;k1&#39;: &#39;1&#39;,</span>
<span class="sd">                        &#39;k2&#39;: &#39;2&#39;</span>
<span class="sd">                    }</span>
<span class="sd">            }</span>

<span class="sd">        Arguments:</span>
<span class="sd">            only_current_app: Only include current app.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict of stanzas.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">           &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf.get_all()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">only_current_app</span><span class="p">:</span>
            <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">search</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;eai:acl.app=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">stanza_mgr</span> <span class="ow">in</span> <span class="n">stanza_mgrs</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">name</span>
            <span class="n">key_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrypt_stanza</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
            <span class="n">key_values</span><span class="p">[</span><span class="s2">&quot;eai:access&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">access</span>
            <span class="n">key_values</span><span class="p">[</span><span class="s2">&quot;eai:appName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">app</span>
            <span class="n">res</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_values</span>
        <span class="k">return</span> <span class="n">res</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stanza</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">encrypt_keys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update stanza.</span>

<span class="sd">        It will try to encrypt the credential automatically fist if</span>
<span class="sd">        encrypt_keys are not None else keep stanza untouched.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            stanza_name: Stanza name.</span>
<span class="sd">            stanza: Stanza to update.</span>
<span class="sd">            encrypt_keys: Field names to encrypt.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">           &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf.update(&#39;test_stanza&#39;, {&#39;k1&#39;: 1, &#39;k2&#39;: 2}, [&#39;k1&#39;])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">stanza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_stanza</span><span class="p">(</span><span class="n">stanza</span><span class="p">)</span>
        <span class="n">encrypted_stanza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encrypt_stanza</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">,</span> <span class="n">encrypt_keys</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">stanza_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stanza_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="n">stanza_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>

        <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">encrypted_stanza</span><span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete stanza.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            stanza_name: Stanza name to delete.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ConfStanzaNotExistException: If stanza does not exist.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">           &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf.delete(&#39;test_stanza&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cred_mgr</span><span class="o">.</span><span class="n">delete_password</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">CredentialNotExistException</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;Delete stanza: </span><span class="si">%s</span><span class="s2"> error: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Stanza: </span><span class="si">{</span><span class="n">stanza_name</span><span class="si">}</span><span class="s2"> does not exist in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">.conf&quot;</span>
            <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reload configuration file.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">           &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                              &#39;Splunk_TA_test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">           &gt;&gt;&gt; conf.reload()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_reload&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.ENCRYPTED_TOKEN" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">ENCRYPTED_TOKEN</span> <span class="o">=</span> <span class="s1">&#39;******&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.ENCRYPTED_TOKEN" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.reserved_keys" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">reserved_keys</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;userName&#39;</span><span class="p">,</span> <span class="s1">&#39;appName&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.reserved_keys" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">conf</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">realm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ConfFile.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration file name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>conf</code></td>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.client">client</span>.<span data-autorefs-optional-hover="splunklib.client.ConfigurationFile">ConfigurationFile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration file object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>realm</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Realm of credential, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">conf</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">ConfigurationFile</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ConfFile.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: Configuration file name.</span>
<span class="sd">        conf: Configuration file object.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        realm: (optional) Realm of credential, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span> <span class="o">=</span> <span class="n">conf</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_app</span> <span class="o">=</span> <span class="n">app</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span> <span class="o">=</span> <span class="n">owner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="o">=</span> <span class="n">scheme</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">host</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cred_manager</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># &#39;realm&#39; is set to provided &#39;realm&#39; argument otherwise as default</span>
    <span class="c1"># behaviour it is set to &#39;APP_NAME&#39;.</span>
    <span class="k">if</span> <span class="n">realm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="n">realm</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.delete" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.delete" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Delete stanza.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stanza_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza name to delete.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.soln_exceptions.ConfStanzaNotExistException">ConfStanzaNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If stanza does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                   &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;test_stanza&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete stanza.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        stanza_name: Stanza name to delete.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ConfStanzaNotExistException: If stanza does not exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">       &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf.delete(&#39;test_stanza&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cred_mgr</span><span class="o">.</span><span class="n">delete_password</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">CredentialNotExistException</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;Delete stanza: </span><span class="si">%s</span><span class="s2"> error: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">,</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Stanza: </span><span class="si">{</span><span class="n">stanza_name</span><span class="si">}</span><span class="s2"> does not exist in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">.conf&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.get" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">,</span> <span class="n">only_current_app</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.get" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get stanza from configuration file.</p>

<details class="result-is-like" open>
  <summary>Result is like</summary>
  <p>{
    &lsquo;disabled&rsquo;: &lsquo;0&rsquo;,
    &lsquo;eai:appName&rsquo;: &lsquo;solnlib_demo&rsquo;,
    &lsquo;eai:userName&rsquo;: &lsquo;nobody&rsquo;,
    &lsquo;k1&rsquo;: &lsquo;1&rsquo;,
    &lsquo;k2&rsquo;: &lsquo;2&rsquo;
}</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stanza_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>only_current_app</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only include current app.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.soln_exceptions.ConfStanzaNotExistException">ConfStanzaNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If stanza does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                   &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;test_stanza&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">only_current_app</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get stanza from configuration file.</span>

<span class="sd">    Result is like:</span>

<span class="sd">        {</span>
<span class="sd">            &#39;disabled&#39;: &#39;0&#39;,</span>
<span class="sd">            &#39;eai:appName&#39;: &#39;solnlib_demo&#39;,</span>
<span class="sd">            &#39;eai:userName&#39;: &#39;nobody&#39;,</span>
<span class="sd">            &#39;k1&#39;: &#39;1&#39;,</span>
<span class="sd">            &#39;k2&#39;: &#39;2&#39;</span>
<span class="sd">        }</span>

<span class="sd">    Arguments:</span>
<span class="sd">        stanza_name: Stanza name.</span>
<span class="sd">        only_current_app: Only include current app.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Stanza.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ConfStanzaNotExistException: If stanza does not exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">       &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf.get(&#39;test_stanza&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">only_current_app</span><span class="p">:</span>
            <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
                <span class="n">search</span><span class="o">=</span><span class="s2">&quot;eai:acl.app=</span><span class="si">{}</span><span class="s2"> name=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span> <span class="n">stanza_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\=&quot;</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stanza_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Stanza: </span><span class="si">{</span><span class="n">stanza_name</span><span class="si">}</span><span class="s2"> does not exist in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">.conf&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stanza_mgrs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Stanza: </span><span class="si">{</span><span class="n">stanza_name</span><span class="si">}</span><span class="s2"> does not exist in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="si">}</span><span class="s2">.conf&quot;</span>
        <span class="p">)</span>

    <span class="n">stanza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrypt_stanza</span><span class="p">(</span><span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
    <span class="n">stanza</span><span class="p">[</span><span class="s2">&quot;eai:access&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">access</span>
    <span class="n">stanza</span><span class="p">[</span><span class="s2">&quot;eai:appName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgrs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">app</span>
    <span class="k">return</span> <span class="n">stanza</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.get_all" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_all</span><span class="p">(</span><span class="n">only_current_app</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.get_all" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get all stanzas from configuration file.</p>

<details class="result-is-like" open>
  <summary>Result is like</summary>
  <p>{
    &lsquo;test&rsquo;:
        {
            &lsquo;disabled&rsquo;: &lsquo;0&rsquo;,
            &lsquo;eai:appName&rsquo;: &lsquo;solnlib_demo&rsquo;,
            &lsquo;eai:userName&rsquo;: &lsquo;nobody&rsquo;,
            &lsquo;k1&rsquo;: &lsquo;1&rsquo;,
            &lsquo;k2&rsquo;: &lsquo;2&rsquo;
        }
}</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>only_current_app</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Only include current app.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Dict of stanzas.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                   &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">get_all</span><span class="p">()</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_current_app</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all stanzas from configuration file.</span>

<span class="sd">    Result is like:</span>

<span class="sd">        {</span>
<span class="sd">            &#39;test&#39;:</span>
<span class="sd">                {</span>
<span class="sd">                    &#39;disabled&#39;: &#39;0&#39;,</span>
<span class="sd">                    &#39;eai:appName&#39;: &#39;solnlib_demo&#39;,</span>
<span class="sd">                    &#39;eai:userName&#39;: &#39;nobody&#39;,</span>
<span class="sd">                    &#39;k1&#39;: &#39;1&#39;,</span>
<span class="sd">                    &#39;k2&#39;: &#39;2&#39;</span>
<span class="sd">                }</span>
<span class="sd">        }</span>

<span class="sd">    Arguments:</span>
<span class="sd">        only_current_app: Only include current app.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dict of stanzas.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">       &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf.get_all()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">only_current_app</span><span class="p">:</span>
        <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">search</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;eai:acl.app=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">stanza_mgrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">stanza_mgr</span> <span class="ow">in</span> <span class="n">stanza_mgrs</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">name</span>
        <span class="n">key_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_decrypt_stanza</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="n">key_values</span><span class="p">[</span><span class="s2">&quot;eai:access&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">access</span>
        <span class="n">key_values</span><span class="p">[</span><span class="s2">&quot;eai:appName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">app</span>
        <span class="n">res</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">key_values</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.reload" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">reload</span><span class="p">()</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.reload" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Reload configuration file.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                   &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">reload</span><span class="p">()</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reload configuration file.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">       &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf.reload()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;_reload&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.stanza_exist" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">stanza_exist</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.stanza_exist" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check whether stanza exists.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stanza_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if stanza exists else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                   &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">stanza_exist</span><span class="p">(</span><span class="s1">&#39;test_stanza&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">stanza_exist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check whether stanza exists.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        stanza_name: Stanza name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if stanza exists else False.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">       &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf.stanza_exist(&#39;test_stanza&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stanza_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfFile.update" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">,</span> <span class="n">encrypt_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfFile.update" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update stanza.</p>
<p>It will try to encrypt the credential automatically fist if
encrypt_keys are not None else keep stanza untouched.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>stanza_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza to update.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>encrypt_keys</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Field names to encrypt.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                   &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;test_stanza&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;k1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;k2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">[</span><span class="s1">&#39;k1&#39;</span><span class="p">])</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stanza_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stanza</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">encrypt_keys</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update stanza.</span>

<span class="sd">    It will try to encrypt the credential automatically fist if</span>
<span class="sd">    encrypt_keys are not None else keep stanza untouched.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        stanza_name: Stanza name.</span>
<span class="sd">        stanza: Stanza to update.</span>
<span class="sd">        encrypt_keys: Field names to encrypt.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">       &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf = cfm.get_conf(&#39;test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; conf.update(&#39;test_stanza&#39;, {&#39;k1&#39;: 1, &#39;k2&#39;: 2}, [&#39;k1&#39;])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stanza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_stanza</span><span class="p">(</span><span class="n">stanza</span><span class="p">)</span>
    <span class="n">encrypted_stanza</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encrypt_stanza</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">,</span> <span class="n">encrypt_keys</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">stanza_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">stanza_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="n">stanza_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_conf</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">stanza_name</span><span class="p">)</span>

    <span class="n">stanza_mgr</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">encrypted_stanza</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="conf_manager-solnlib.conf_manager.ConfManager" class="doc doc-heading">
        <code>ConfManager</code>


<a href="#conf_manager-solnlib.conf_manager.ConfManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Configuration file manager.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                  &#39;Splunk_TA_test&#39;)</span>
</code></pre></div>

<p><strong>Examples:</strong></p>
    <p>If stanza in passwords.conf is formatted as below:</p>
<p><code>credential:__REST_CREDENTIAL__#Splunk_TA_test#configs/conf-CONF_FILENAME:STANZA_NAME``splunk_cred_sep``1:</code></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cfm</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">ConfManager</span><span class="p">(</span>
<span class="go">        session_key,</span>
<span class="go">        &#39;Splunk_TA_test&#39;,</span>
<span class="go">        realm=&#39;__REST_CREDENTIAL__#Splunk_TA_test#configs/conf-CONF_FILENAME&#39;</span>
<span class="go">    )</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ConfManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configuration file manager.</span>

<span class="sd">    Examples:</span>

<span class="sd">        &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">        &gt;&gt;&gt; cfm = conf_manager.ConfManager(session_key,</span>
<span class="sd">                                          &#39;Splunk_TA_test&#39;)</span>

<span class="sd">    Examples:</span>
<span class="sd">        If stanza in passwords.conf is formatted as below:</span>

<span class="sd">        `credential:__REST_CREDENTIAL__#Splunk_TA_test#configs/conf-CONF_FILENAME:STANZA_NAME``splunk_cred_sep``1:`</span>

<span class="sd">        &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">        &gt;&gt;&gt; cfm = conf_manager.ConfManager(</span>
<span class="sd">                session_key,</span>
<span class="sd">                &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                realm=&#39;__REST_CREDENTIAL__#Splunk_TA_test#configs/conf-CONF_FILENAME&#39;</span>
<span class="sd">            )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ConfManager.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            realm: (optional) Realm of credential, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span> <span class="o">=</span> <span class="n">app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span> <span class="o">=</span> <span class="n">owner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="o">=</span> <span class="n">scheme</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
            <span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="n">realm</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConfFile</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get conf file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: Conf file name.</span>
<span class="sd">            refresh: (optional) Flag to refresh conf file list, default is False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Conf file object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ConfManagerException: If `conf_file` does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">refresh</span><span class="p">:</span>
            <span class="c1"># Fix bug that can&#39;t pass `-` as app name.</span>
            <span class="n">curr_app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">app</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="s2">&quot;dummy&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">curr_app</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfManagerException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Config file: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ConfFile</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">conf</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">create_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConfFile</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create conf file.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: Conf file name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Conf file object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span>

        <span class="n">conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ConfFile</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">conf</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">,</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfManager.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">realm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ConfManager.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>realm</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Realm of credential, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">realm</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ConfManager.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        realm: (optional) Realm of credential, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span> <span class="o">=</span> <span class="n">session_key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_app</span> <span class="o">=</span> <span class="n">app</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span> <span class="o">=</span> <span class="n">owner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span> <span class="o">=</span> <span class="n">scheme</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_host</span> <span class="o">=</span> <span class="n">host</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_port</span> <span class="o">=</span> <span class="n">port</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_context</span> <span class="o">=</span> <span class="n">context</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span> <span class="o">=</span> <span class="n">realm</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfManager.create_conf" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_conf</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfManager.create_conf" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create conf file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Conf file name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.conf_manager.ConfFile">ConfFile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Conf file object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">create_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConfFile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create conf file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: Conf file name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Conf file object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span>

    <span class="n">conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ConfFile</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">conf</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">,</span>
        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="conf_manager-solnlib.conf_manager.ConfManager.get_conf" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_conf</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">refresh</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.ConfManager.get_conf" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get conf file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Conf file name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>refresh</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Flag to refresh conf file list, default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.conf_manager.ConfFile">ConfFile</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Conf file object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.soln_exceptions.ConfManagerException">ConfManagerException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>conf_file</code> does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">refresh</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ConfFile</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get conf file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: Conf file name.</span>
<span class="sd">        refresh: (optional) Flag to refresh conf file list, default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Conf file object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ConfManagerException: If `conf_file` does not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">refresh</span><span class="p">:</span>
        <span class="c1"># Fix bug that can&#39;t pass `-` as app name.</span>
        <span class="n">curr_app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="s2">&quot;dummy&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">namespace</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">curr_app</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_confs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ConfManagerException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Config file: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> does not exist.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ConfFile</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">conf</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_session_key</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_owner</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scheme</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_host</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_port</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_realm</span><span class="p">,</span>
        <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="conf_manager-solnlib.conf_manager.get_log_level" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_log_level</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">conf_name</span><span class="p">,</span> <span class="n">log_stanza</span><span class="o">=</span><span class="s1">&#39;logging&#39;</span><span class="p">,</span> <span class="n">log_level_field</span><span class="o">=</span><span class="s1">&#39;loglevel&#39;</span><span class="p">,</span> <span class="n">default_log_level</span><span class="o">=</span><span class="s1">&#39;INFO&#39;</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.get_log_level" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>This function returns the log level for the addon from configuration
file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span data-autorefs-optional="logging">logging</span>.<span data-autorefs-optional-hover="logging.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logger.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Add-on name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>conf_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration file name where logging stanza is.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>log_stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logging stanza to define <code>log_level_field</code> and its value.</p>
            </div>
          </td>
          <td>
                <code>&#39;logging&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>log_level_field</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logging level field name under logging stanza.</p>
            </div>
          </td>
          <td>
                <code>&#39;loglevel&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>default_log_level</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Default log level to return in case of errors.</p>
            </div>
          </td>
          <td>
                <code>&#39;INFO&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Log level defined under <code>logging.log_level_field</code> field in <code>conf_name</code></p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>file. In case of any error, <code>default_log_level</code> will be returned.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log_level</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">get_log_level</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">logger</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;session_key&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;ADDON_NAME&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;splunk_ta_addon_settings&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_log_level</span><span class="p">(</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">conf_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">log_stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;logging&quot;</span><span class="p">,</span>
    <span class="n">log_level_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;loglevel&quot;</span><span class="p">,</span>
    <span class="n">default_log_level</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;INFO&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function returns the log level for the addon from configuration</span>
<span class="sd">    file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        logger: Logger.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app_name: Add-on name.</span>
<span class="sd">        conf_name: Configuration file name where logging stanza is.</span>
<span class="sd">        log_stanza: Logging stanza to define `log_level_field` and its value.</span>
<span class="sd">        log_level_field: Logging level field name under logging stanza.</span>
<span class="sd">        default_log_level: Default log level to return in case of errors.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Log level defined under `logging.log_level_field` field in `conf_name`</span>
<span class="sd">        file. In case of any error, `default_log_level` will be returned.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">        &gt;&gt;&gt; log_level = conf_manager.get_log_level(</span>
<span class="sd">        &gt;&gt;&gt;     logger,</span>
<span class="sd">        &gt;&gt;&gt;     &quot;session_key&quot;,</span>
<span class="sd">        &gt;&gt;&gt;     &quot;ADDON_NAME&quot;,</span>
<span class="sd">        &gt;&gt;&gt;     &quot;splunk_ta_addon_settings&quot;,</span>
<span class="sd">        &gt;&gt;&gt; )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cfm</span> <span class="o">=</span> <span class="n">ConfManager</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app_name</span><span class="p">,</span>
            <span class="n">realm</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;__REST_CREDENTIAL__#</span><span class="si">{</span><span class="n">app_name</span><span class="si">}</span><span class="s2">#configs/conf-</span><span class="si">{</span><span class="n">conf_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="n">conf_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ConfManagerException</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Failed to fetch configuration file </span><span class="si">{</span><span class="n">conf_name</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;taking </span><span class="si">{</span><span class="n">default_log_level</span><span class="si">}</span><span class="s2"> as log level.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">default_log_level</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">logging_details</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_stanza</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">logging_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_level_field</span><span class="p">,</span> <span class="n">default_log_level</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">ConfStanzaNotExistException</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;&quot;logging&quot; stanza does not exist under </span><span class="si">{</span><span class="n">conf_name</span><span class="si">}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s2">&quot;taking </span><span class="si">{</span><span class="n">default_log_level</span><span class="si">}</span><span class="s2"> as log level.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">default_log_level</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="conf_manager-solnlib.conf_manager.get_proxy_dict" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_proxy_dict</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">conf_name</span><span class="p">,</span> <span class="n">proxy_stanza</span><span class="o">=</span><span class="s1">&#39;proxy&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#conf_manager-solnlib.conf_manager.get_proxy_dict" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>This function returns the proxy settings for the addon from
configuration file.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span data-autorefs-optional="logging">logging</span>.<span data-autorefs-optional-hover="logging.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logger.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Add-on name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>conf_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Configuration file name where logging stanza is.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>proxy_stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Proxy stanza that would contain the Proxy details</p>
            </div>
          </td>
          <td>
                <code>&#39;proxy&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="str">str</span>], <span data-autorefs-optional-hover="typing.NoReturn">NoReturn</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dictionary is returned with stanza details present in the file.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional-hover="typing.Dict">Dict</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="str">str</span>], <span data-autorefs-optional-hover="typing.NoReturn">NoReturn</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The keys related to <code>eai</code> are removed before returning.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">conf_manager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proxy_details</span> <span class="o">=</span> <span class="n">conf_manager</span><span class="o">.</span><span class="n">get_proxy_dict</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">logger</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;session_key&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;ADDON_NAME&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="s2">&quot;splunk_ta_addon_settings&quot;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/conf_manager.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_proxy_dict</span><span class="p">(</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">conf_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">proxy_stanza</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;proxy&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">NoReturn</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function returns the proxy settings for the addon from</span>
<span class="sd">    configuration file.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        logger: Logger.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app_name: Add-on name.</span>
<span class="sd">        conf_name: Configuration file name where logging stanza is.</span>
<span class="sd">        proxy_stanza: Proxy stanza that would contain the Proxy details</span>
<span class="sd">    Returns:</span>
<span class="sd">        A dictionary is returned with stanza details present in the file.</span>
<span class="sd">        The keys related to `eai` are removed before returning.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib import conf_manager</span>
<span class="sd">        &gt;&gt;&gt; proxy_details = conf_manager.get_proxy_dict(</span>
<span class="sd">        &gt;&gt;&gt;     logger,</span>
<span class="sd">        &gt;&gt;&gt;     &quot;session_key&quot;,</span>
<span class="sd">        &gt;&gt;&gt;     &quot;ADDON_NAME&quot;,</span>
<span class="sd">        &gt;&gt;&gt;     &quot;splunk_ta_addon_settings&quot;,</span>
<span class="sd">        &gt;&gt;&gt; )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">proxy_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">cfm</span> <span class="o">=</span> <span class="n">ConfManager</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app_name</span><span class="p">,</span>
            <span class="n">realm</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;__REST_CREDENTIAL__#</span><span class="si">{</span><span class="n">app_name</span><span class="si">}</span><span class="s2">#configs/conf-</span><span class="si">{</span><span class="n">conf_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">cfm</span><span class="o">.</span><span class="n">get_conf</span><span class="p">(</span><span class="n">conf_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ConfManagerException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch configuration file &#39;</span><span class="si">{</span><span class="n">conf_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">proxy_dict</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">proxy_stanza</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConfStanzaNotExistException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Failed to fetch &#39;</span><span class="si">{</span><span class="n">proxy_stanza</span><span class="si">}</span><span class="s2">&#39; from the configuration file &#39;</span><span class="si">{</span><span class="n">conf_name</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># remove the other fields that are added by ConfFile class</span>
            <span class="n">proxy_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;disabled&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">proxy_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;eai:access&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">proxy_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;eai:appName&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">proxy_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;eai:userName&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;proxy_port&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_port</span><span class="p">(</span><span class="n">proxy_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;proxy_port&quot;</span><span class="p">])):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid proxy port provided.&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">InvalidPortError</span><span class="p">(</span><span class="s2">&quot;The provided port is not valid.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;proxy_host&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_hostname</span><span class="p">(</span><span class="n">proxy_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;proxy_host&quot;</span><span class="p">])):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Invalid proxy host provided.&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="n">InvalidHostnameError</span><span class="p">(</span><span class="s2">&quot;The provided hostname is not valid.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">proxy_dict</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><section class="print-page" id="file_monitor"><h1 id="file_monitor-file_monitorpy">file_monitor.py<a class="headerlink" href="#file_monitor-file_monitorpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.file_monitor"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains file monitoring class that can be used to check files
change periodically and call callback function to handle properly when
detecting files change.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="file_monitor-solnlib.file_monitor.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FileChangesChecker&#39;</span><span class="p">,</span> <span class="s1">&#39;FileMonitor&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#file_monitor-solnlib.file_monitor.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="file_monitor-solnlib.file_monitor.FileChangesChecker" class="doc doc-heading">
        <code>FileChangesChecker</code>


<a href="#file_monitor-solnlib.file_monitor.FileChangesChecker" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Files change checker.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileChangesChecker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Files change checker.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes FileChangesChecker.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: Callback function for files change.</span>
<span class="sd">            files: Files to be monitored with full path.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="n">files</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span> <span class="o">=</span> <span class="p">{</span><span class="n">file_name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getmtime for </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">, failed: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">check_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check files change.</span>

<span class="sd">        If some files are changed and callback function is not None, call</span>
<span class="sd">        callback function to handle files change.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if files changed else False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking files=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file_mtimes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span>
        <span class="n">changed_files</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">last_mtime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">file_mtimes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">current_mtime</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">current_mtime</span> <span class="o">!=</span> <span class="n">last_mtime</span><span class="p">:</span>
                    <span class="n">file_mtimes</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_mtime</span>
                    <span class="n">changed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detect </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2"> has changed&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">if</span> <span class="n">changed_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="n">changed_files</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="file_monitor-solnlib.file_monitor.FileChangesChecker.file_mtimes" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">file_mtimes</span> <span class="o">=</span> <span class="p">{</span><span class="n">file_name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">}</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#file_monitor-solnlib.file_monitor.FileChangesChecker.file_mtimes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="file_monitor-solnlib.file_monitor.FileChangesChecker.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span></code>

<a href="#file_monitor-solnlib.file_monitor.FileChangesChecker.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes FileChangesChecker.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span>[[<span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]], <span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callback function for files change.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>files</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Files to be monitored with full path.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes FileChangesChecker.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Callback function for files change.</span>
<span class="sd">        files: Files to be monitored with full path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_files</span> <span class="o">=</span> <span class="n">files</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span> <span class="o">=</span> <span class="p">{</span><span class="n">file_name</span><span class="p">:</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">file_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getmtime for </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">, failed: </span><span class="si">{</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="file_monitor-solnlib.file_monitor.FileChangesChecker.check_changes" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">check_changes</span><span class="p">()</span></code>

<a href="#file_monitor-solnlib.file_monitor.FileChangesChecker.check_changes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check files change.</p>
<p>If some files are changed and callback function is not None, call
callback function to handle files change.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if files changed else False</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check files change.</span>

<span class="sd">    If some files are changed and callback function is not None, call</span>
<span class="sd">    callback function to handle files change.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if files changed else False</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking files=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">file_mtimes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_mtimes</span>
    <span class="n">changed_files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">last_mtime</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">file_mtimes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">current_mtime</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">current_mtime</span> <span class="o">!=</span> <span class="n">last_mtime</span><span class="p">:</span>
                <span class="n">file_mtimes</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_mtime</span>
                <span class="n">changed_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Detect </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2"> has changed&quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">if</span> <span class="n">changed_files</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">(</span><span class="n">changed_files</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="file_monitor-solnlib.file_monitor.FileMonitor" class="doc doc-heading">
        <code>FileMonitor</code>


<a href="#file_monitor-solnlib.file_monitor.FileMonitor" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Files change monitor.</p>
<p>Monitor files change in a separated thread and call callback
when there is files change.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">solnlib.file_monitor</span> <span class="k">as</span> <span class="nn">fm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span> <span class="o">=</span> <span class="n">fm</span><span class="o">.</span><span class="n">FileMonitor</span><span class="p">(</span><span class="n">fm_callback</span><span class="p">,</span> <span class="n">files_list</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fm</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FileMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Files change monitor.</span>

<span class="sd">    Monitor files change in a separated thread and call callback</span>
<span class="sd">    when there is files change.</span>

<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; import solnlib.file_monitor as fm</span>
<span class="sd">      &gt;&gt;&gt; fm = fm.FileMonitor(fm_callback, files_list, 5)</span>
<span class="sd">      &gt;&gt;&gt; fm.start()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes FileMonitor.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: Callback for handling files change.</span>
<span class="sd">            files: Files to monitor.</span>
<span class="sd">            interval: Interval to check files change.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checker</span> <span class="o">=</span> <span class="n">FileChangesChecker</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_monitor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start file monitor.</span>

<span class="sd">        Start a background thread to monitor files change.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop file monitor.</span>

<span class="sd">        Stop the background thread to monitor files change.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_do_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_checker</span><span class="o">.</span><span class="n">check_changes</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="file_monitor-solnlib.file_monitor.FileMonitor.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#file_monitor-solnlib.file_monitor.FileMonitor.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes FileMonitor.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span>[[<span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]], <span data-autorefs-optional-hover="typing.Any">Any</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callback for handling files change.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>files</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Files to monitor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Interval to check files change.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">files</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes FileMonitor.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Callback for handling files change.</span>
<span class="sd">        files: Files to monitor.</span>
<span class="sd">        interval: Interval to check files change.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_checker</span> <span class="o">=</span> <span class="n">FileChangesChecker</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_monitor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">interval</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="file_monitor-solnlib.file_monitor.FileMonitor.start" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">start</span><span class="p">()</span></code>

<a href="#file_monitor-solnlib.file_monitor.FileMonitor.start" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Start file monitor.</p>
<p>Start a background thread to monitor files change.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start file monitor.</span>

<span class="sd">    Start a background thread to monitor files change.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="file_monitor-solnlib.file_monitor.FileMonitor.stop" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#file_monitor-solnlib.file_monitor.FileMonitor.stop" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Stop file monitor.</p>
<p>Stop the background thread to monitor files change.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/file_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop file monitor.</span>

<span class="sd">    Stop the background thread to monitor files change.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="hec_config"><h1 id="hec_config-hec_configpy">hec_config.py<a class="headerlink" href="#hec_config-hec_configpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.hec_config"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="hec_config-solnlib.hec_config.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HECConfig&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#hec_config-solnlib.hec_config.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="hec_config-solnlib.hec_config.HECConfig" class="doc doc-heading">
        <code>HECConfig</code>


<a href="#hec_config-solnlib.hec_config.HECConfig" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>HTTP Event Collector configuration.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/hec_config.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">HECConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;HTTP Event Collector configuration.&quot;&quot;&quot;</span>

    <span class="n">input_type</span> <span class="o">=</span> <span class="s2">&quot;http&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes HECConfig.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="s2">&quot;splunk_httpinput&quot;</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get http data input global settings.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HTTP global settings, for example:</span>

<span class="sd">                {</span>
<span class="sd">                    &#39;enableSSL&#39;: 1,</span>
<span class="sd">                    &#39;disabled&#39;: 0,</span>
<span class="sd">                    &#39;useDeploymentServer&#39;: 0,</span>
<span class="sd">                    &#39;port&#39;: 8088</span>
<span class="sd">                }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update http data input global settings.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            settings: HTTP global settings.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">settings</span><span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">create_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stanza</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create http data input.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: HTTP data input name.</span>
<span class="sd">            stanza: Data input stanza content.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Created input.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib.hec_config import HECConfig</span>
<span class="sd">           &gt;&gt;&gt; hec = HECConfig(session_key)</span>
<span class="sd">           &gt;&gt;&gt; hec.create_input(&#39;my_hec_data_input&#39;,</span>
<span class="sd">                                {&#39;index&#39;: &#39;main&#39;, &#39;sourcetype&#39;: &#39;hec&#39;})</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">,</span> <span class="o">**</span><span class="n">stanza</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">content</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stanza</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update http data input.</span>

<span class="sd">        It will create if the data input doesn&#39;t exist.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: HTTP data input name.</span>
<span class="sd">            stanza: Data input stanza.</span>

<span class="sd">        Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import HEConfig</span>
<span class="sd">           &gt;&gt;&gt; hec = HECConfig(session_key)</span>
<span class="sd">           &gt;&gt;&gt; hec.update_input(&#39;my_hec_data_input&#39;,</span>
<span class="sd">                                {&#39;index&#39;: &#39;main&#39;, &#39;sourcetype&#39;: &#39;hec2&#39;})</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_input</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">stanza</span><span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete http data input.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: HTTP data input name.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get http data input.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: HTTP event collector data input name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HTTP event collector data input config dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">content</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_do_get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">inputs</span><span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get HTTP input limits.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HTTP input limits.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span><span class="p">[</span><span class="s2">&quot;limits&quot;</span><span class="p">][</span><span class="s2">&quot;http_input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">content</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set HTTP input limits.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            limits: HTTP input limits.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span><span class="p">[</span><span class="s2">&quot;limits&quot;</span><span class="p">][</span><span class="s2">&quot;http_input&quot;</span><span class="p">]</span>
        <span class="n">res</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="hec_config-solnlib.hec_config.HECConfig.input_type" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">input_type</span> <span class="o">=</span> <span class="s1">&#39;http&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#hec_config-solnlib.hec_config.HECConfig.input_type" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes HECConfig.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes HECConfig.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="s2">&quot;splunk_httpinput&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.create_input" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_input</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.create_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create http data input.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP data input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data input stanza content.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Created input.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.hec_config</span> <span class="kn">import</span> <span class="n">HECConfig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hec</span> <span class="o">=</span> <span class="n">HECConfig</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hec</span><span class="o">.</span><span class="n">create_input</span><span class="p">(</span><span class="s1">&#39;my_hec_data_input&#39;</span><span class="p">,</span>
<span class="go">                     {&#39;index&#39;: &#39;main&#39;, &#39;sourcetype&#39;: &#39;hec&#39;})</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">create_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stanza</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create http data input.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: HTTP data input name.</span>
<span class="sd">        stanza: Data input stanza content.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Created input.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib.hec_config import HECConfig</span>
<span class="sd">       &gt;&gt;&gt; hec = HECConfig(session_key)</span>
<span class="sd">       &gt;&gt;&gt; hec.create_input(&#39;my_hec_data_input&#39;,</span>
<span class="sd">                            {&#39;index&#39;: &#39;main&#39;, &#39;sourcetype&#39;: &#39;hec&#39;})</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">,</span> <span class="o">**</span><span class="n">stanza</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">content</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.delete_input" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete_input</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.delete_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Delete http data input.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP data input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete http data input.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: HTTP data input name.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.get_input" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_input</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.get_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get http data input.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP event collector data input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP event collector data input config dict.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get http data input.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: HTTP event collector data input name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HTTP event collector data input config dict.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">res</span><span class="o">.</span><span class="n">content</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.get_limits" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_limits</span><span class="p">()</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.get_limits" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get HTTP input limits.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP input limits.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get HTTP input limits.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HTTP input limits.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span><span class="p">[</span><span class="s2">&quot;limits&quot;</span><span class="p">][</span><span class="s2">&quot;http_input&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">content</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.get_settings" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_settings</span><span class="p">()</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.get_settings" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get http data input global settings.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP global settings, for example:</p>
<p>{
    &lsquo;enableSSL&rsquo;: 1,
    &lsquo;disabled&rsquo;: 0,
    &lsquo;useDeploymentServer&rsquo;: 0,
    &lsquo;port&rsquo;: 8088
}</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get http data input global settings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HTTP global settings, for example:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;enableSSL&#39;: 1,</span>
<span class="sd">                &#39;disabled&#39;: 0,</span>
<span class="sd">                &#39;useDeploymentServer&#39;: 0,</span>
<span class="sd">                &#39;port&#39;: 8088</span>
<span class="sd">            }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)</span><span class="o">.</span><span class="n">content</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.set_limits" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">set_limits</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.set_limits" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set HTTP input limits.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>limits</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP input limits.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set HTTP input limits.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        limits: HTTP input limits.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">confs</span><span class="p">[</span><span class="s2">&quot;limits&quot;</span><span class="p">][</span><span class="s2">&quot;http_input&quot;</span><span class="p">]</span>
    <span class="n">res</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.update_input" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update_input</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.update_input" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update http data input.</p>
<p>It will create if the data input doesn&rsquo;t exist.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP data input name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Data input stanza.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">HEConfig</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hec</span> <span class="o">=</span> <span class="n">HECConfig</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hec</span><span class="o">.</span><span class="n">update_input</span><span class="p">(</span><span class="s1">&#39;my_hec_data_input&#39;</span><span class="p">,</span>
<span class="go">                     {&#39;index&#39;: &#39;main&#39;, &#39;sourcetype&#39;: &#39;hec2&#39;})</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">stanza</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update http data input.</span>

<span class="sd">    It will create if the data input doesn&#39;t exist.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: HTTP data input name.</span>
<span class="sd">        stanza: Data input stanza.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import HEConfig</span>
<span class="sd">       &gt;&gt;&gt; hec = HECConfig(session_key)</span>
<span class="sd">       &gt;&gt;&gt; hec.update_input(&#39;my_hec_data_input&#39;,</span>
<span class="sd">                            {&#39;index&#39;: &#39;main&#39;, &#39;sourcetype&#39;: &#39;hec2&#39;})</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_input</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">stanza</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="hec_config-solnlib.hec_config.HECConfig.update_settings" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span></code>

<a href="#hec_config-solnlib.hec_config.HECConfig.update_settings" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update http data input global settings.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>settings</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP global settings.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/hec_config.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update http data input global settings.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        settings: HTTP global settings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_do_get_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_type</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">settings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="log"><h1 id="log-logpy">log.py<a class="headerlink" href="#log-logpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.log"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides log functionalities.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="log-solnlib.log.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;log_enter_exit&#39;</span><span class="p">,</span> <span class="s1">&#39;LogException&#39;</span><span class="p">,</span> <span class="s1">&#39;Logs&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#log-solnlib.log.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="log-solnlib.log.log_authentication_error" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_authentication_error</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_base_error_log</span><span class="p">,</span> <span class="n">exe_label</span><span class="o">=</span><span class="s1">&#39;Authentication Error&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#log-solnlib.log.log_authentication_error" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="log-solnlib.log.log_configuration_error" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_configuration_error</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_base_error_log</span><span class="p">,</span> <span class="n">exe_label</span><span class="o">=</span><span class="s1">&#39;Configuration Error&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#log-solnlib.log.log_configuration_error" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="log-solnlib.log.log_connection_error" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_connection_error</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_base_error_log</span><span class="p">,</span> <span class="n">exe_label</span><span class="o">=</span><span class="s1">&#39;Connection Error&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#log-solnlib.log.log_connection_error" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="log-solnlib.log.log_permission_error" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_permission_error</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_base_error_log</span><span class="p">,</span> <span class="n">exe_label</span><span class="o">=</span><span class="s1">&#39;Permission Error&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#log-solnlib.log.log_permission_error" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="log-solnlib.log.log_server_error" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_server_error</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">_base_error_log</span><span class="p">,</span> <span class="n">exe_label</span><span class="o">=</span><span class="s1">&#39;Server Error&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#log-solnlib.log.log_server_error" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="log-solnlib.log.LogException" class="doc doc-heading">
        <code>LogException</code>


<a href="#log-solnlib.log.LogException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception raised by Logs class.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/log.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LogException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised by Logs class.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="log-solnlib.log.Logs" class="doc doc-heading">
        <code>Logs</code>


<a href="#log-solnlib.log.Logs" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A singleton class that manage all kinds of logger.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">log</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">log</span><span class="o">.</span><span class="n">Logs</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;/var/log/test&#39;</span><span class="p">,</span>
<span class="go">                         namespace=&#39;test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">Logs</span><span class="p">()</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="s1">&#39;mymodule&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">set_level</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;a debug log&#39;</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/log.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Logs</span><span class="p">(</span><span class="n">metaclass</span><span class="o">=</span><span class="n">Singleton</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A singleton class that manage all kinds of logger.</span>

<span class="sd">    Examples:</span>
<span class="sd">      &gt;&gt;&gt; from solnlib import log</span>
<span class="sd">      &gt;&gt;&gt; log.Logs.set_context(directory=&#39;/var/log/test&#39;,</span>
<span class="sd">                               namespace=&#39;test&#39;)</span>
<span class="sd">      &gt;&gt;&gt; logger = log.Logs().get_logger(&#39;mymodule&#39;)</span>
<span class="sd">      &gt;&gt;&gt; logger.set_level(logging.DEBUG)</span>
<span class="sd">      &gt;&gt;&gt; logger.debug(&#39;a debug log&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Normal logger settings</span>
    <span class="n">_default_directory</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_default_namespace</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_default_log_format</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> log_level=</span><span class="si">%(levelname)s</span><span class="s2"> pid=</span><span class="si">%(process)d</span><span class="s2"> tid=</span><span class="si">%(threadName)s</span><span class="s2"> &quot;</span>
        <span class="s2">&quot;file=</span><span class="si">%(filename)s</span><span class="s2">:</span><span class="si">%(funcName)s</span><span class="s2">:</span><span class="si">%(lineno)d</span><span class="s2"> | </span><span class="si">%(message)s</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">_default_log_level</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>
    <span class="n">_default_max_bytes</span> <span class="o">=</span> <span class="mi">25000000</span>
    <span class="n">_default_backup_count</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="c1"># Default root logger settings</span>
    <span class="n">_default_root_logger_log_file</span> <span class="o">=</span> <span class="s2">&quot;solnlib&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">set_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set log context.</span>

<span class="sd">        List of keyword arguments:</span>

<span class="sd">            directory: Log directory, default is splunk log root directory.</span>
<span class="sd">            namespace: Logger namespace, default is None.</span>
<span class="sd">            log_format: Log format, default is `_default_log_format`.</span>
<span class="sd">            log_level: Log level, default is logging.INFO.</span>
<span class="sd">            max_bytes: The maximum log file size before rollover, default is 25000000.</span>
<span class="sd">            backup_count: The number of log files to retain,default is 5.</span>
<span class="sd">            root_logger_log_file: Root logger log file name, default is &#39;solnlib&#39;   .</span>

<span class="sd">        Arguments:</span>
<span class="sd">            context: Keyword arguments. See list of arguments above.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;directory&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_directory</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;namespace&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_namespace</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;log_format&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_log_format</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;log_format&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;log_level&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_log_level</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;log_level&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;max_bytes&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_max_bytes</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;max_bytes&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;backup_count&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_backup_count</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;backup_count&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;root_logger_log_file&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_default_root_logger_log_file</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;root_logger_log_file&quot;</span><span class="p">]</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_reset_root_logger</span><span class="p">()</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_reset_root_logger</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
        <span class="n">log_file</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_log_file</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_default_root_logger_log_file</span><span class="p">)</span>
        <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span>
            <span class="n">log_file</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>
            <span class="n">maxBytes</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_default_max_bytes</span><span class="p">,</span>
            <span class="n">backupCount</span><span class="o">=</span><span class="bp">cls</span><span class="o">.</span><span class="n">_default_backup_count</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_default_log_format</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_default_log_level</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_log_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_default_namespace</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="n">_default_namespace</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.log&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">.log&quot;</span>

        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_default_directory</span><span class="p">:</span>
            <span class="n">directory</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_default_directory</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">directory</span> <span class="o">=</span> <span class="n">make_splunkhome_path</span><span class="p">([</span><span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="s2">&quot;splunk&quot;</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">LogException</span><span class="p">(</span>
                    <span class="s2">&quot;Log directory is empty, please set log directory &quot;</span>
                    <span class="s1">&#39;by calling Logs.set_context(directory=&quot;/var/log/...&quot;).&#39;</span>
                <span class="p">)</span>
        <span class="n">log_file</span> <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">directory</span><span class="p">,</span> <span class="n">name</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">log_file</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">get_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get logger with the name of `name`.</span>

<span class="sd">        If logger with the name of `name` exists just return else create a new</span>
<span class="sd">        logger with the name of `name`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            name: Logger name, it will be used as log file name too.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A named logger.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">log_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_log_file</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="p">[</span><span class="n">log_file</span><span class="p">]</span>

            <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
            <span class="n">handler_exists</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
                <span class="p">[</span><span class="kc">True</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">baseFilename</span> <span class="o">==</span> <span class="n">log_file</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">handler_exists</span><span class="p">:</span>
                <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span>
                    <span class="n">log_file</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>
                    <span class="n">maxBytes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_max_bytes</span><span class="p">,</span>
                    <span class="n">backupCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_backup_count</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_log_format</span><span class="p">))</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_log_level</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="p">[</span><span class="n">log_file</span><span class="p">]</span> <span class="o">=</span> <span class="n">logger</span>
            <span class="k">return</span> <span class="n">logger</span>

    <span class="k">def</span> <span class="nf">set_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set log level of logger.</span>

<span class="sd">        Set log level of all logger if `name` is None else of</span>
<span class="sd">        logger with the name of `name`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            level: Log level to set.</span>
<span class="sd">            name: The name of logger, default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">log_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_log_file</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_default_log_level</span> <span class="o">=</span> <span class="n">level</span>
                <span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="log-solnlib.log.Logs.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#log-solnlib.log.Logs.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="log-solnlib.log.Logs.get_logger" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_logger</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

<a href="#log-solnlib.log.Logs.get_logger" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get logger with the name of <code>name</code>.</p>
<p>If logger with the name of <code>name</code> exists just return else create a new
logger with the name of <code>name</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logger name, it will be used as log file name too.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="logging.handlers">logging</span>.<span data-autorefs-optional-hover="logging.handlers.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A named logger.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get logger with the name of `name`.</span>

<span class="sd">    If logger with the name of `name` exists just return else create a new</span>
<span class="sd">    logger with the name of `name`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        name: Logger name, it will be used as log file name too.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A named logger.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="n">log_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_log_file</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="p">[</span><span class="n">log_file</span><span class="p">]</span>

        <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
        <span class="n">handler_exists</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">[</span><span class="kc">True</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">logger</span><span class="o">.</span><span class="n">handlers</span> <span class="k">if</span> <span class="n">h</span><span class="o">.</span><span class="n">baseFilename</span> <span class="o">==</span> <span class="n">log_file</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">handler_exists</span><span class="p">:</span>
            <span class="n">file_handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">handlers</span><span class="o">.</span><span class="n">RotatingFileHandler</span><span class="p">(</span>
                <span class="n">log_file</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>
                <span class="n">maxBytes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_max_bytes</span><span class="p">,</span>
                <span class="n">backupCount</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_backup_count</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">file_handler</span><span class="o">.</span><span class="n">setFormatter</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">Formatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_log_format</span><span class="p">))</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">file_handler</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_log_level</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">propagate</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="p">[</span><span class="n">log_file</span><span class="p">]</span> <span class="o">=</span> <span class="n">logger</span>
        <span class="k">return</span> <span class="n">logger</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="log-solnlib.log.Logs.set_context" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">set_context</span><span class="p">(</span><span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#log-solnlib.log.Logs.set_context" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set log context.</p>

<details class="list-of-keyword-arguments" open>
  <summary>List of keyword arguments</summary>
  <p>directory: Log directory, default is splunk log root directory.
namespace: Logger namespace, default is None.
log_format: Log format, default is <code>_default_log_format</code>.
log_level: Log level, default is logging.INFO.
max_bytes: The maximum log file size before rollover, default is 25000000.
backup_count: The number of log files to retain,default is 5.
root_logger_log_file: Root logger log file name, default is &lsquo;solnlib&rsquo;   .</p>
</details>
  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments. See list of arguments above.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">set_context</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set log context.</span>

<span class="sd">    List of keyword arguments:</span>

<span class="sd">        directory: Log directory, default is splunk log root directory.</span>
<span class="sd">        namespace: Logger namespace, default is None.</span>
<span class="sd">        log_format: Log format, default is `_default_log_format`.</span>
<span class="sd">        log_level: Log level, default is logging.INFO.</span>
<span class="sd">        max_bytes: The maximum log file size before rollover, default is 25000000.</span>
<span class="sd">        backup_count: The number of log files to retain,default is 5.</span>
<span class="sd">        root_logger_log_file: Root logger log file name, default is &#39;solnlib&#39;   .</span>

<span class="sd">    Arguments:</span>
<span class="sd">        context: Keyword arguments. See list of arguments above.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;directory&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_directory</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;directory&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;namespace&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_namespace</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;log_format&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_log_format</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;log_format&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;log_level&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_log_level</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;log_level&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;max_bytes&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_max_bytes</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;max_bytes&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;backup_count&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_backup_count</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;backup_count&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="s2">&quot;root_logger_log_file&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_default_root_logger_log_file</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;root_logger_log_file&quot;</span><span class="p">]</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_reset_root_logger</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="log-solnlib.log.Logs.set_level" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">set_level</span><span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#log-solnlib.log.Logs.set_level" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set log level of logger.</p>
<p>Set log level of all logger if <code>name</code> is None else of
logger with the name of <code>name</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>level</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Log level to set.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The name of logger, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_level</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set log level of logger.</span>

<span class="sd">    Set log level of all logger if `name` is None else of</span>
<span class="sd">    logger with the name of `name`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        level: Log level to set.</span>
<span class="sd">        name: The name of logger, default is None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">log_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_log_file</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">logger</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_default_log_level</span> <span class="o">=</span> <span class="n">level</span>
            <span class="k">for</span> <span class="n">logger</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_loggers</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">level</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="log-solnlib.log.events_ingested" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">events_ingested</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">modular_input_name</span><span class="p">,</span> <span class="n">sourcetype</span><span class="p">,</span> <span class="n">n_events</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">account</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">license_usage_source</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#log-solnlib.log.events_ingested" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Specific function to log the basic information of events ingested for
the monitoring dashboard.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span data-autorefs-optional-hover="logging.handlers">logging</span>.<span data-autorefs-optional-hover="logging.handlers.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Add-on logger.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>modular_input_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Full name of the modular input. It needs to be in a format <code>&lt;input_type&gt;://&lt;input_name&gt;</code>.
In case of invalid format ValueError is raised.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>sourcetype</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Source type used to write event.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>n_events</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of ingested events.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>index</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Index used to write event.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>license_usage_source</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>source used to match data with license_usage.log.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>account</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Account used to write event. (optional)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Host used to write event. (optional)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">events_ingested</span><span class="p">(</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span>
    <span class="n">modular_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">sourcetype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">n_events</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">account</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">license_usage_source</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specific function to log the basic information of events ingested for</span>
<span class="sd">    the monitoring dashboard.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        logger: Add-on logger.</span>
<span class="sd">        modular_input_name: Full name of the modular input. It needs to be in a format `&lt;input_type&gt;://&lt;input_name&gt;`.</span>
<span class="sd">            In case of invalid format ValueError is raised.</span>
<span class="sd">        sourcetype: Source type used to write event.</span>
<span class="sd">        n_events: Number of ingested events.</span>
<span class="sd">        index: Index used to write event.</span>
<span class="sd">        license_usage_source: source used to match data with license_usage.log.</span>
<span class="sd">        account: Account used to write event. (optional)</span>
<span class="sd">        host: Host used to write event. (optional)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s2">&quot;://&quot;</span> <span class="ow">in</span> <span class="n">modular_input_name</span><span class="p">:</span>
        <span class="n">input_name</span> <span class="o">=</span> <span class="n">modular_input_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Invalid modular input name: </span><span class="si">{</span><span class="n">modular_input_name</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;It should be in format &lt;input_type&gt;://&lt;input_name&gt;&quot;</span>
        <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;events_ingested&quot;</span><span class="p">,</span>
        <span class="s2">&quot;modular_input_name&quot;</span><span class="p">:</span> <span class="n">license_usage_source</span>
        <span class="k">if</span> <span class="n">license_usage_source</span>
        <span class="k">else</span> <span class="n">modular_input_name</span><span class="p">,</span>
        <span class="s2">&quot;sourcetype_ingested&quot;</span><span class="p">:</span> <span class="n">sourcetype</span><span class="p">,</span>
        <span class="s2">&quot;n_events&quot;</span><span class="p">:</span> <span class="n">n_events</span><span class="p">,</span>
        <span class="s2">&quot;event_input&quot;</span><span class="p">:</span> <span class="n">input_name</span><span class="p">,</span>
        <span class="s2">&quot;event_index&quot;</span><span class="p">:</span> <span class="n">index</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">account</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;event_account&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">account</span>

    <span class="k">if</span> <span class="n">host</span><span class="p">:</span>
        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;event_host&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">host</span>

    <span class="n">log_event</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="log-solnlib.log.log_enter_exit" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_enter_exit</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span></code>

<a href="#log-solnlib.log.log_enter_exit" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Decorator for logger to log function enter and exit.</p>
<p>This decorator will generate a lot of debug log, please add this
only when it is required.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span data-autorefs-optional-hover="logging.handlers">logging</span>.<span data-autorefs-optional-hover="logging.handlers.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Logger to decorate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nd">@log_enter_exit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">myfunc</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">doSomething</span><span class="p">()</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_enter_exit</span><span class="p">(</span><span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator for logger to log function enter and exit.</span>

<span class="sd">    This decorator will generate a lot of debug log, please add this</span>
<span class="sd">    only when it is required.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        logger: Logger to decorate.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; @log_enter_exit</span>
<span class="sd">        &gt;&gt;&gt; def myfunc():</span>
<span class="sd">        &gt;&gt;&gt;     doSomething()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">log_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> entered&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> exited&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">return</span> <span class="n">log_decorator</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="log-solnlib.log.log_event" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_event</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">key_values</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span></code>

<a href="#log-solnlib.log.log_event" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>General function to log any event in key-value format.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_event</span><span class="p">(</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span> <span class="n">key_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;General function to log any event in key-value format.&quot;&quot;&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">key_values</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">log_level</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="log-solnlib.log.log_exception" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">log_exception</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">exc_label</span><span class="p">,</span> <span class="n">full_msg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">msg_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">msg_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log_level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span></code>

<a href="#log-solnlib.log.log_exception" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>General function to log exceptions.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>logger</code></td>
          <td>
                <code><span data-autorefs-optional-hover="logging.handlers">logging</span>.<span data-autorefs-optional-hover="logging.handlers.Logger">Logger</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Add-on logger.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>e</code></td>
          <td>
                <code><span data-autorefs-optional="Exception">Exception</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Exception to log.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>exc_label</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>label for the error to categorize it.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>full_msg</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if set to True, full traceback will be logged. Default: True</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>msg_before</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>custom message before exception traceback. Default: None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>msg_after</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>custom message after exception traceback. Default: None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>log_level</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Log level to log exception. Default: ERROR.</p>
            </div>
          </td>
          <td>
                <code>logging.ERROR</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_exception</span><span class="p">(</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span>
    <span class="n">e</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">,</span>
    <span class="n">exc_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">full_msg</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">msg_before</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">msg_after</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">log_level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;General function to log exceptions.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        logger: Add-on logger.</span>
<span class="sd">        e: Exception to log.</span>
<span class="sd">        exc_label: label for the error to categorize it.</span>
<span class="sd">        full_msg: if set to True, full traceback will be logged. Default: True</span>
<span class="sd">        msg_before: custom message before exception traceback. Default: None</span>
<span class="sd">        msg_after: custom message after exception traceback. Default: None</span>
<span class="sd">        log_level: Log level to log exception. Default: ERROR.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">msg</span> <span class="o">=</span> <span class="n">_get_exception_message</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">full_msg</span><span class="p">,</span> <span class="n">msg_before</span><span class="p">,</span> <span class="n">msg_after</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">log_level</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;exc_l=&quot;</span><span class="si">{</span><span class="n">exc_label</span><span class="si">}</span><span class="s1">&quot; </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="log-solnlib.log.modular_input_end" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">modular_input_end</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">modular_input_name</span><span class="p">)</span></code>

<a href="#log-solnlib.log.modular_input_end" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Specific function to log the end of the modular input.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">modular_input_end</span><span class="p">(</span><span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span> <span class="n">modular_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specific function to log the end of the modular input.&quot;&quot;&quot;</span>
    <span class="n">log_event</span><span class="p">(</span>
        <span class="n">logger</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;ended&quot;</span><span class="p">,</span>
            <span class="s2">&quot;modular_input_name&quot;</span><span class="p">:</span> <span class="n">modular_input_name</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="log-solnlib.log.modular_input_start" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">modular_input_start</span><span class="p">(</span><span class="n">logger</span><span class="p">,</span> <span class="n">modular_input_name</span><span class="p">)</span></code>

<a href="#log-solnlib.log.modular_input_start" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Specific function to log the start of the modular input.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/log.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">modular_input_start</span><span class="p">(</span><span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span><span class="p">,</span> <span class="n">modular_input_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specific function to log the start of the modular input.&quot;&quot;&quot;</span>
    <span class="n">log_event</span><span class="p">(</span>
        <span class="n">logger</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;started&quot;</span><span class="p">,</span>
            <span class="s2">&quot;modular_input_name&quot;</span><span class="p">:</span> <span class="n">modular_input_name</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><section class="print-page" id="net_utils"><h1 id="net_utils-net_utilspy">net_utils.py<a class="headerlink" href="#net_utils-net_utilspy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.net_utils"></a>
  <div class="doc doc-contents first">
  
      <p>Net utilities.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="net_utils-solnlib.net_utils.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;resolve_hostname&#39;</span><span class="p">,</span> <span class="s1">&#39;validate_scheme_host_port&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#net_utils-solnlib.net_utils.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h2 id="net_utils-solnlib.net_utils.is_valid_hostname" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_valid_hostname</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span></code>

<a href="#net_utils-solnlib.net_utils.is_valid_hostname" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Validate a host name.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>hostname</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>host name to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if is valid else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/net_utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_hostname</span><span class="p">(</span><span class="n">hostname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate a host name.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        hostname: host name to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if is valid else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Splunk IPv6 support.</span>
    <span class="c1"># https://docs.splunk.com/Documentation/Splunk/9.0.0/Admin/ConfigureSplunkforIPv6#Change_the_prioritization_of_IPv4_and_IPv6_communications</span>
    <span class="k">if</span> <span class="n">hostname</span> <span class="o">==</span> <span class="s2">&quot;[::1]&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">hostname</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">&quot;.&quot;</span><span class="p">:</span>
        <span class="n">hostname</span> <span class="o">=</span> <span class="n">hostname</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">allowed</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(?!-)(::)?[A-Z\d-]{1,63}(?&lt;!-)$&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">allowed</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">hostname</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="net_utils-solnlib.net_utils.is_valid_ip" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_valid_ip</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

<a href="#net_utils-solnlib.net_utils.is_valid_ip" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Validate an IPV4 address.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>addr</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>IP address to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if is valid else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/net_utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_ip</span><span class="p">(</span><span class="n">addr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate an IPV4 address.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        addr: IP address to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if is valid else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ip_rx</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ^(((</span>
<span class="sd">              [0-1]\d{2}                  # matches 000-199</span>
<span class="sd">            | 2[0-4]\d                    # matches 200-249</span>
<span class="sd">            | 25[0-5]                     # matches 250-255</span>
<span class="sd">            | \d{1,2}                     # matches 0-9, 00-99</span>
<span class="sd">        )\.){3})                          # 3 of the preceding stanzas</span>
<span class="sd">        ([0-1]\d{2}|2[0-4]\d|25[0-5]|\d{1,2})$     # final octet</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ip_rx</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">addr</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1"># Value was not a string</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="net_utils-solnlib.net_utils.is_valid_port" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_valid_port</span><span class="p">(</span><span class="n">port</span><span class="p">)</span></code>

<a href="#net_utils-solnlib.net_utils.is_valid_port" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Validate a port.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>port to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if is valid else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/net_utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_port</span><span class="p">(</span><span class="n">port</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate a port.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        port: port to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if is valid else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span> <span class="o">&lt;</span> <span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">65535</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="net_utils-solnlib.net_utils.is_valid_scheme" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_valid_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">)</span></code>

<a href="#net_utils-solnlib.net_utils.is_valid_scheme" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Validate a scheme.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>scheme to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if is valid else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/net_utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_valid_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate a scheme.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        scheme: scheme to validate.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if is valid else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">scheme</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="net_utils-solnlib.net_utils.resolve_hostname" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">resolve_hostname</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span></code>

<a href="#net_utils-solnlib.net_utils.resolve_hostname" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Try to resolve an IP to a host name and returns None on common failures.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>addr</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>IP address to resolve.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Host name if success else None.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>addr</code> is not a valid address.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/net_utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resolve_hostname</span><span class="p">(</span><span class="n">addr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Try to resolve an IP to a host name and returns None on common failures.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        addr: IP address to resolve.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Host name if success else None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `addr` is not a valid address.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_valid_ip</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyaddr</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">name</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span><span class="p">:</span>
            <span class="c1"># [Errno 8] nodename nor servname provided, or not known</span>
            <span class="k">pass</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">herror</span><span class="p">:</span>
            <span class="c1"># [Errno 1] Unknown host</span>
            <span class="k">pass</span>
        <span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">timeout</span><span class="p">:</span>
            <span class="c1"># Timeout.</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid ip address.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="net_utils-solnlib.net_utils.validate_scheme_host_port" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">validate_scheme_host_port</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span></code>

<a href="#net_utils-solnlib.net_utils.validate_scheme_host_port" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Validates scheme, host and port.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>scheme to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>hostname to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>port to validate.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if scheme, host or port are invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/net_utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validate_scheme_host_port</span><span class="p">(</span><span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">port</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates scheme, host and port.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        scheme: scheme to validate.</span>
<span class="sd">        host: hostname to validate.</span>
<span class="sd">        port: port to validate.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if scheme, host or port are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">scheme</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_valid_scheme</span><span class="p">(</span><span class="n">scheme</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid scheme&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_valid_hostname</span><span class="p">(</span><span class="n">host</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid host&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_valid_port</span><span class="p">(</span><span class="n">port</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid port&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><section class="print-page" id="orphan_process_monitor"><h1 id="orphan_process_monitor-orphan_process_monitorpy">orphan_process_monitor.py<a class="headerlink" href="#orphan_process_monitor-orphan_process_monitorpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.orphan_process_monitor"></a>
  <div class="doc doc-contents first">
  
      <p>Orphan process monitor.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="orphan_process_monitor-solnlib.orphan_process_monitor.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;OrphanProcessChecker&#39;</span><span class="p">,</span> <span class="s1">&#39;OrphanProcessMonitor&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker" class="doc doc-heading">
        <code>OrphanProcessChecker</code>


<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Orphan process checker.</p>
<p>Only work for Linux platform. On Windows platform, is_orphan is
always False and there is no need to do this monitoring on Windows.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OrphanProcessChecker</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Orphan process checker.</span>

<span class="sd">    Only work for Linux platform. On Windows platform, is_orphan is</span>
<span class="sd">    always False and there is no need to do this monitoring on Windows.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes OrphanProcessChecker.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: (optional) Callback for orphan process.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ppid</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ppid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getppid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>

    <span class="k">def</span> <span class="nf">is_orphan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check process is orphan.</span>

<span class="sd">        For windows platform just return False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True for orphan process else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ppid</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">getppid</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">check_orphan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the process becomes orphan.</span>

<span class="sd">        If the process becomes orphan then call callback function</span>
<span class="sd">        to handle properly.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True for orphan process else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_orphan</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes OrphanProcessChecker.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Callback for orphan process.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes OrphanProcessChecker.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: (optional) Callback for orphan process.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ppid</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ppid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getppid</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker.check_orphan" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">check_orphan</span><span class="p">()</span></code>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker.check_orphan" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if the process becomes orphan.</p>
<p>If the process becomes orphan then call callback function
to handle properly.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True for orphan process else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_orphan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the process becomes orphan.</span>

<span class="sd">    If the process becomes orphan then call callback function</span>
<span class="sd">    to handle properly.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True for orphan process else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_orphan</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">res</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker.is_orphan" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_orphan</span><span class="p">()</span></code>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessChecker.is_orphan" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check process is orphan.</p>
<p>For windows platform just return False.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True for orphan process else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_orphan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check process is orphan.</span>

<span class="sd">    For windows platform just return False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True for orphan process else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ppid</span> <span class="o">!=</span> <span class="n">os</span><span class="o">.</span><span class="n">getppid</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor" class="doc doc-heading">
        <code>OrphanProcessMonitor</code>


<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Orphan process monitor.</p>
<p>Check if process become orphan in background thread per interval and
call callback if process become orphan.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">OrphanProcessMonitor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Orphan process monitor.</span>

<span class="sd">    Check if process become orphan in background thread per interval and</span>
<span class="sd">    call callback if process become orphan.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes OrphanProcessMonitor.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: Callback for orphan process monitor.</span>
<span class="sd">            interval: (optional) Interval to monitor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_checker</span> <span class="o">=</span> <span class="n">OrphanProcessChecker</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_monitor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">interval</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start orphan process monitor.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop orphan process monitor.&quot;&quot;&quot;</span>

        <span class="n">joinable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">joinable</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_do_monitor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_checker</span><span class="o">.</span><span class="n">check_orphan</span><span class="p">():</span>
                <span class="k">break</span>

            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_interval</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes OrphanProcessMonitor.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callback for orphan process monitor.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Interval to monitor.</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes OrphanProcessMonitor.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Callback for orphan process monitor.</span>
<span class="sd">        interval: (optional) Interval to monitor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_checker</span> <span class="o">=</span> <span class="n">OrphanProcessChecker</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_monitor</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_interval</span> <span class="o">=</span> <span class="n">interval</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor.start" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">start</span><span class="p">()</span></code>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor.start" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Start orphan process monitor.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start orphan process monitor.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor.stop" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#orphan_process_monitor-solnlib.orphan_process_monitor.OrphanProcessMonitor.stop" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Stop orphan process monitor.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/orphan_process_monitor.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop orphan process monitor.&quot;&quot;&quot;</span>

    <span class="n">joinable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">joinable</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="pattern"><h1 id="pattern-patternpy">pattern.py<a class="headerlink" href="#pattern-patternpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.pattern"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides some common used patterns.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="pattern-solnlib.pattern.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Singleton&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pattern-solnlib.pattern.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="pattern-solnlib.pattern.Singleton" class="doc doc-heading">
        <code>Singleton</code>


<a href="#pattern-solnlib.pattern.Singleton" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="type">type</span></code></p>

  
      <p>Singleton meta class.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Test</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">Singleton</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">pass</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/pattern.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Singleton</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Singleton meta class.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; class Test(object):</span>
<span class="sd">       &gt;&gt;&gt;     __metaclass__ = Singleton</span>
<span class="sd">       &gt;&gt;&gt;</span>
<span class="sd">       &gt;&gt;&gt;     def __init__(self):</span>
<span class="sd">       &gt;&gt;&gt;         pass</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="pattern-solnlib.pattern.Singleton.__call__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pattern-solnlib.pattern.Singleton.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/pattern.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pattern-solnlib.pattern.Singleton.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span></code>

<a href="#pattern-solnlib.pattern.Singleton.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/pattern.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">bases</span><span class="p">,</span> <span class="n">attrs</span><span class="p">)</span>
    <span class="bp">cls</span><span class="o">.</span><span class="n">_instance</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="server_info"><h1 id="server_info-server_infopy">server_info.py<a class="headerlink" href="#server_info-server_infopy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.server_info"></a>
  <div class="doc doc-contents first">
  
      <p>This module contains Splunk server info related functionalities.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="server_info-solnlib.server_info.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ServerInfo&#39;</span><span class="p">,</span> <span class="s1">&#39;ServerInfoException&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#server_info-solnlib.server_info.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="server_info-solnlib.server_info.ServerInfo" class="doc doc-heading">
        <code>ServerInfo</code>


<a href="#server_info-solnlib.server_info.ServerInfo" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>This class is a wrapper of Splunk server info.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/server_info.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ServerInfo</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class is a wrapper of Splunk server info.&quot;&quot;&quot;</span>

    <span class="n">SHC_MEMBER_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/services/shcluster/member/members&quot;</span>
    <span class="n">SHC_CAPTAIN_INFO_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/services/shcluster/captain/info&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ServerInfo.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            scheme: The access scheme, default is None.</span>
<span class="sd">            host: The host name, default is None.</span>
<span class="sd">            port: The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_localhost</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">])</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">):</span>
            <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
            <span class="n">is_localhost</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;localhost&quot;</span> <span class="ow">or</span> <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;127.0.0.1&quot;</span> <span class="ow">or</span> <span class="n">host</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;::1&quot;</span><span class="p">,</span> <span class="s2">&quot;[::1]&quot;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">web_key_file</span> <span class="o">=</span> <span class="n">getWebKeyFile</span><span class="p">()</span>
        <span class="n">web_cert_file</span> <span class="o">=</span> <span class="n">getWebCertFile</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">web_cert_file</span> <span class="ow">and</span> <span class="p">(</span>
            <span class="n">web_key_file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">is_cert_or_key_encrypted</span><span class="p">(</span><span class="n">web_key_file</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;cert_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">web_cert_file</span>

            <span class="k">if</span> <span class="n">web_key_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">context</span><span class="p">[</span><span class="s2">&quot;key_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">web_key_file</span>

            <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">is_localhost</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;verify&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]):</span>
                <span class="c1"># NOTE: this is specifically for mTLS communication</span>
                <span class="c1"># ONLY if scheme, host, port aren&#39;t provided AND user hasn&#39;t provided server certificate</span>
                <span class="c1"># we set verify to off (similar to &#39;rest.simpleRequest&#39; implementation)</span>
                <span class="n">context</span><span class="p">[</span><span class="s2">&quot;verify&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_server_uri</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ServerInfo&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates ServerInfo class using server_uri and session_key.</span>

<span class="sd">        Note: splunktalib uses these parameters to create it&#39;s ServerInfo class,</span>
<span class="sd">        so this method should ease the transition from splunktalib to solnlib.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            server_uri: splunkd URI.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An instance of `ServerInfo`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: server_uri is in the wrong format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ServerInfo</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns server information in a form dictionary.</span>

<span class="sd">        Note: This method is implemented here to have compatibility with splunktalib&#39;s</span>
<span class="sd">        analogue.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Server information in a dictionary format.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">_server_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">info</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">server_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get server name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Server name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;serverName&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">guid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get guid for the server.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Server GUID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;guid&quot;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get Splunk server version.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Splunk version.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">is_captain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this server is SHC captain.</span>

<span class="sd">        Note during a rolling start of SH members, the captain may be changed</span>
<span class="sd">        from machine to machine. To avoid the race condition, client may need</span>
<span class="sd">        do necessary sleep and then poll `is_captain_ready() == True` and then</span>
<span class="sd">        check `is_captain()`. See `is_captain_ready()` for more details.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if this server is SHC captain else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;shc_captain&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;server_roles&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">is_cloud_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this server is a cloud instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if this server is a cloud instance else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;instance_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;cloud&quot;</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">is_search_head</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this server is a search head.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if this server is a search head else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">server_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;search_head&quot;</span><span class="p">,</span> <span class="s2">&quot;cluster_search_head&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">server_info</span><span class="p">[</span><span class="s2">&quot;server_roles&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">is_shc_member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if this server is a SHC member.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if this server is a SHC member else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">server_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;shc_member&quot;</span><span class="p">,</span> <span class="s2">&quot;shc_captain&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">server_info</span><span class="p">[</span><span class="s2">&quot;server_roles&quot;</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_shc_members</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get SHC members.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ServerInfoException: If this server has no SHC members.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of SHC members [(label, peer_scheme_host_port) ...].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SHC_MEMBER_ENDPOINT</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">503</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">ServerInfoException</span><span class="p">(</span>
                <span class="s2">&quot;This server is not a SHC member and has no SHC members.&quot;</span>
            <span class="p">)</span>

        <span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">]:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">member</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
            <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">content</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;peer_scheme_host_port&quot;</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">members</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">is_captain_ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if captain is ready.</span>

<span class="sd">        Client usually first polls this function until captain is ready</span>
<span class="sd">        and then call is_captain to detect current captain machine</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if captain is ready else False.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; from solnlib import server_info</span>
<span class="sd">            &gt;&gt;&gt; serverinfo = server_info.ServerInfo(session_key)</span>
<span class="sd">            &gt;&gt;&gt; while 1:</span>
<span class="sd">            &gt;&gt;&gt;    if serverinfo.is_captain_ready():</span>
<span class="sd">            &gt;&gt;&gt;        break</span>
<span class="sd">            &gt;&gt;&gt;    time.sleep(2)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # If do_stuff can only be executed in SH captain</span>
<span class="sd">            &gt;&gt;&gt; if serverinfo.is_captain():</span>
<span class="sd">            &gt;&gt;&gt;    do_stuff()</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">cap_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">captain_info</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">cap_info</span><span class="p">[</span><span class="s2">&quot;service_ready_flag&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_false</span><span class="p">(</span>
            <span class="n">cap_info</span><span class="p">[</span><span class="s2">&quot;maintenance_mode&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">captain_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get captain information.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ServerInfoException: If there is SHC is not enabled.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Captain information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">SHC_CAPTAIN_INFO_ENDPOINT</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">503</span> <span class="ow">and</span> <span class="s2">&quot;not available&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ServerInfoException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
            <span class="k">raise</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="server_info-solnlib.server_info.ServerInfo.SHC_CAPTAIN_INFO_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">SHC_CAPTAIN_INFO_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/services/shcluster/captain/info&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#server_info-solnlib.server_info.ServerInfo.SHC_CAPTAIN_INFO_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="server_info-solnlib.server_info.ServerInfo.SHC_MEMBER_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">SHC_MEMBER_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/services/shcluster/member/members&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#server_info-solnlib.server_info.ServerInfo.SHC_MEMBER_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="server_info-solnlib.server_info.ServerInfo.guid" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">guid</span><span class="p">:</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#server_info-solnlib.server_info.ServerInfo.guid" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get guid for the server.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Server GUID.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="server_info-solnlib.server_info.ServerInfo.server_name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">server_name</span><span class="p">:</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#server_info-solnlib.server_info.ServerInfo.server_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get server name.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Server name.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="server_info-solnlib.server_info.ServerInfo.version" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">version</span><span class="p">:</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#server_info-solnlib.server_info.ServerInfo.version" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get Splunk server version.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk version.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ServerInfo.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ServerInfo.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: The access scheme, default is None.</span>
<span class="sd">        host: The host name, default is None.</span>
<span class="sd">        port: The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">is_localhost</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">])</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
        <span class="n">is_localhost</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;localhost&quot;</span> <span class="ow">or</span> <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;127.0.0.1&quot;</span> <span class="ow">or</span> <span class="n">host</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;::1&quot;</span><span class="p">,</span> <span class="s2">&quot;[::1]&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="n">web_key_file</span> <span class="o">=</span> <span class="n">getWebKeyFile</span><span class="p">()</span>
    <span class="n">web_cert_file</span> <span class="o">=</span> <span class="n">getWebCertFile</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">web_cert_file</span> <span class="ow">and</span> <span class="p">(</span>
        <span class="n">web_key_file</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">is_cert_or_key_encrypted</span><span class="p">(</span><span class="n">web_key_file</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">context</span><span class="p">[</span><span class="s2">&quot;cert_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">web_cert_file</span>

        <span class="k">if</span> <span class="n">web_key_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;key_file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">web_key_file</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="n">is_localhost</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;verify&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">]):</span>
            <span class="c1"># NOTE: this is specifically for mTLS communication</span>
            <span class="c1"># ONLY if scheme, host, port aren&#39;t provided AND user hasn&#39;t provided server certificate</span>
            <span class="c1"># we set verify to off (similar to &#39;rest.simpleRequest&#39; implementation)</span>
            <span class="n">context</span><span class="p">[</span><span class="s2">&quot;verify&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.captain_info" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">captain_info</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.captain_info" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get captain information.</p>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.server_info.ServerInfoException">ServerInfoException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If there is SHC is not enabled.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Captain information.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">captain_info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get captain information.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ServerInfoException: If there is SHC is not enabled.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Captain information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SHC_CAPTAIN_INFO_ENDPOINT</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">503</span> <span class="ow">and</span> <span class="s2">&quot;not available&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ServerInfoException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">raise</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.from_server_uri" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">from_server_uri</span><span class="p">(</span><span class="n">server_uri</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#server_info-solnlib.server_info.ServerInfo.from_server_uri" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates ServerInfo class using server_uri and session_key.</p>
<p>Note: splunktalib uses these parameters to create it&rsquo;s ServerInfo class,
so this method should ease the transition from splunktalib to solnlib.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>server_uri</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>splunkd URI.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.server_info.ServerInfo">ServerInfo</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance of <code>ServerInfo</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>server_uri is in the wrong format.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_server_uri</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">server_uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ServerInfo&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates ServerInfo class using server_uri and session_key.</span>

<span class="sd">    Note: splunktalib uses these parameters to create it&#39;s ServerInfo class,</span>
<span class="sd">    so this method should ease the transition from splunktalib to solnlib.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        server_uri: splunkd URI.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An instance of `ServerInfo`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: server_uri is in the wrong format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">server_uri</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ServerInfo</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.get_shc_members" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_shc_members</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.get_shc_members" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get SHC members.</p>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.server_info.ServerInfoException">ServerInfoException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If this server has no SHC members.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="list">list</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of SHC members [(label, peer_scheme_host_port) &hellip;].</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_shc_members</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get SHC members.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ServerInfoException: If this server has no SHC members.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of SHC members [(label, peer_scheme_host_port) ...].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SHC_MEMBER_ENDPOINT</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">503</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">ServerInfoException</span><span class="p">(</span>
            <span class="s2">&quot;This server is not a SHC member and has no SHC members.&quot;</span>
        <span class="p">)</span>

    <span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">]:</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">member</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span>
        <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">content</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span> <span class="n">content</span><span class="p">[</span><span class="s2">&quot;peer_scheme_host_port&quot;</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">members</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.is_captain" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_captain</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.is_captain" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if this server is SHC captain.</p>
<p>Note during a rolling start of SH members, the captain may be changed
from machine to machine. To avoid the race condition, client may need
do necessary sleep and then poll <code>is_captain_ready() == True</code> and then
check <code>is_captain()</code>. See <code>is_captain_ready()</code> for more details.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if this server is SHC captain else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_captain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this server is SHC captain.</span>

<span class="sd">    Note during a rolling start of SH members, the captain may be changed</span>
<span class="sd">    from machine to machine. To avoid the race condition, client may need</span>
<span class="sd">    do necessary sleep and then poll `is_captain_ready() == True` and then</span>
<span class="sd">    check `is_captain()`. See `is_captain_ready()` for more details.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if this server is SHC captain else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="s2">&quot;shc_captain&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;server_roles&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.is_captain_ready" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_captain_ready</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.is_captain_ready" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if captain is ready.</p>
<p>Client usually first polls this function until captain is ready
and then call is_captain to detect current captain machine</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if captain is ready else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">server_info</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">serverinfo</span> <span class="o">=</span> <span class="n">server_info</span><span class="o">.</span><span class="n">ServerInfo</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="k">if</span> <span class="n">serverinfo</span><span class="o">.</span><span class="n">is_captain_ready</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>       <span class="k">break</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If do_stuff can only be executed in SH captain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">serverinfo</span><span class="o">.</span><span class="n">is_captain</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">do_stuff</span><span class="p">()</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">is_captain_ready</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if captain is ready.</span>

<span class="sd">    Client usually first polls this function until captain is ready</span>
<span class="sd">    and then call is_captain to detect current captain machine</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if captain is ready else False.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from solnlib import server_info</span>
<span class="sd">        &gt;&gt;&gt; serverinfo = server_info.ServerInfo(session_key)</span>
<span class="sd">        &gt;&gt;&gt; while 1:</span>
<span class="sd">        &gt;&gt;&gt;    if serverinfo.is_captain_ready():</span>
<span class="sd">        &gt;&gt;&gt;        break</span>
<span class="sd">        &gt;&gt;&gt;    time.sleep(2)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # If do_stuff can only be executed in SH captain</span>
<span class="sd">        &gt;&gt;&gt; if serverinfo.is_captain():</span>
<span class="sd">        &gt;&gt;&gt;    do_stuff()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cap_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">captain_info</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_true</span><span class="p">(</span><span class="n">cap_info</span><span class="p">[</span><span class="s2">&quot;service_ready_flag&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_false</span><span class="p">(</span>
        <span class="n">cap_info</span><span class="p">[</span><span class="s2">&quot;maintenance_mode&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.is_cloud_instance" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_cloud_instance</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.is_cloud_instance" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if this server is a cloud instance.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if this server is a cloud instance else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_cloud_instance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this server is a cloud instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if this server is a cloud instance else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()[</span><span class="s2">&quot;instance_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;cloud&quot;</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.is_search_head" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_search_head</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.is_search_head" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if this server is a search head.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if this server is a search head else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_search_head</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this server is a search head.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if this server is a search head else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">server_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;search_head&quot;</span><span class="p">,</span> <span class="s2">&quot;cluster_search_head&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">server_info</span><span class="p">[</span><span class="s2">&quot;server_roles&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.is_shc_member" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_shc_member</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.is_shc_member" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if this server is a SHC member.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if this server is a SHC member else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_shc_member</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if this server is a SHC member.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if this server is a SHC member else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">server_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;shc_member&quot;</span><span class="p">,</span> <span class="s2">&quot;shc_captain&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">server_info</span><span class="p">[</span><span class="s2">&quot;server_roles&quot;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="server_info-solnlib.server_info.ServerInfo.to_dict" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">to_dict</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.ServerInfo.to_dict" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns server information in a form dictionary.</p>
<p>Note: This method is implemented here to have compatibility with splunktalib&rsquo;s
analogue.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Dict">Dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Server information in a dictionary format.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns server information in a form dictionary.</span>

<span class="sd">    Note: This method is implemented here to have compatibility with splunktalib&#39;s</span>
<span class="sd">    analogue.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Server information in a dictionary format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_server_info</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="server_info-solnlib.server_info.ServerInfoException" class="doc doc-heading">
        <code>ServerInfoException</code>


<a href="#server_info-solnlib.server_info.ServerInfoException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception raised by ServerInfo class.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/server_info.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ServerInfoException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception raised by ServerInfo class.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="server_info-solnlib.server_info.getWebCertFile" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">getWebCertFile</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.getWebCertFile" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getWebCertFile</span><span class="p">():</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="server_info-solnlib.server_info.getWebKeyFile" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">getWebKeyFile</span><span class="p">()</span></code>

<a href="#server_info-solnlib.server_info.getWebKeyFile" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getWebKeyFile</span><span class="p">():</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="server_info-solnlib.server_info.is_cert_or_key_encrypted" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_cert_or_key_encrypted</span><span class="p">(</span><span class="n">cert_filename</span><span class="p">)</span></code>

<a href="#server_info-solnlib.server_info.is_cert_or_key_encrypted" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/server_info.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_cert_or_key_encrypted</span><span class="p">(</span><span class="n">cert_filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><section class="print-page" id="splunk_rest_client"><h1 id="splunk_rest_client-splunk_rest_clientpy">splunk_rest_client.py<a class="headerlink" href="#splunk_rest_client-splunk_rest_clientpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.splunk_rest_client"></a>
  <div class="doc doc-contents first">
  
      <p>This module proxy all REST call to splunklib SDK, it handles proxy, certs
etc in this centralized location.</p>
<p>All clients should use SplunkRestProxy to do REST call instead of
calling splunklib SDK directly in business logic code.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="splunk_rest_client-solnlib.splunk_rest_client.MAX_REQUEST_RETRIES" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">MAX_REQUEST_RETRIES</span> <span class="o">=</span> <span class="mi">5</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#splunk_rest_client-solnlib.splunk_rest_client.MAX_REQUEST_RETRIES" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="splunk_rest_client-solnlib.splunk_rest_client.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SplunkRestClient&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#splunk_rest_client-solnlib.splunk_rest_client.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="splunk_rest_client-solnlib.splunk_rest_client.SplunkRestClient" class="doc doc-heading">
        <code>SplunkRestClient</code>


<a href="#splunk_rest_client-solnlib.splunk_rest_client.SplunkRestClient" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional-hover="splunklib.client">client</span>.<span data-autorefs-optional-hover="splunklib.client.Service">Service</span></code></p>

  
      <p>Splunk REST client.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/splunk_rest_client.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SplunkRestClient</span><span class="p">(</span><span class="n">client</span><span class="o">.</span><span class="n">Service</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Splunk REST client.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes SplunkRestClient.</span>

<span class="sd">        Arguments `scheme`, `host` and `port` are optional in the Splunk</span>
<span class="sd">        environment (when environment variable SPLUNK_HOME is set). In this</span>
<span class="sd">        situation `get_splunkd_access_info` will be used to set `scheme`,</span>
<span class="sd">        `host` and `port`. In case of using `SplunkRestClient` outside of</span>
<span class="sd">        Splunk environment - `scheme`, `host` and `port` should be provided.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: The access scheme, default is None.</span>
<span class="sd">            host: The host name, default is None.</span>
<span class="sd">            port: The port number, default is None.</span>
<span class="sd">            context: Other configurations, it can contain `proxy_hostname`,</span>
<span class="sd">                `proxy_port`, `proxy_username`, `proxy_password`, then proxy will</span>
<span class="sd">                be accounted and setup, all REST APIs to splunkd will be through</span>
<span class="sd">                the proxy. If `context` contains `key_file`, `cert_file`, then</span>
<span class="sd">                certification will be accounted and setup, all REST APIs to splunkd</span>
<span class="sd">                will use certification. If `context` contains `pool_connections`,</span>
<span class="sd">                `pool_maxsize`, then HTTP connection will be pooled.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if scheme, host or port are invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Only do splunkd URI discovery in SPLUNK env (SPLUNK_HOME is set).</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">])</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">):</span>
            <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;scheme, host, port should be provided outside of Splunk environment&quot;</span>
                <span class="p">)</span>

        <span class="n">validate_scheme_host_port</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;[::1]&quot;</span><span class="p">:</span>
            <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;::1&quot;</span>

        <span class="n">handler</span> <span class="o">=</span> <span class="n">_request_handler</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">,</span>
            <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span>
            <span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span>
            <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
            <span class="n">autologin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="splunk_rest_client-solnlib.splunk_rest_client.SplunkRestClient.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#splunk_rest_client-solnlib.splunk_rest_client.SplunkRestClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes SplunkRestClient.</p>
<p>Arguments <code>scheme</code>, <code>host</code> and <code>port</code> are optional in the Splunk
environment (when environment variable SPLUNK_HOME is set). In this
situation <code>get_splunkd_access_info</code> will be used to set <code>scheme</code>,
<code>host</code> and <code>port</code>. In case of using <code>SplunkRestClient</code> outside of
Splunk environment - <code>scheme</code>, <code>host</code> and <code>port</code> should be provided.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations, it can contain <code>proxy_hostname</code>,
<code>proxy_port</code>, <code>proxy_username</code>, <code>proxy_password</code>, then proxy will
be accounted and setup, all REST APIs to splunkd will be through
the proxy. If <code>context</code> contains <code>key_file</code>, <code>cert_file</code>, then
certification will be accounted and setup, all REST APIs to splunkd
will use certification. If <code>context</code> contains <code>pool_connections</code>,
<code>pool_maxsize</code>, then HTTP connection will be pooled.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if scheme, host or port are invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunk_rest_client.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes SplunkRestClient.</span>

<span class="sd">    Arguments `scheme`, `host` and `port` are optional in the Splunk</span>
<span class="sd">    environment (when environment variable SPLUNK_HOME is set). In this</span>
<span class="sd">    situation `get_splunkd_access_info` will be used to set `scheme`,</span>
<span class="sd">    `host` and `port`. In case of using `SplunkRestClient` outside of</span>
<span class="sd">    Splunk environment - `scheme`, `host` and `port` should be provided.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: The access scheme, default is None.</span>
<span class="sd">        host: The host name, default is None.</span>
<span class="sd">        port: The port number, default is None.</span>
<span class="sd">        context: Other configurations, it can contain `proxy_hostname`,</span>
<span class="sd">            `proxy_port`, `proxy_username`, `proxy_password`, then proxy will</span>
<span class="sd">            be accounted and setup, all REST APIs to splunkd will be through</span>
<span class="sd">            the proxy. If `context` contains `key_file`, `cert_file`, then</span>
<span class="sd">            certification will be accounted and setup, all REST APIs to splunkd</span>
<span class="sd">            will use certification. If `context` contains `pool_connections`,</span>
<span class="sd">            `pool_maxsize`, then HTTP connection will be pooled.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if scheme, host or port are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Only do splunkd URI discovery in SPLUNK env (SPLUNK_HOME is set).</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">])</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">):</span>
        <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;scheme, host, port should be provided outside of Splunk environment&quot;</span>
            <span class="p">)</span>

    <span class="n">validate_scheme_host_port</span><span class="p">(</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">host</span> <span class="o">==</span> <span class="s2">&quot;[::1]&quot;</span><span class="p">:</span>
        <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;::1&quot;</span>

    <span class="n">handler</span> <span class="o">=</span> <span class="n">_request_handler</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="n">token</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span>
        <span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span>
        <span class="n">owner</span><span class="o">=</span><span class="n">owner</span><span class="p">,</span>
        <span class="n">autologin</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="bulletin_rest_client"><h1 id="bulletin_rest_client-bulletin_rest_clientpy">bulletin_rest_client.py<a class="headerlink" href="#bulletin_rest_client-bulletin_rest_clientpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.bulletin_rest_client"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="bulletin_rest_client-solnlib.bulletin_rest_client.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BulletinRestClient&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient" class="doc doc-heading">
        <code>BulletinRestClient</code>


<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>REST client for handling Bulletin messages.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BulletinRestClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;REST client for handling Bulletin messages.&quot;&quot;&quot;</span>

    <span class="n">MESSAGES_ENDPOINT</span> <span class="o">=</span> <span class="s2">&quot;/services/messages&quot;</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">,</span> <span class="s2">&quot;application/json&quot;</span><span class="p">)]</span>

    <span class="k">class</span> <span class="nc">Severity</span><span class="p">:</span>
        <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;info&quot;</span>
        <span class="n">WARNING</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span>
        <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">message_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes BulletinRestClient.</span>
<span class="sd">            When creating a new bulletin message, you must provide a name, which is a kind of ID.</span>
<span class="sd">            If you try to create another message with the same name (ID), the API will not add another message</span>
<span class="sd">            to the bulletin, but it will overwrite the existing one. Similar behaviour applies to deletion.</span>
<span class="sd">            To delete a message, you must indicate the name (ID) of the message.</span>
<span class="sd">            To provide better and easier control over bulletin messages, this client works in such a way</span>
<span class="sd">            that there is one instance responsible for handling one specific message.</span>
<span class="sd">            If you need to add another message to bulletin create another instance</span>
<span class="sd">            with a different &#39;message_name&#39;</span>
<span class="sd">            e.g.</span>
<span class="sd">            msg_1 = BulletinRestClient(&quot;message_1&quot;, &quot;&lt;some session key&gt;&quot;)</span>
<span class="sd">            msg_2 = BulletinRestClient(&quot;message_2&quot;, &quot;&lt;some session key&gt;&quot;)</span>

<span class="sd">        Arguments:</span>
<span class="sd">            message_name: Name of the message in the Splunk&#39;s bulletin.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">message_name</span> <span class="o">=</span> <span class="n">message_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span> <span class="o">=</span> <span class="n">session_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">app</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">severity</span><span class="p">:</span> <span class="n">Severity</span> <span class="o">=</span> <span class="n">Severity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
        <span class="n">capabilities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">roles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a message in the Splunk&#39;s bulletin. Calling this method</span>
<span class="sd">        multiple times for the same instance will overwrite existing message.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            msg: The message which will be displayed in the Splunk&#39;s bulletin</span>
<span class="sd">            severity: Severity level of the message. It has to be one of: &#39;info&#39;, &#39;warn&#39;, &#39;error&#39;.</span>
<span class="sd">                If wrong severity is given, ValueError will be raised.</span>
<span class="sd">            capabilities: One or more capabilities that users must have to view the message.</span>
<span class="sd">                Capability names are validated.</span>
<span class="sd">                This argument should be provided as a list of string/s e.g. capabilities=[&#39;one&#39;, &#39;two&#39;].</span>
<span class="sd">                If a non-existent capability is used, HTTP 400 BAD REQUEST exception will be raised.</span>
<span class="sd">                If argument is not a List[str] ValueError will be raised.</span>
<span class="sd">            roles: One or more roles that users must have to view the message. Role names are validated.</span>
<span class="sd">                This argument should be provided as a list of string/s e.g. roles=[&#39;user&#39;, &#39;admin&#39;].</span>
<span class="sd">                If a non-existent role is used, HTTP 400 BAD REQUEST exception will be raised.</span>
<span class="sd">                If argument is not a List[str] ValueError will be raised.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_name</span><span class="p">,</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">msg</span><span class="p">,</span>
            <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">,</span>
            <span class="s2">&quot;capability&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">severity</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Severity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Severity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Severity must be one of (&quot;</span>
                <span class="s2">&quot;&#39;BulletinRestClient.Severity.INFO&#39;, &quot;</span>
                <span class="s2">&quot;&#39;BulletinRestClient.Severity.WARNING&#39;, &quot;</span>
                <span class="s2">&quot;&#39;BulletinRestClient.Severity.ERROR&#39;&quot;</span>
                <span class="s2">&quot;).&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">capabilities</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s2">&quot;capability&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_get_body_value</span><span class="p">(</span>
                <span class="n">capabilities</span><span class="p">,</span> <span class="s2">&quot;Capabilities must be a list of strings.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">roles</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_get_body_value</span><span class="p">(</span>
                <span class="n">roles</span><span class="p">,</span> <span class="s2">&quot;Roles must be a list of strings.&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get specific message created by this instance.&quot;&quot;&quot;</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_all_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all messages in the bulletin.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete specific message created by this instance.&quot;&quot;&quot;</span>
        <span class="n">endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">endpoint</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_validate_and_get_body_value</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">all</span><span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">)):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">el</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">arg</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.MESSAGES_ENDPOINT" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">MESSAGES_ENDPOINT</span> <span class="o">=</span> <span class="s1">&#39;/services/messages&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.MESSAGES_ENDPOINT" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.app" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">app</span> <span class="o">=</span> <span class="n">app</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.app" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.headers" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">headers</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;application/json&#39;</span><span class="p">)]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.headers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.message_name" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">message_name</span> <span class="o">=</span> <span class="n">message_name</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.message_name" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.session_key" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">session_key</span> <span class="o">=</span> <span class="n">session_key</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.session_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity" class="doc doc-heading">
        <code>Severity</code>


<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">



        <details class="quote">
          <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Severity</span><span class="p">:</span>
    <span class="n">INFO</span> <span class="o">=</span> <span class="s2">&quot;info&quot;</span>
    <span class="n">WARNING</span> <span class="o">=</span> <span class="s2">&quot;warn&quot;</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity.ERROR" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">ERROR</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity.ERROR" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity.INFO" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">INFO</span> <span class="o">=</span> <span class="s1">&#39;info&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity.INFO" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity.WARNING" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">WARNING</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.Severity.WARNING" class="headerlink" title="Permanent link">&para;</a></h4>


  <div class="doc doc-contents ">
  </div>

</div>





  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">message_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes BulletinRestClient.
    When creating a new bulletin message, you must provide a name, which is a kind of ID.
    If you try to create another message with the same name (ID), the API will not add another message
    to the bulletin, but it will overwrite the existing one. Similar behaviour applies to deletion.
    To delete a message, you must indicate the name (ID) of the message.
    To provide better and easier control over bulletin messages, this client works in such a way
    that there is one instance responsible for handling one specific message.
    If you need to add another message to bulletin create another instance
    with a different &lsquo;message_name&rsquo;
    e.g.
    msg_1 = BulletinRestClient(&ldquo;message_1&rdquo;, &ldquo;<some session key>&ldquo;)
    msg_2 = BulletinRestClient(&ldquo;message_2&rdquo;, &ldquo;<some session key>&ldquo;)</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>message_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of the message in the Splunk&rsquo;s bulletin.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">message_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes BulletinRestClient.</span>
<span class="sd">        When creating a new bulletin message, you must provide a name, which is a kind of ID.</span>
<span class="sd">        If you try to create another message with the same name (ID), the API will not add another message</span>
<span class="sd">        to the bulletin, but it will overwrite the existing one. Similar behaviour applies to deletion.</span>
<span class="sd">        To delete a message, you must indicate the name (ID) of the message.</span>
<span class="sd">        To provide better and easier control over bulletin messages, this client works in such a way</span>
<span class="sd">        that there is one instance responsible for handling one specific message.</span>
<span class="sd">        If you need to add another message to bulletin create another instance</span>
<span class="sd">        with a different &#39;message_name&#39;</span>
<span class="sd">        e.g.</span>
<span class="sd">        msg_1 = BulletinRestClient(&quot;message_1&quot;, &quot;&lt;some session key&gt;&quot;)</span>
<span class="sd">        msg_2 = BulletinRestClient(&quot;message_2&quot;, &quot;&lt;some session key&gt;&quot;)</span>

<span class="sd">    Arguments:</span>
<span class="sd">        message_name: Name of the message in the Splunk&#39;s bulletin.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">message_name</span> <span class="o">=</span> <span class="n">message_name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span> <span class="o">=</span> <span class="n">session_key</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">app</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.create_message" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">create_message</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="n">Severity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span> <span class="n">capabilities</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">roles</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.create_message" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Creates a message in the Splunk&rsquo;s bulletin. Calling this method
multiple times for the same instance will overwrite existing message.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>msg</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The message which will be displayed in the Splunk&rsquo;s bulletin</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>severity</code></td>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.bulletin_rest_client.BulletinRestClient.Severity">Severity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Severity level of the message. It has to be one of: &lsquo;info&rsquo;, &lsquo;warn&rsquo;, &lsquo;error&rsquo;.
If wrong severity is given, ValueError will be raised.</p>
            </div>
          </td>
          <td>
                <code>Severity.WARNING</code>
          </td>
        </tr>
        <tr>
          <td><code>capabilities</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>One or more capabilities that users must have to view the message.
Capability names are validated.
This argument should be provided as a list of string/s e.g. capabilities=[&lsquo;one&rsquo;, &lsquo;two&rsquo;].
If a non-existent capability is used, HTTP 400 BAD REQUEST exception will be raised.
If argument is not a List[str] ValueError will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>roles</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional-hover="typing.List">List</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>One or more roles that users must have to view the message. Role names are validated.
This argument should be provided as a list of string/s e.g. roles=[&lsquo;user&rsquo;, &lsquo;admin&rsquo;].
If a non-existent role is used, HTTP 400 BAD REQUEST exception will be raised.
If argument is not a List[str] ValueError will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_message</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">severity</span><span class="p">:</span> <span class="n">Severity</span> <span class="o">=</span> <span class="n">Severity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
    <span class="n">capabilities</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">roles</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a message in the Splunk&#39;s bulletin. Calling this method</span>
<span class="sd">    multiple times for the same instance will overwrite existing message.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        msg: The message which will be displayed in the Splunk&#39;s bulletin</span>
<span class="sd">        severity: Severity level of the message. It has to be one of: &#39;info&#39;, &#39;warn&#39;, &#39;error&#39;.</span>
<span class="sd">            If wrong severity is given, ValueError will be raised.</span>
<span class="sd">        capabilities: One or more capabilities that users must have to view the message.</span>
<span class="sd">            Capability names are validated.</span>
<span class="sd">            This argument should be provided as a list of string/s e.g. capabilities=[&#39;one&#39;, &#39;two&#39;].</span>
<span class="sd">            If a non-existent capability is used, HTTP 400 BAD REQUEST exception will be raised.</span>
<span class="sd">            If argument is not a List[str] ValueError will be raised.</span>
<span class="sd">        roles: One or more roles that users must have to view the message. Role names are validated.</span>
<span class="sd">            This argument should be provided as a list of string/s e.g. roles=[&#39;user&#39;, &#39;admin&#39;].</span>
<span class="sd">            If a non-existent role is used, HTTP 400 BAD REQUEST exception will be raised.</span>
<span class="sd">            If argument is not a List[str] ValueError will be raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">message_name</span><span class="p">,</span>
        <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">msg</span><span class="p">,</span>
        <span class="s2">&quot;severity&quot;</span><span class="p">:</span> <span class="n">severity</span><span class="p">,</span>
        <span class="s2">&quot;capability&quot;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s2">&quot;role&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="n">severity</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Severity</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Severity</span><span class="o">.</span><span class="n">WARNING</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Severity</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Severity must be one of (&quot;</span>
            <span class="s2">&quot;&#39;BulletinRestClient.Severity.INFO&#39;, &quot;</span>
            <span class="s2">&quot;&#39;BulletinRestClient.Severity.WARNING&#39;, &quot;</span>
            <span class="s2">&quot;&#39;BulletinRestClient.Severity.ERROR&#39;&quot;</span>
            <span class="s2">&quot;).&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">capabilities</span><span class="p">:</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;capability&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_get_body_value</span><span class="p">(</span>
            <span class="n">capabilities</span><span class="p">,</span> <span class="s2">&quot;Capabilities must be a list of strings.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">roles</span><span class="p">:</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_and_get_body_value</span><span class="p">(</span>
            <span class="n">roles</span><span class="p">,</span> <span class="s2">&quot;Roles must be a list of strings.&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.delete_message" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete_message</span><span class="p">()</span></code>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.delete_message" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Delete specific message created by this instance.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete specific message created by this instance.&quot;&quot;&quot;</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">endpoint</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.get_all_messages" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_all_messages</span><span class="p">()</span></code>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.get_all_messages" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get all messages in the bulletin.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_all_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all messages in the bulletin.&quot;&quot;&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.get_message" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_message</span><span class="p">()</span></code>

<a href="#bulletin_rest_client-solnlib.bulletin_rest_client.BulletinRestClient.get_message" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get specific message created by this instance.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/bulletin_rest_client.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get specific message created by this instance.&quot;&quot;&quot;</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MESSAGES_ENDPOINT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">message_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="splunkenv"><h1 id="splunkenv-splunkenvpy">splunkenv.py<a class="headerlink" href="#splunkenv-splunkenvpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.splunkenv"></a>
  <div class="doc doc-contents first">
  
      <p>Splunk platform related utilities.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="splunkenv-solnlib.splunkenv.APP_HEC" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">APP_HEC</span> <span class="o">=</span> <span class="s1">&#39;splunk_httpinput&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#splunkenv-solnlib.splunkenv.APP_HEC" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="splunkenv-solnlib.splunkenv.APP_SYSTEM" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">APP_SYSTEM</span> <span class="o">=</span> <span class="s1">&#39;system&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#splunkenv-solnlib.splunkenv.APP_SYSTEM" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="splunkenv-solnlib.splunkenv.ETC_LEAF" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">ETC_LEAF</span> <span class="o">=</span> <span class="s1">&#39;etc&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#splunkenv-solnlib.splunkenv.ETC_LEAF" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="splunkenv-solnlib.splunkenv.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;make_splunkhome_path&#39;</span><span class="p">,</span> <span class="s1">&#39;get_splunk_host_info&#39;</span><span class="p">,</span> <span class="s1">&#39;get_splunk_bin&#39;</span><span class="p">,</span> <span class="s1">&#39;get_splunkd_access_info&#39;</span><span class="p">,</span> <span class="s1">&#39;get_scheme_from_hec_settings&#39;</span><span class="p">,</span> <span class="s1">&#39;get_splunkd_uri&#39;</span><span class="p">,</span> <span class="s1">&#39;get_conf_key_value&#39;</span><span class="p">,</span> <span class="s1">&#39;get_conf_stanza&#39;</span><span class="p">,</span> <span class="s1">&#39;get_conf_stanzas&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#splunkenv-solnlib.splunkenv.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="splunkenv-solnlib.splunkenv.SessionKeyNotFound" class="doc doc-heading">
        <code>SessionKeyNotFound</code>


<a href="#splunkenv-solnlib.splunkenv.SessionKeyNotFound" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>



        <details class="quote">
          <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SessionKeyNotFound</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.getSessionKey" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">getSessionKey</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.getSessionKey" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">getSessionKey</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;This module requires Splunk to be installed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_conf_key_value" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_conf_key_value</span><span class="p">(</span><span class="n">conf_name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">session_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">raw_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_conf_key_value" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get value of <code>key</code> of <code>stanza</code> in <code>conf_name</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>conf_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Config file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Key name in the stanza.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Application name. To make a call to global context use &lsquo;-&rsquo; as app_name and set raw_output=True.
In that case manual parsing is needed as response may be the list with multiple entries.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Needed to make a call to config endpoint. If &lsquo;None&rsquo;, solnlib will try to get it from
splunk.getSessionKey() and/or <strong>main</strong> module and if it won&rsquo;t get it, SessionKeyNotFound will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>used for set user context in API call. Optional.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>raw_output</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="bool">bool</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if &lsquo;true&rsquo; full, decoded response in json format will be returned. It should be set to True when
app_name is a global context &lsquo;/-/&rsquo;. In that case splunk API may return multiple entries.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional-hover="typing.List">List</span>, <span data-autorefs-optional="dict">dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Config value.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="KeyError">KeyError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>stanza</code> or <code>key</code> doesn&rsquo;t exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_conf_key_value</span><span class="p">(</span>
    <span class="n">conf_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">raw_output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get value of `key` of `stanza` in `conf_name`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        conf_name: Config file.</span>
<span class="sd">        stanza: Stanza name.</span>
<span class="sd">        key: Key name in the stanza.</span>
<span class="sd">        app_name: Application name. To make a call to global context use &#39;-&#39; as app_name and set raw_output=True.</span>
<span class="sd">            In that case manual parsing is needed as response may be the list with multiple entries.</span>
<span class="sd">        session_key: Needed to make a call to config endpoint. If &#39;None&#39;, solnlib will try to get it from</span>
<span class="sd">            splunk.getSessionKey() and/or __main__ module and if it won&#39;t get it, SessionKeyNotFound will be raised.</span>
<span class="sd">        user: used for set user context in API call. Optional.</span>
<span class="sd">        raw_output: if &#39;true&#39; full, decoded response in json format will be returned. It should be set to True when</span>
<span class="sd">            app_name is a global context &#39;/-/&#39;. In that case splunk API may return multiple entries.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Config value.</span>

<span class="sd">    Raises:</span>
<span class="sd">        KeyError: If `stanza` or `key` doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_btool</span><span class="p">:</span>
        <span class="n">app</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">app_name</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="k">else</span> <span class="n">app_name</span>
        <span class="n">stanzas</span> <span class="o">=</span> <span class="n">get_conf_stanzas</span><span class="p">(</span><span class="n">conf_name</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stanzas</span><span class="p">[</span><span class="n">stanza</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>

    <span class="n">stanzas</span> <span class="o">=</span> <span class="n">_get_conf_stanzas_from_splunk_api</span><span class="p">(</span>
        <span class="n">conf_name</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">session_key</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="n">stanza</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">raw_output</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">stanzas</span>

    <span class="n">stanza</span> <span class="o">=</span> <span class="n">stanzas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="n">requested_key</span> <span class="o">=</span> <span class="n">stanza</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">requested_key</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_conf_stanza" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_conf_stanza</span><span class="p">(</span><span class="n">conf_name</span><span class="p">,</span> <span class="n">stanza</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">session_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">raw_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_conf_stanza" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get <code>stanza</code> in <code>conf_name</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>conf_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Config file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>stanza</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Stanza name.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Application name. To make a call to global context use &lsquo;-&rsquo; as app_name and set raw_output=True.
In that case manual parsing is needed as response may be the list with multiple entries.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Needed to make a call to config endpoint. If &lsquo;None&rsquo;, solnlib will try to get it from
splunk.getSessionKey() and/or <strong>main</strong> module and if it won&rsquo;t get it, SessionKeyNotFound will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>used for set user context in API call. Optional.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>raw_output</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="bool">bool</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if &lsquo;true&rsquo; full, decoded response in json format will be returned. It should be set to True when
app_name is a global context &lsquo;/-/&rsquo;. In that case splunk API may return multiple entries.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Config stanza.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="KeyError">KeyError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If stanza doesn&rsquo;t exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_conf_stanza</span><span class="p">(</span>
    <span class="n">conf_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">stanza</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">raw_output</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get `stanza` in `conf_name`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        conf_name: Config file.</span>
<span class="sd">        stanza: Stanza name.</span>
<span class="sd">        app_name: Application name. To make a call to global context use &#39;-&#39; as app_name and set raw_output=True.</span>
<span class="sd">            In that case manual parsing is needed as response may be the list with multiple entries.</span>
<span class="sd">        session_key: Needed to make a call to config endpoint. If &#39;None&#39;, solnlib will try to get it from</span>
<span class="sd">            splunk.getSessionKey() and/or __main__ module and if it won&#39;t get it, SessionKeyNotFound will be raised.</span>
<span class="sd">        user: used for set user context in API call. Optional.</span>
<span class="sd">        raw_output: if &#39;true&#39; full, decoded response in json format will be returned. It should be set to True when</span>
<span class="sd">            app_name is a global context &#39;/-/&#39;. In that case splunk API may return multiple entries.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Config stanza.</span>

<span class="sd">    Raises:</span>
<span class="sd">         KeyError: If stanza doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">use_btool</span><span class="p">:</span>
        <span class="n">app</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">app_name</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span> <span class="k">else</span> <span class="n">app_name</span>
        <span class="n">stanzas</span> <span class="o">=</span> <span class="n">get_conf_stanzas</span><span class="p">(</span><span class="n">conf_name</span><span class="p">,</span> <span class="n">app</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">stanzas</span><span class="p">[</span><span class="n">stanza</span><span class="p">]</span>

    <span class="n">stanzas</span> <span class="o">=</span> <span class="n">_get_conf_stanzas_from_splunk_api</span><span class="p">(</span>
        <span class="n">conf_name</span><span class="p">,</span> <span class="n">app_name</span><span class="p">,</span> <span class="n">session_key</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">stanza</span><span class="o">=</span><span class="n">stanza</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">raw_output</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">stanzas</span>

    <span class="n">stanza</span> <span class="o">=</span> <span class="n">stanzas</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entry&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stanza</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_conf_stanzas" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_conf_stanzas</span><span class="p">(</span><span class="n">conf_name</span><span class="p">,</span> <span class="n">app_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_conf_stanzas" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get stanzas of <code>conf_name</code></p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>conf_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Config file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app_name</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Application name. Optional.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Config stanzas.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">stanzas</span> <span class="o">=</span> <span class="n">get_conf_stanzas</span><span class="p">(</span><span class="s1">&#39;server&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">return</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;serverName&#39;</span><span class="p">:</span> <span class="s1">&#39;testServer&#39;</span><span class="p">,</span> <span class="s1">&#39;sessionTimeout&#39;</span><span class="p">:</span> <span class="s1">&#39;1h&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">}</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_conf_stanzas</span><span class="p">(</span><span class="n">conf_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get stanzas of `conf_name`</span>

<span class="sd">    Arguments:</span>
<span class="sd">        conf_name: Config file.</span>
<span class="sd">        app_name: Application name. Optional.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Config stanzas.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; stanzas = get_conf_stanzas(&#39;server&#39;)</span>
<span class="sd">       &gt;&gt;&gt; return: {&#39;serverName&#39;: &#39;testServer&#39;, &#39;sessionTimeout&#39;: &#39;1h&#39;, ...}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">conf_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.conf&quot;</span><span class="p">):</span>
        <span class="n">conf_name</span> <span class="o">=</span> <span class="n">conf_name</span><span class="p">[:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span>

    <span class="c1"># TODO: dynamically calculate SPLUNK_HOME</span>
    <span class="n">btool_cli</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">op</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SPLUNK_HOME&quot;</span><span class="p">],</span> <span class="s2">&quot;bin&quot;</span><span class="p">,</span> <span class="s2">&quot;splunk&quot;</span><span class="p">),</span>
        <span class="s2">&quot;cmd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;btool&quot;</span><span class="p">,</span>
        <span class="n">conf_name</span><span class="p">,</span>
        <span class="s2">&quot;list&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">if</span> <span class="n">app_name</span><span class="p">:</span>
        <span class="n">btool_cli</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--app=</span><span class="si">{</span><span class="n">app_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>  <span class="c1"># nosemgrep: python.lang.security.audit.dangerous-subprocess-use.dangerous-subprocess-use</span>
        <span class="n">btool_cli</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span>
    <span class="p">)</span>
    <span class="n">out</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s2">&quot;strict&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
        <span class="n">out</span><span class="p">[</span><span class="n">section</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">parser</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)}</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_scheme_from_hec_settings" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_scheme_from_hec_settings</span><span class="p">(</span><span class="n">session_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_scheme_from_hec_settings" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get scheme from HEC global settings.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Needed to make a call to config endpoint. If &lsquo;None&rsquo;, solnlib will try to get it from
splunk.getSessionKey() and/or <strong>main</strong> module and if it won&rsquo;t get it, SessionKeyNotFound will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>scheme (str)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_scheme_from_hec_settings</span><span class="p">(</span><span class="n">session_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get scheme from HEC global settings.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Needed to make a call to config endpoint. If &#39;None&#39;, solnlib will try to get it from</span>
<span class="sd">            splunk.getSessionKey() and/or __main__ module and if it won&#39;t get it, SessionKeyNotFound will be raised.</span>
<span class="sd">    Returns:</span>
<span class="sd">        scheme (str)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ssl_enabled</span> <span class="o">=</span> <span class="n">get_conf_key_value</span><span class="p">(</span>
            <span class="s2">&quot;inputs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;http&quot;</span><span class="p">,</span>
            <span class="s2">&quot;enableSSL&quot;</span><span class="p">,</span>
            <span class="n">APP_HEC</span><span class="p">,</span>
            <span class="n">session_key</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="s2">&quot;Cannot get enableSSL setting form conf: &#39;inputs&#39; and stanza: &#39;[http]&#39;. &quot;</span>
            <span class="s2">&quot;Verify that your Splunk instance has the inputs.conf file with the correct [http] stanza. &quot;</span>
            <span class="s2">&quot;For more information see: &quot;</span>
            <span class="s2">&quot;https://docs.splunk.com/Documentation/Splunk/9.2.0/Data/UseHECusingconffiles&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">is_true</span><span class="p">(</span><span class="n">ssl_enabled</span><span class="p">):</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;https&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;http&quot;</span>

    <span class="k">return</span> <span class="n">scheme</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_splunk_bin" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_splunk_bin</span><span class="p">()</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_splunk_bin" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get absolute path of splunk CLI.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Absolute path of splunk CLI.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_splunk_bin</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get absolute path of splunk CLI.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Absolute path of splunk CLI.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
        <span class="n">splunk_bin</span> <span class="o">=</span> <span class="s2">&quot;splunk.exe&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">splunk_bin</span> <span class="o">=</span> <span class="s2">&quot;splunk&quot;</span>
    <span class="k">return</span> <span class="n">make_splunkhome_path</span><span class="p">((</span><span class="s2">&quot;bin&quot;</span><span class="p">,</span> <span class="n">splunk_bin</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_splunk_host_info" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_splunk_host_info</span><span class="p">(</span><span class="n">session_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_splunk_host_info" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get splunk host info.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Needed to make a call to config endpoint. If &lsquo;None&rsquo;, solnlib will try to get it from
splunk.getSessionKey() and/or <strong>main</strong> module and if it won&rsquo;t get it, SessionKeyNotFound will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Tuple">Tuple</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple of (server_name, host_name).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_splunk_host_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get splunk host info.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Needed to make a call to config endpoint. If &#39;None&#39;, solnlib will try to get it from</span>
<span class="sd">            splunk.getSessionKey() and/or __main__ module and if it won&#39;t get it, SessionKeyNotFound will be raised.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (server_name, host_name).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">server_name</span> <span class="o">=</span> <span class="n">get_conf_key_value</span><span class="p">(</span>
        <span class="s2">&quot;server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;general&quot;</span><span class="p">,</span>
        <span class="s2">&quot;serverName&quot;</span><span class="p">,</span>
        <span class="n">APP_SYSTEM</span><span class="p">,</span>
        <span class="n">session_key</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">host_name</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">server_name</span><span class="p">,</span> <span class="n">host_name</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_splunkd_access_info" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_splunkd_access_info" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get splunkd server access info.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Needed to make a call to config endpoint. If &lsquo;None&rsquo;, solnlib will try to get it from
splunk.getSessionKey() and/or <strong>main</strong> module and if it won&rsquo;t get it, SessionKeyNotFound will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Tuple">Tuple</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple of (scheme, host, port).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get splunkd server access info.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Needed to make a call to config endpoint. If &#39;None&#39;, solnlib will try to get it from</span>
<span class="sd">            splunk.getSessionKey() and/or __main__ module and if it won&#39;t get it, SessionKeyNotFound will be raised.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (scheme, host, port).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">enable_splunkd_ssl</span> <span class="o">=</span> <span class="n">get_conf_key_value</span><span class="p">(</span>
        <span class="s2">&quot;server&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sslConfig&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enableSplunkdSSL&quot;</span><span class="p">,</span>
        <span class="n">APP_SYSTEM</span><span class="p">,</span>
        <span class="n">session_key</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">is_true</span><span class="p">(</span><span class="n">enable_splunkd_ssl</span><span class="p">):</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;https&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scheme</span> <span class="o">=</span> <span class="s2">&quot;http&quot;</span>

    <span class="n">host_port</span> <span class="o">=</span> <span class="n">get_conf_key_value</span><span class="p">(</span>
        <span class="s2">&quot;web&quot;</span><span class="p">,</span>
        <span class="s2">&quot;settings&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mgmtHostPort&quot;</span><span class="p">,</span>
        <span class="n">APP_SYSTEM</span><span class="p">,</span>
        <span class="n">session_key</span><span class="o">=</span><span class="n">session_key</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">host_port</span> <span class="o">=</span> <span class="n">host_port</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">host_port_split_parts</span> <span class="o">=</span> <span class="n">host_port</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">host</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">host_port_split_parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">host_port_split_parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">if</span> <span class="s2">&quot;SPLUNK_BINDIP&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
        <span class="n">bindip</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SPLUNK_BINDIP&quot;</span><span class="p">]</span>
        <span class="n">port_idx</span> <span class="o">=</span> <span class="n">bindip</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">host</span> <span class="o">=</span> <span class="n">bindip</span><span class="p">[:</span><span class="n">port_idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">port_idx</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">bindip</span>

    <span class="k">return</span> <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.get_splunkd_uri" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_splunkd_uri</span><span class="p">(</span><span class="n">session_key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.get_splunkd_uri" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get splunkd uri.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Needed to make a call to config endpoint. If &lsquo;None&rsquo;, solnlib will try to get it from
splunk.getSessionKey() and/or <strong>main</strong> module and if it won&rsquo;t get it, SessionKeyNotFound will be raised.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunkd uri.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_splunkd_uri</span><span class="p">(</span><span class="n">session_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get splunkd uri.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Needed to make a call to config endpoint. If &#39;None&#39;, solnlib will try to get it from</span>
<span class="sd">            splunk.getSessionKey() and/or __main__ module and if it won&#39;t get it, SessionKeyNotFound will be raised.</span>
<span class="sd">    Returns:</span>
<span class="sd">        Splunkd uri.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;SPLUNKD_URI&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SPLUNKD_URI&quot;</span><span class="p">]</span>

    <span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">get_splunkd_access_info</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">scheme</span><span class="si">}</span><span class="s2">://</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.make_splunkhome_path" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">make_splunkhome_path</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.make_splunkhome_path" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Construct absolute path by $SPLUNK_HOME and <code>parts</code>.</p>
<p>Concatenate $SPLUNK_HOME and <code>parts</code> to an absolute path.
For example, <code>parts</code> is [&lsquo;etc&rsquo;, &lsquo;apps&rsquo;, &lsquo;Splunk_TA_test&rsquo;],
the return path will be $SPLUNK_HOME/etc/apps/Splunk_TA_test.
Note: this function assumed SPLUNK_HOME is in environment varialbes.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>parts</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional-hover="typing.List">List</span>, <span data-autorefs-optional-hover="typing.Tuple">Tuple</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Path parts.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Absolute path.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Escape from intended parent directories.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_splunkhome_path</span><span class="p">(</span><span class="n">parts</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct absolute path by $SPLUNK_HOME and `parts`.</span>

<span class="sd">    Concatenate $SPLUNK_HOME and `parts` to an absolute path.</span>
<span class="sd">    For example, `parts` is [&#39;etc&#39;, &#39;apps&#39;, &#39;Splunk_TA_test&#39;],</span>
<span class="sd">    the return path will be $SPLUNK_HOME/etc/apps/Splunk_TA_test.</span>
<span class="sd">    Note: this function assumed SPLUNK_HOME is in environment varialbes.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        parts: Path parts.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Absolute path.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Escape from intended parent directories.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">msp</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.msp" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">msp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.msp" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">msp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;This module requires Splunk to be installed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="splunkenv-solnlib.splunkenv.simpleRequest" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">simpleRequest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#splunkenv-solnlib.splunkenv.simpleRequest" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/splunkenv.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">simpleRequest</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s2">&quot;This module requires Splunk to be installed.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><section class="print-page" id="time_parser"><h1 id="time_parser-time_parserpy">time_parser.py<a class="headerlink" href="#time_parser-time_parserpy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.time_parser"></a>
  <div class="doc doc-contents first">
  
      <p>This module provides interfaces to parse and convert timestamp.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="time_parser-solnlib.time_parser.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TimeParser&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#time_parser-solnlib.time_parser.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="time_parser-solnlib.time_parser.InvalidTimeFormatException" class="doc doc-heading">
        <code>InvalidTimeFormatException</code>


<a href="#time_parser-solnlib.time_parser.InvalidTimeFormatException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for invalid time format.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/time_parser.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidTimeFormatException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for invalid time format.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="time_parser-solnlib.time_parser.TimeParser" class="doc doc-heading">
        <code>TimeParser</code>


<a href="#time_parser-solnlib.time_parser.TimeParser" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Datetime parser.</p>
<p>Use splunkd rest to parse datetime.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">time_parser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span> <span class="o">=</span> <span class="n">time_parser</span><span class="o">.</span><span class="n">TimeParser</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">(</span><span class="s1">&#39;2011-07-06T21:54:23.000-07:00&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span><span class="o">.</span><span class="n">to_utc</span><span class="p">(</span><span class="s1">&#39;2011-07-06T21:54:23.000-07:00&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tp</span><span class="o">.</span><span class="n">to_local</span><span class="p">(</span><span class="s1">&#39;2011-07-06T21:54:23.000-07:00&#39;</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/time_parser.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimeParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Datetime parser.</span>

<span class="sd">    Use splunkd rest to parse datetime.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import time_parser</span>
<span class="sd">       &gt;&gt;&gt; tp = time_parser.TimeParser(session_key)</span>
<span class="sd">       &gt;&gt;&gt; tp.to_seconds(&#39;2011-07-06T21:54:23.000-07:00&#39;)</span>
<span class="sd">       &gt;&gt;&gt; tp.to_utc(&#39;2011-07-06T21:54:23.000-07:00&#39;)</span>
<span class="sd">       &gt;&gt;&gt; tp.to_local(&#39;2011-07-06T21:54:23.000-07:00&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">URL</span> <span class="o">=</span> <span class="s2">&quot;/services/search/timeparser&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes TimeParser.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if scheme, host or port are invalid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
            <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
        <span class="p">)</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse `time_str` and convert to seconds since epoch.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            time_str: ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: rest client returns an exception (everything</span>
<span class="sd">                else than 400 code).</span>
<span class="sd">            InvalidTimeFormatException: when time format is invalid (rest</span>
<span class="sd">                client returns 400 code).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Seconds since epoch.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time_str</span><span class="p">,</span> <span class="n">output_time_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">400</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">InvalidTimeFormatException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid time format: </span><span class="si">{</span><span class="n">time_str</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="n">seconds</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="n">time_str</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_utc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse `time_str` and convert to UTC timestamp.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            time_str: ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: rest client returns an exception (everything</span>
<span class="sd">                else than 400 code).</span>
<span class="sd">            InvalidTimeFormatException: when time format is invalid (rest</span>
<span class="sd">                client returns 400 code).</span>

<span class="sd">        Returns:</span>
<span class="sd">            UTC timestamp.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">(</span><span class="n">time_str</span><span class="p">))</span>

    <span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">to_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse `time_str` and convert to local timestamp.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            time_str: ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</span>

<span class="sd">        Raises:</span>
<span class="sd">            binding.HTTPError: rest client returns an exception (everything</span>
<span class="sd">                else than 400 code).</span>
<span class="sd">            InvalidTimeFormatException: when time format is invalid (rest</span>
<span class="sd">                client returns 400 code).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Local timestamp in ISO8601 format.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time_str</span>
            <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">400</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">InvalidTimeFormatException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid time format: </span><span class="si">{</span><span class="n">time_str</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="n">time_str</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="time_parser-solnlib.time_parser.TimeParser.URL" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;/services/search/timeparser&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#time_parser-solnlib.time_parser.TimeParser.URL" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="time_parser-solnlib.time_parser.TimeParser.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#time_parser-solnlib.time_parser.TimeParser.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes TimeParser.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if scheme, host or port are invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/time_parser.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes TimeParser.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if scheme, host or port are invalid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="time_parser-solnlib.time_parser.TimeParser.to_local" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">to_local</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span></code>

<a href="#time_parser-solnlib.time_parser.TimeParser.to_local" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse <code>time_str</code> and convert to local timestamp.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_str</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>rest client returns an exception (everything
else than 400 code).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.time_parser.InvalidTimeFormatException">InvalidTimeFormatException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>when time format is invalid (rest
client returns 400 code).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Local timestamp in ISO8601 format.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/time_parser.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">to_local</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse `time_str` and convert to local timestamp.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        time_str: ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: rest client returns an exception (everything</span>
<span class="sd">            else than 400 code).</span>
<span class="sd">        InvalidTimeFormatException: when time format is invalid (rest</span>
<span class="sd">            client returns 400 code).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Local timestamp in ISO8601 format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time_str</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">InvalidTimeFormatException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid time format: </span><span class="si">{</span><span class="n">time_str</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="n">time_str</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="time_parser-solnlib.time_parser.TimeParser.to_seconds" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">to_seconds</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span></code>

<a href="#time_parser-solnlib.time_parser.TimeParser.to_seconds" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse <code>time_str</code> and convert to seconds since epoch.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_str</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>rest client returns an exception (everything
else than 400 code).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.time_parser.InvalidTimeFormatException">InvalidTimeFormatException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>when time format is invalid (rest
client returns 400 code).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="float">float</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seconds since epoch.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/time_parser.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">to_seconds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse `time_str` and convert to seconds since epoch.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        time_str: ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: rest client returns an exception (everything</span>
<span class="sd">            else than 400 code).</span>
<span class="sd">        InvalidTimeFormatException: when time format is invalid (rest</span>
<span class="sd">            client returns 400 code).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Seconds since epoch.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time_str</span><span class="p">,</span> <span class="n">output_time_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">InvalidTimeFormatException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid time format: </span><span class="si">{</span><span class="n">time_str</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>

    <span class="n">seconds</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="n">time_str</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">seconds</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="time_parser-solnlib.time_parser.TimeParser.to_utc" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">to_utc</span><span class="p">(</span><span class="n">time_str</span><span class="p">)</span></code>

<a href="#time_parser-solnlib.time_parser.TimeParser.to_utc" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse <code>time_str</code> and convert to UTC timestamp.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_str</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="splunklib.binding">binding</span>.<span data-autorefs-optional-hover="splunklib.binding.HTTPError">HTTPError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>rest client returns an exception (everything
else than 400 code).</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.time_parser.InvalidTimeFormatException">InvalidTimeFormatException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>when time format is invalid (rest
client returns 400 code).</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="datetime">datetime</span>.<span data-autorefs-optional-hover="datetime.datetime">datetime</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>UTC timestamp.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/time_parser.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_utc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse `time_str` and convert to UTC timestamp.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        time_str: ISO8601 format timestamp, example: 2011-07-06T21:54:23.000-07:00.</span>

<span class="sd">    Raises:</span>
<span class="sd">        binding.HTTPError: rest client returns an exception (everything</span>
<span class="sd">            else than 400 code).</span>
<span class="sd">        InvalidTimeFormatException: when time format is invalid (rest</span>
<span class="sd">            client returns 400 code).</span>

<span class="sd">    Returns:</span>
<span class="sd">        UTC timestamp.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_seconds</span><span class="p">(</span><span class="n">time_str</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="timer_queue"><h1 id="timer_queue-timer_queuepy">timer_queue.py<a class="headerlink" href="#timer_queue-timer_queuepy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.timer_queue"></a>
  <div class="doc doc-contents first">
  
      <p>A simple thread safe timer queue implementation which has O(logn) time
complexity.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="timer_queue-solnlib.timer_queue.TEARDOWN_SENTINEL" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">TEARDOWN_SENTINEL</span> <span class="o">=</span> <span class="kc">None</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#timer_queue-solnlib.timer_queue.TEARDOWN_SENTINEL" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="timer_queue-solnlib.timer_queue.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Timer&#39;</span><span class="p">,</span> <span class="s1">&#39;TimerQueueStruct&#39;</span><span class="p">,</span> <span class="s1">&#39;TimerQueue&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#timer_queue-solnlib.timer_queue.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="timer_queue-solnlib.timer_queue.Timer" class="doc doc-heading">
        <code>Timer</code>


<a href="#timer_queue-solnlib.timer_queue.Timer" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Timer wraps the callback and timestamp related attributes.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Timer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Timer wraps the callback and timestamp related attributes.&quot;&quot;&quot;</span>

    <span class="n">_ident</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ident</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes Timer.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: Arbitrary callable object.</span>
<span class="sd">            when: The first expiration time, seconds since epoch.</span>
<span class="sd">            interval: Timer interval, if equals 0, one time timer, otherwise</span>
<span class="sd">                the timer will be periodically executed.</span>
<span class="sd">            ident: (optional) Timer identity.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">when</span> <span class="o">=</span> <span class="n">when</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">interval</span>

        <span class="k">if</span> <span class="n">ident</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">=</span> <span class="n">ident</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">update_expiration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">when</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Timer</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="timer_queue-solnlib.timer_queue.Timer.ident" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">ident</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">+</span> <span class="mi">1</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#timer_queue-solnlib.timer_queue.Timer.ident" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="timer_queue-solnlib.timer_queue.Timer.interval" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">interval</span> <span class="o">=</span> <span class="n">interval</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#timer_queue-solnlib.timer_queue.Timer.interval" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="timer_queue-solnlib.timer_queue.Timer.when" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">when</span> <span class="o">=</span> <span class="n">when</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#timer_queue-solnlib.timer_queue.Timer.when" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__call__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__call__</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__eq__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__eq__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Timer</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__ge__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__ge__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__ge__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__gt__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__gt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__gt__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__hash__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__hash__</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__hash__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes Timer.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arbitrary callable object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>when</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first expiration time, seconds since epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Timer interval, if equals 0, one time timer, otherwise
the timer will be periodically executed.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ident</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Timer identity.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ident</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes Timer.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Arbitrary callable object.</span>
<span class="sd">        when: The first expiration time, seconds since epoch.</span>
<span class="sd">        interval: Timer interval, if equals 0, one time timer, otherwise</span>
<span class="sd">            the timer will be periodically executed.</span>
<span class="sd">        ident: (optional) Timer identity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_callback</span> <span class="o">=</span> <span class="n">callback</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">when</span> <span class="o">=</span> <span class="n">when</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">interval</span>

    <span class="k">if</span> <span class="n">ident</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">=</span> <span class="n">ident</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ident</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">=</span> <span class="n">Timer</span><span class="o">.</span><span class="n">_ident</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__le__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__le__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.__lt__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.__lt__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">when</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">ident</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.Timer.update_expiration" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update_expiration</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.Timer.update_expiration" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_expiration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">when</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="timer_queue-solnlib.timer_queue.TimerQueue" class="doc doc-heading">
        <code>TimerQueue</code>


<a href="#timer_queue-solnlib.timer_queue.TimerQueue" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A simple timer queue implementation.</p>
<p>It runs a separate thread to handle timers Note: to effectively use this
timer queue, the timer callback should be short, otherwise it will cause
other timers&rsquo;s delay execution. A typical use scenario in production is
that the timers are just a simple functions which inject themselvies to
a task queue and then they are picked up by a threading/process pool to
execute, as shows below:</p>
<div class="codehilite"><pre><span></span><code><span class="n">Timers</span><span class="w"> </span><span class="o">--</span><span class="n">enqueue</span><span class="o">---&gt;</span><span class="w"> </span><span class="n">TimerQueue</span><span class="w"> </span><span class="o">--------</span><span class="n">expiration</span><span class="o">-----------</span>
<span class="w">                                                            </span><span class="o">|</span>
<span class="w">                                                            </span><span class="o">|</span>
<span class="w">                                                           </span><span class="err">\</span><span class="o">|/</span>
<span class="n">Threading</span><span class="o">/</span><span class="nf">Process</span><span class="w"> </span><span class="n">Pool</span><span class="w"> </span><span class="o">&lt;----</span><span class="w"> </span><span class="n">TaskQueue</span><span class="w"> </span><span class="o">&lt;--</span><span class="n">enqueue</span><span class="o">--</span><span class="w"> </span><span class="n">Timers</span><span class="s">&#39; callback (nonblocking)</span>
</code></pre></div>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">timer_queue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span> <span class="o">=</span> <span class="n">timer_queue</span><span class="o">.</span><span class="n">TimerQueue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">add_timer</span><span class="p">(</span><span class="n">my_func</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># do other stuff</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimerQueue</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A simple timer queue implementation.</span>

<span class="sd">    It runs a separate thread to handle timers Note: to effectively use this</span>
<span class="sd">    timer queue, the timer callback should be short, otherwise it will cause</span>
<span class="sd">    other timers&#39;s delay execution. A typical use scenario in production is</span>
<span class="sd">    that the timers are just a simple functions which inject themselvies to</span>
<span class="sd">    a task queue and then they are picked up by a threading/process pool to</span>
<span class="sd">    execute, as shows below:</span>

<span class="sd">        Timers --enqueue---&gt; TimerQueue --------expiration-----------</span>
<span class="sd">                                                                    |</span>
<span class="sd">                                                                    |</span>
<span class="sd">                                                                   \|/</span>
<span class="sd">        Threading/Process Pool &lt;---- TaskQueue &lt;--enqueue-- Timers&#39; callback (nonblocking)</span>

<span class="sd">    Examples:</span>
<span class="sd">           &gt;&gt;&gt; from solnlib import timer_queue</span>
<span class="sd">           &gt;&gt;&gt; tq = timer_queue.TimerQueue()</span>
<span class="sd">           &gt;&gt;&gt; tq.start()</span>
<span class="sd">           &gt;&gt;&gt; t = tq.add_timer(my_func, time.time(), 10)</span>
<span class="sd">           &gt;&gt;&gt; # do other stuff</span>
<span class="sd">           &gt;&gt;&gt; tq.stop()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span> <span class="o">=</span> <span class="n">TimerQueueStruct</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_and_execute</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Start the timer queue.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;TimerQueue started.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop the timer queue.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup</span><span class="p">(</span><span class="n">TEARDOWN_SENTINEL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">add_timer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ident</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add timer to the queue.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: Arbitrary callable object.</span>
<span class="sd">            when: The first expiration time, seconds since epoch.</span>
<span class="sd">            interval: Timer interval, if equals 0, one time timer, otherwise</span>
<span class="sd">                the timer will be periodically executed</span>
<span class="sd">            ident: (optional) Timer identity.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A timer object which should not be manipulated directly by</span>
<span class="sd">                clients. Used to delete/update the timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">add_timer</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">timer</span>

    <span class="k">def</span> <span class="nf">remove_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">Timer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove timer from the queue.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            timer: Timer object to remove.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">remove_timer</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_and_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wakeup_queue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup_queue</span>
        <span class="k">while</span> <span class="mi">1</span><span class="p">:</span>
            <span class="p">(</span><span class="n">next_expired_time</span><span class="p">,</span> <span class="n">expired_timers</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_expired_timers</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">expired_timers</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Note, please make timer callback effective/short</span>
                    <span class="n">timer</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_reset_timers</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)</span>

            <span class="n">sleep_time</span> <span class="o">=</span> <span class="n">_calc_sleep_time</span><span class="p">(</span><span class="n">next_expired_time</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">wakeup</span> <span class="o">=</span> <span class="n">wakeup_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">sleep_time</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">wakeup</span> <span class="ow">is</span> <span class="n">TEARDOWN_SENTINEL</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">except</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;TimerQueue stopped.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_expired_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">get_expired_timers</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_reset_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expired_timers</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
            <span class="n">has_new_timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">reset_timers</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">has_new_timer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_wakeup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">something</span><span class="o">=</span><span class="s2">&quot;not_None&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">something</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueue.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueue.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span> <span class="o">=</span> <span class="n">TimerQueueStruct</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_and_execute</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueue.add_timer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">add_timer</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueue.add_timer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add timer to the queue.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arbitrary callable object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>when</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first expiration time, seconds since epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Timer interval, if equals 0, one time timer, otherwise
the timer will be periodically executed</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ident</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Timer identity.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.timer_queue.Timer">Timer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A timer object which should not be manipulated directly by
clients. Used to delete/update the timer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_timer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ident</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add timer to the queue.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Arbitrary callable object.</span>
<span class="sd">        when: The first expiration time, seconds since epoch.</span>
<span class="sd">        interval: Timer interval, if equals 0, one time timer, otherwise</span>
<span class="sd">            the timer will be periodically executed</span>
<span class="sd">        ident: (optional) Timer identity.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A timer object which should not be manipulated directly by</span>
<span class="sd">            clients. Used to delete/update the timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="n">timer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">add_timer</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">timer</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueue.remove_timer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">remove_timer</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueue.remove_timer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove timer from the queue.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>timer</code></td>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.timer_queue.Timer">Timer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Timer object to remove.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">Timer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove timer from the queue.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        timer: Timer object to remove.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">remove_timer</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueue.start" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">start</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueue.start" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Start the timer queue.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Start the timer queue.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;TimerQueue started.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueue.stop" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">stop</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueue.stop" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Stop the timer queue.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stop the timer queue.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_started</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_started</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_wakeup</span><span class="p">(</span><span class="n">TEARDOWN_SENTINEL</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thr</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="timer_queue-solnlib.timer_queue.TimerQueueStruct" class="doc doc-heading">
        <code>TimerQueueStruct</code>


<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>The underlying data structure for TimerQueue.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">TimerQueueStruct</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The underlying data structure for TimerQueue.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">SortedSet</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cancelling_timers</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">add_timer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ident</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add timer to the data structure.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            callback: Arbitrary callable object.</span>
<span class="sd">            when: The first expiration time, seconds since epoch.</span>
<span class="sd">            interval: Timer interval, if equals 0, one time timer, otherwise</span>
<span class="sd">                the timer will be periodically executed</span>
<span class="sd">            ident: (optional) Timer identity.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A timer object which should not be manipulated directly by</span>
<span class="sd">                clients. Used to delete/update the timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">timer</span>

    <span class="k">def</span> <span class="nf">remove_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">Timer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove timer from data structure.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            timer: Timer object which is returned by ``TimerQueueStruct.add_timer``.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Timer=</span><span class="si">%s</span><span class="s2"> is not in queue, move it to cancelling &quot;</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">timer</span><span class="o">.</span><span class="n">ident</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cancelling_timers</span><span class="p">[</span><span class="n">timer</span><span class="o">.</span><span class="n">ident</span><span class="p">]</span> <span class="o">=</span> <span class="n">timer</span>

    <span class="k">def</span> <span class="nf">get_expired_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a list of expired timers.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of ``Timer``, empty list if there is no expired timers.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">next_expired_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">expired_timers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">when</span> <span class="o">&lt;=</span> <span class="n">now</span><span class="p">:</span>
                <span class="n">expired_timers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">expired_timers</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">:</span>
            <span class="n">next_expired_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">when</span>
        <span class="k">return</span> <span class="n">next_expired_time</span><span class="p">,</span> <span class="n">expired_timers</span>

    <span class="k">def</span> <span class="nf">reset_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expired_timers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Timer</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Re-add the expired periodical timers to data structure for next</span>
<span class="sd">        round scheduling.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            expired_timers: List of expired timers.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if there are timers added, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">has_new_timer</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cancelling_timers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cancelling_timers</span>
        <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">expired_timers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">ident</span> <span class="ow">in</span> <span class="n">cancelling_timers</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">timer</span><span class="o">.</span><span class="n">interval</span><span class="p">:</span>
                <span class="c1"># Repeated timer</span>
                <span class="n">timer</span><span class="o">.</span><span class="n">update_expiration</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
                <span class="n">has_new_timer</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">cancelling_timers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">has_new_timer</span>

    <span class="k">def</span> <span class="nf">check_and_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get expired timers and execute callbacks for the timers.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Duration of next expired timer.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="p">(</span><span class="n">next_expired_time</span><span class="p">,</span> <span class="n">expired_timers</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_expired_timers</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">expired_timers</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">timer</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">reset_timers</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_calc_sleep_time</span><span class="p">(</span><span class="n">next_expired_time</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueueStruct.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">SortedSet</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cancelling_timers</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueueStruct.add_timer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">add_timer</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct.add_timer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add timer to the data structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Arbitrary callable object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>when</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The first expiration time, seconds since epoch.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interval</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Timer interval, if equals 0, one time timer, otherwise
the timer will be periodically executed</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>ident</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Timer identity.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.timer_queue.Timer">Timer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A timer object which should not be manipulated directly by
clients. Used to delete/update the timer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_timer</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">when</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">interval</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ident</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Timer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add timer to the data structure.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Arbitrary callable object.</span>
<span class="sd">        when: The first expiration time, seconds since epoch.</span>
<span class="sd">        interval: Timer interval, if equals 0, one time timer, otherwise</span>
<span class="sd">            the timer will be periodically executed</span>
<span class="sd">        ident: (optional) Timer identity.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A timer object which should not be manipulated directly by</span>
<span class="sd">            clients. Used to delete/update the timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="n">callback</span><span class="p">,</span> <span class="n">when</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">ident</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">timer</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueueStruct.check_and_execute" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">check_and_execute</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct.check_and_execute" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get expired timers and execute callbacks for the timers.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="float">float</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Duration of next expired timer.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_and_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get expired timers and execute callbacks for the timers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Duration of next expired timer.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span><span class="n">next_expired_time</span><span class="p">,</span> <span class="n">expired_timers</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_expired_timers</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">expired_timers</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">timer</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">reset_timers</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_calc_sleep_time</span><span class="p">(</span><span class="n">next_expired_time</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueueStruct.get_expired_timers" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_expired_timers</span><span class="p">()</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct.get_expired_timers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get a list of expired timers.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Tuple">Tuple</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of <code>Timer</code>, empty list if there is no expired timers.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_expired_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get a list of expired timers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of ``Timer``, empty list if there is no expired timers.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">next_expired_time</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
    <span class="n">expired_timers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">when</span> <span class="o">&lt;=</span> <span class="n">now</span><span class="p">:</span>
            <span class="n">expired_timers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">expired_timers</span><span class="p">:</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">:</span>
        <span class="n">next_expired_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">when</span>
    <span class="k">return</span> <span class="n">next_expired_time</span><span class="p">,</span> <span class="n">expired_timers</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueueStruct.remove_timer" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">remove_timer</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct.remove_timer" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Remove timer from data structure.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>timer</code></td>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.timer_queue.Timer">Timer</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Timer object which is returned by <code>TimerQueueStruct.add_timer</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timer</span><span class="p">:</span> <span class="n">Timer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove timer from data structure.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        timer: Timer object which is returned by ``TimerQueueStruct.add_timer``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Timer=</span><span class="si">%s</span><span class="s2"> is not in queue, move it to cancelling &quot;</span> <span class="s2">&quot;list&quot;</span><span class="p">,</span> <span class="n">timer</span><span class="o">.</span><span class="n">ident</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cancelling_timers</span><span class="p">[</span><span class="n">timer</span><span class="o">.</span><span class="n">ident</span><span class="p">]</span> <span class="o">=</span> <span class="n">timer</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="timer_queue-solnlib.timer_queue.TimerQueueStruct.reset_timers" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">reset_timers</span><span class="p">(</span><span class="n">expired_timers</span><span class="p">)</span></code>

<a href="#timer_queue-solnlib.timer_queue.TimerQueueStruct.reset_timers" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Re-add the expired periodical timers to data structure for next
round scheduling.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>expired_timers</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional-hover="solnlib.timer_queue.Timer">Timer</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of expired timers.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if there are timers added, False otherwise.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/timer_queue.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_timers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expired_timers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Timer</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Re-add the expired periodical timers to data structure for next</span>
<span class="sd">    round scheduling.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        expired_timers: List of expired timers.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if there are timers added, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">has_new_timer</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">cancelling_timers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cancelling_timers</span>
    <span class="k">for</span> <span class="n">timer</span> <span class="ow">in</span> <span class="n">expired_timers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">timer</span><span class="o">.</span><span class="n">ident</span> <span class="ow">in</span> <span class="n">cancelling_timers</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">timer</span><span class="o">.</span><span class="n">interval</span><span class="p">:</span>
            <span class="c1"># Repeated timer</span>
            <span class="n">timer</span><span class="o">.</span><span class="n">update_expiration</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_timers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span>
            <span class="n">has_new_timer</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">cancelling_timers</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">has_new_timer</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div></section><section class="print-page" id="user_access"><h1 id="user_access-user_accesspy">user_access.py<a class="headerlink" href="#user_access-user_accesspy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.user_access"></a>
  <div class="doc doc-contents first">
  
      <p>Splunk user access control related utilities.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="user_access-solnlib.user_access.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ObjectACLException&#39;</span><span class="p">,</span> <span class="s1">&#39;ObjectACL&#39;</span><span class="p">,</span> <span class="s1">&#39;ObjectACLManagerException&#39;</span><span class="p">,</span> <span class="s1">&#39;ObjectACLManager&#39;</span><span class="p">,</span> <span class="s1">&#39;AppCapabilityManagerException&#39;</span><span class="p">,</span> <span class="s1">&#39;AppCapabilityManager&#39;</span><span class="p">,</span> <span class="s1">&#39;UserAccessException&#39;</span><span class="p">,</span> <span class="s1">&#39;check_user_access&#39;</span><span class="p">,</span> <span class="s1">&#39;InvalidSessionKeyException&#39;</span><span class="p">,</span> <span class="s1">&#39;get_current_username&#39;</span><span class="p">,</span> <span class="s1">&#39;UserNotExistException&#39;</span><span class="p">,</span> <span class="s1">&#39;get_user_capabilities&#39;</span><span class="p">,</span> <span class="s1">&#39;user_is_capable&#39;</span><span class="p">,</span> <span class="s1">&#39;get_user_roles&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.AppCapabilityManager" class="doc doc-heading">
        <code>AppCapabilityManager</code>


<a href="#user_access-solnlib.user_access.AppCapabilityManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>App capability manager.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acm</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">AppCapabilityManager</span><span class="p">(</span><span class="s1">&#39;test_collection&#39;</span><span class="p">,</span>
<span class="go">                                           session_key,</span>
<span class="go">                                           &#39;Splunk_TA_test&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acm</span><span class="o">.</span><span class="n">register_capabilities</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acm</span><span class="o">.</span><span class="n">unregister_capabilities</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AppCapabilityManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;App capability manager.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; acm = user_access.AppCapabilityManager(&#39;test_collection&#39;,</span>
<span class="sd">                                                  session_key,</span>
<span class="sd">                                                  &#39;Splunk_TA_test&#39;)</span>
<span class="sd">       &gt;&gt;&gt; acm.register_capabilities(...)</span>
<span class="sd">       &gt;&gt;&gt; acm.unregister_capabilities(...)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes AppCapabilityManager.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            collection_name: Collection name to store capabilities.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AppCapabilityManagerException: If init AppCapabilityManager failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_app</span> <span class="o">=</span> <span class="n">app</span>

        <span class="n">collection_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">app</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">get_collection_data</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="p">,</span>
                <span class="n">session_key</span><span class="p">,</span>
                <span class="n">app</span><span class="p">,</span>
                <span class="n">owner</span><span class="p">,</span>
                <span class="n">scheme</span><span class="p">,</span>
                <span class="n">host</span><span class="p">,</span>
                <span class="n">port</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="o">**</span><span class="n">context</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AppCapabilityManagerException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Get app capabilities collection: </span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2"> failed.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">register_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register app capabilities.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            capabilities: App capabilities, example:</span>

<span class="sd">                {</span>
<span class="sd">                    &#39;object_type1&#39;: {</span>
<span class="sd">                        &#39;read&#39;: &#39;read_app_object_type1&#39;,</span>
<span class="sd">                        &#39;write&#39;: &#39;write_app_object_type1&#39;,</span>
<span class="sd">                        &#39;delete&#39;: &#39;delete_app_object_type1&#39;},</span>
<span class="sd">                        &#39;object_type2&#39;: {</span>
<span class="sd">                        &#39;read&#39;: &#39;read_app_object_type2&#39;,</span>
<span class="sd">                        &#39;write&#39;: &#39;write_app_object_type2&#39;,</span>
<span class="sd">                        &#39;delete&#39;: &#39;delete_app_object_type2&#39;</span>
<span class="sd">                    },</span>
<span class="sd">                    ...</span>
<span class="sd">                }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span> <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="n">capabilities</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">unregister_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unregister app capabilities.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AppCapabilityNotExistException: If app capabilities are not registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">AppCapabilityNotExistException</span><span class="p">(</span>
                <span class="s2">&quot;App capabilities for </span><span class="si">%s</span><span class="s2"> have not been registered.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span>
            <span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">capabilities_are_registered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if app capabilities are registered.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if app capabilities are registered else False.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get app capabilities.</span>

<span class="sd">        Returns:</span>
<span class="sd">            App capabilities.</span>

<span class="sd">        Raises:</span>
<span class="sd">             AppCapabilityNotExistException: If app capabilities are not registered.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">AppCapabilityNotExistException</span><span class="p">(</span>
                <span class="s2">&quot;App capabilities for </span><span class="si">%s</span><span class="s2"> have not been registered.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;capabilities&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.AppCapabilityManager.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">collection_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.AppCapabilityManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes AppCapabilityManager.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>collection_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection name to store capabilities.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.AppCapabilityManagerException">AppCapabilityManagerException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If init AppCapabilityManager failed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes AppCapabilityManager.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        collection_name: Collection name to store capabilities.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AppCapabilityManagerException: If init AppCapabilityManager failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_app</span> <span class="o">=</span> <span class="n">app</span>

    <span class="n">collection_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">app</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">get_collection_data</span><span class="p">(</span>
            <span class="n">collection_name</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app</span><span class="p">,</span>
            <span class="n">owner</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">AppCapabilityManagerException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Get app capabilities collection: </span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2"> failed.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.AppCapabilityManager.capabilities_are_registered" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">capabilities_are_registered</span><span class="p">()</span></code>

<a href="#user_access-solnlib.user_access.AppCapabilityManager.capabilities_are_registered" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Check if app capabilities are registered.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if app capabilities are registered else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">capabilities_are_registered</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if app capabilities are registered.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if app capabilities are registered else False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.AppCapabilityManager.get_capabilities" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_capabilities</span><span class="p">()</span></code>

<a href="#user_access-solnlib.user_access.AppCapabilityManager.get_capabilities" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get app capabilities.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App capabilities.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.AppCapabilityNotExistException">AppCapabilityNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If app capabilities are not registered.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get app capabilities.</span>

<span class="sd">    Returns:</span>
<span class="sd">        App capabilities.</span>

<span class="sd">    Raises:</span>
<span class="sd">         AppCapabilityNotExistException: If app capabilities are not registered.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">record</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">AppCapabilityNotExistException</span><span class="p">(</span>
            <span class="s2">&quot;App capabilities for </span><span class="si">%s</span><span class="s2"> have not been registered.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">record</span><span class="p">[</span><span class="s2">&quot;capabilities&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.AppCapabilityManager.register_capabilities" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">register_capabilities</span><span class="p">(</span><span class="n">capabilities</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.AppCapabilityManager.register_capabilities" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Register app capabilities.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>capabilities</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App capabilities, example:</p>
<p>{
    &lsquo;object_type1&rsquo;: {
        &lsquo;read&rsquo;: &lsquo;read_app_object_type1&rsquo;,
        &lsquo;write&rsquo;: &lsquo;write_app_object_type1&rsquo;,
        &lsquo;delete&rsquo;: &lsquo;delete_app_object_type1&rsquo;},
        &lsquo;object_type2&rsquo;: {
        &lsquo;read&rsquo;: &lsquo;read_app_object_type2&rsquo;,
        &lsquo;write&rsquo;: &lsquo;write_app_object_type2&rsquo;,
        &lsquo;delete&rsquo;: &lsquo;delete_app_object_type2&rsquo;
    },
    &hellip;
}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">register_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register app capabilities.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        capabilities: App capabilities, example:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;object_type1&#39;: {</span>
<span class="sd">                    &#39;read&#39;: &#39;read_app_object_type1&#39;,</span>
<span class="sd">                    &#39;write&#39;: &#39;write_app_object_type1&#39;,</span>
<span class="sd">                    &#39;delete&#39;: &#39;delete_app_object_type1&#39;},</span>
<span class="sd">                    &#39;object_type2&#39;: {</span>
<span class="sd">                    &#39;read&#39;: &#39;read_app_object_type2&#39;,</span>
<span class="sd">                    &#39;write&#39;: &#39;write_app_object_type2&#39;,</span>
<span class="sd">                    &#39;delete&#39;: &#39;delete_app_object_type2&#39;</span>
<span class="sd">                },</span>
<span class="sd">                ...</span>
<span class="sd">            }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">record</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">,</span> <span class="s2">&quot;capabilities&quot;</span><span class="p">:</span> <span class="n">capabilities</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.AppCapabilityManager.unregister_capabilities" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">unregister_capabilities</span><span class="p">()</span></code>

<a href="#user_access-solnlib.user_access.AppCapabilityManager.unregister_capabilities" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Unregister app capabilities.</p>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.AppCapabilityNotExistException">AppCapabilityNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If app capabilities are not registered.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">unregister_capabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Unregister app capabilities.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AppCapabilityNotExistException: If app capabilities are not registered.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete_by_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_app</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">AppCapabilityNotExistException</span><span class="p">(</span>
            <span class="s2">&quot;App capabilities for </span><span class="si">%s</span><span class="s2"> have not been registered.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.AppCapabilityManagerException" class="doc doc-heading">
        <code>AppCapabilityManagerException</code>


<a href="#user_access-solnlib.user_access.AppCapabilityManagerException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for AppCapabilityManager.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AppCapabilityManagerException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for AppCapabilityManager.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.AppCapabilityNotExistException" class="doc doc-heading">
        <code>AppCapabilityNotExistException</code>


<a href="#user_access-solnlib.user_access.AppCapabilityNotExistException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for the situation when AppCapability does not exist for a
specific app.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AppCapabilityNotExistException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for the situation when AppCapability does not exist for a</span>
<span class="sd">    specific app.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.InvalidSessionKeyException" class="doc doc-heading">
        <code>InvalidSessionKeyException</code>


<a href="#user_access-solnlib.user_access.InvalidSessionKeyException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception when Splunk session key is invalid.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">InvalidSessionKeyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception when Splunk session key is invalid.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.ObjectACL" class="doc doc-heading">
        <code>ObjectACL</code>


<a href="#user_access-solnlib.user_access.ObjectACL" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Object ACL record.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj_acl</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">ObjectACL</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s1">&#39;test_collection&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s1">&#39;9defa6f510d711e6be16a45e60e34295&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s1">&#39;test_object&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s1">&#39;Splunk_TA_test&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="s1">&#39;admin&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="p">{</span><span class="s1">&#39;read&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">],</span> <span class="s1">&#39;write&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">],</span> <span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;admin&#39;</span><span class="p">]},</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="kc">False</span><span class="p">)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ObjectACL</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Object ACL record.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; obj_acl = user_access.ObjectACL(</span>
<span class="sd">       &gt;&gt;&gt;    &#39;test_collection&#39;,</span>
<span class="sd">       &gt;&gt;&gt;    &#39;9defa6f510d711e6be16a45e60e34295&#39;,</span>
<span class="sd">       &gt;&gt;&gt;    &#39;test_object&#39;,</span>
<span class="sd">       &gt;&gt;&gt;    &#39;Splunk_TA_test&#39;,</span>
<span class="sd">       &gt;&gt;&gt;    &#39;admin&#39;,</span>
<span class="sd">       &gt;&gt;&gt;    {&#39;read&#39;: [&#39;*&#39;], &#39;write&#39;: [&#39;admin&#39;], &#39;delete&#39;: [&#39;admin&#39;]},</span>
<span class="sd">       &gt;&gt;&gt;    False)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">OBJ_COLLECTION_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_collection&quot;</span>
    <span class="n">OBJ_ID_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_id&quot;</span>
    <span class="n">OBJ_TYPE_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_type&quot;</span>
    <span class="n">OBJ_APP_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_app&quot;</span>
    <span class="n">OBJ_OWNER_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_owner&quot;</span>
    <span class="n">OBJ_PERMS_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_perms&quot;</span>
    <span class="n">OBJ_PERMS_READ_KEY</span> <span class="o">=</span> <span class="s2">&quot;read&quot;</span>
    <span class="n">OBJ_PERMS_WRITE_KEY</span> <span class="o">=</span> <span class="s2">&quot;write&quot;</span>
    <span class="n">OBJ_PERMS_DELETE_KEY</span> <span class="o">=</span> <span class="s2">&quot;delete&quot;</span>
    <span class="n">OBJ_PERMS_ALLOW_ALL</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>
    <span class="n">OBJ_SHARED_BY_INCLUSION_KEY</span> <span class="o">=</span> <span class="s2">&quot;obj_shared_by_inclusion&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_perms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">obj_shared_by_inclusion</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ObjectACL.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_id: ID of this object.</span>
<span class="sd">            obj_type: Type of this object.</span>
<span class="sd">            obj_app: App of this object.</span>
<span class="sd">            obj_owner: Owner of this object.</span>
<span class="sd">            obj_perms: Object perms, like: {&#39;read&#39;: [&#39;*&#39;], &#39;write&#39;: [&#39;admin&#39;], &#39;delete&#39;: [&#39;admin&#39;]}.</span>
<span class="sd">            obj_shared_by_inclusion: Flag of object is shared by inclusion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_collection</span> <span class="o">=</span> <span class="n">obj_collection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_id</span> <span class="o">=</span> <span class="n">obj_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_type</span> <span class="o">=</span> <span class="n">obj_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_app</span> <span class="o">=</span> <span class="n">obj_app</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_owner</span> <span class="o">=</span> <span class="n">obj_owner</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_perms</span><span class="p">(</span><span class="n">obj_perms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span> <span class="o">=</span> <span class="n">obj_perms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj_shared_by_inclusion</span> <span class="o">=</span> <span class="n">obj_shared_by_inclusion</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_check_perms</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obj_perms</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj_perms</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">ObjectACLException</span><span class="p">(</span>
                <span class="s2">&quot;Invalid object acl perms type: </span><span class="si">%s</span><span class="s2">, should be a dict.&quot;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj_perms</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">OBJ_PERMS_READ_KEY</span> <span class="ow">in</span> <span class="n">obj_perms</span>
            <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">OBJ_PERMS_WRITE_KEY</span> <span class="ow">in</span> <span class="n">obj_perms</span>
            <span class="ow">and</span> <span class="bp">cls</span><span class="o">.</span><span class="n">OBJ_PERMS_DELETE_KEY</span> <span class="ow">in</span> <span class="n">obj_perms</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">ObjectACLException</span><span class="p">(</span>
                <span class="s2">&quot;Invalid object acl perms: </span><span class="si">%s</span><span class="s2">, &quot;</span>
                <span class="s2">&quot;should include read, write and delete perms.&quot;</span> <span class="o">%</span> <span class="n">obj_perms</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">obj_perms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span>

    <span class="nd">@obj_perms</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">obj_perms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_perms</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_perms</span><span class="p">(</span><span class="n">obj_perms</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span> <span class="o">=</span> <span class="n">obj_perms</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get object acl record.</span>

<span class="sd">        Returns: Object acl record, like:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;_key&#39;: &#39;test_collection-1234&#39;,</span>
<span class="sd">                &#39;obj_collection&#39;: &#39;test_collection&#39;,</span>
<span class="sd">                &#39;obj_id&#39;: &#39;1234&#39;,</span>
<span class="sd">                &#39;obj_type&#39;: &#39;test_object&#39;,</span>
<span class="sd">                &#39;obj_app&#39;: &#39;Splunk_TA_test&#39;,</span>
<span class="sd">                &#39;obj_owner&#39;: &#39;admin&#39;,</span>
<span class="sd">                &#39;obj_perms&#39;: {&#39;read&#39;: [&#39;*&#39;], &#39;write&#39;: [&#39;admin&#39;], &#39;delete&#39;: [&#39;admin&#39;]},</span>
<span class="sd">                &#39;obj_shared_by_inclusion&#39;: True</span>
<span class="sd">            }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj_collection</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_id</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_COLLECTION_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_collection</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_ID_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_id</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_TYPE_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_APP_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_app</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_OWNER_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_owner</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_PERMS_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_SHARED_BY_INCLUSION_KEY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj_shared_by_inclusion</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate object acl record key.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_id: ID of this object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object acl record key.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{obj_collection}</span><span class="s2">_</span><span class="si">{obj_id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">obj_collection</span><span class="o">=</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="o">=</span><span class="n">obj_id</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">obj_acl_record</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ObjectACL&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse object acl record and construct a new `ObjectACL` object from</span>
<span class="sd">        it.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_acl_record: Object acl record.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New `ObjectACL` object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">ObjectACL</span><span class="p">(</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_COLLECTION_KEY</span><span class="p">],</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_ID_KEY</span><span class="p">],</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_TYPE_KEY</span><span class="p">],</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_APP_KEY</span><span class="p">],</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_OWNER_KEY</span><span class="p">],</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_PERMS_KEY</span><span class="p">],</span>
            <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_SHARED_BY_INCLUSION_KEY</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_acl</span><span class="p">:</span> <span class="s2">&quot;ObjectACL&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge current object perms with perms of `obj_acl`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_acl: Object acl to merge.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">perm_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
                    <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]),</span> <span class="nb">set</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_PERMS_ALLOW_ALL</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">OBJ_PERMS_ALLOW_ALL</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_APP_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_APP_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_app&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_APP_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_COLLECTION_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_COLLECTION_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_collection&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_COLLECTION_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_ID_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_ID_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_id&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_ID_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_OWNER_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_OWNER_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_owner&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_OWNER_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_ALLOW_ALL" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_PERMS_ALLOW_ALL</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_ALLOW_ALL" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_DELETE_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_PERMS_DELETE_KEY</span> <span class="o">=</span> <span class="s1">&#39;delete&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_DELETE_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_PERMS_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_perms&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_READ_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_PERMS_READ_KEY</span> <span class="o">=</span> <span class="s1">&#39;read&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_READ_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_WRITE_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_PERMS_WRITE_KEY</span> <span class="o">=</span> <span class="s1">&#39;write&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_PERMS_WRITE_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_SHARED_BY_INCLUSION_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_SHARED_BY_INCLUSION_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_shared_by_inclusion&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_SHARED_BY_INCLUSION_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.OBJ_TYPE_KEY" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">OBJ_TYPE_KEY</span> <span class="o">=</span> <span class="s1">&#39;obj_type&#39;</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.OBJ_TYPE_KEY" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_app" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_app</span> <span class="o">=</span> <span class="n">obj_app</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_app" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_collection" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_collection</span> <span class="o">=</span> <span class="n">obj_collection</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_collection" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_id" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_id</span> <span class="o">=</span> <span class="n">obj_id</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_id" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_owner" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_owner</span> <span class="o">=</span> <span class="n">obj_owner</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_owner" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_perms" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_perms</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_perms" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_shared_by_inclusion" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_shared_by_inclusion</span> <span class="o">=</span> <span class="n">obj_shared_by_inclusion</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_shared_by_inclusion" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.obj_type" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">obj_type</span> <span class="o">=</span> <span class="n">obj_type</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.obj_type" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="user_access-solnlib.user_access.ObjectACL.record" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">record</span><span class="p">:</span> <span class="nb">dict</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.record" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get object acl record.</p>

  <p><strong>Object acl record, like:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>{
&lsquo;_key&rsquo;: &lsquo;test_collection-1234&rsquo;,
&lsquo;obj_collection&rsquo;: &lsquo;test_collection&rsquo;,
&lsquo;obj_id&rsquo;: &lsquo;1234&rsquo;,
&lsquo;obj_type&rsquo;: &lsquo;test_object&rsquo;,
&lsquo;obj_app&rsquo;: &lsquo;Splunk_TA_test&rsquo;,
&lsquo;obj_owner&rsquo;: &lsquo;admin&rsquo;,
&lsquo;obj_perms&rsquo;: {&lsquo;read&rsquo;: [&lsquo;*&rsquo;], &lsquo;write&rsquo;: [&lsquo;admin&rsquo;], &lsquo;delete&rsquo;: [&lsquo;admin&rsquo;]},
&lsquo;obj_shared_by_inclusion&rsquo;: True</p>
            </div>
          </td>
        </tr>
        <tr>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>}</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACL.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">,</span> <span class="n">obj_app</span><span class="p">,</span> <span class="n">obj_owner</span><span class="p">,</span> <span class="n">obj_perms</span><span class="p">,</span> <span class="n">obj_shared_by_inclusion</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACL.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ObjectACL.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_id</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ID of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Owner of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_perms</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object perms, like: {&lsquo;read&rsquo;: [&lsquo;*&rsquo;], &lsquo;write&rsquo;: [&lsquo;admin&rsquo;], &lsquo;delete&rsquo;: [&lsquo;admin&rsquo;]}.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_shared_by_inclusion</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Flag of object is shared by inclusion.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_perms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">obj_shared_by_inclusion</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ObjectACL.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_id: ID of this object.</span>
<span class="sd">        obj_type: Type of this object.</span>
<span class="sd">        obj_app: App of this object.</span>
<span class="sd">        obj_owner: Owner of this object.</span>
<span class="sd">        obj_perms: Object perms, like: {&#39;read&#39;: [&#39;*&#39;], &#39;write&#39;: [&#39;admin&#39;], &#39;delete&#39;: [&#39;admin&#39;]}.</span>
<span class="sd">        obj_shared_by_inclusion: Flag of object is shared by inclusion.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_collection</span> <span class="o">=</span> <span class="n">obj_collection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_id</span> <span class="o">=</span> <span class="n">obj_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_type</span> <span class="o">=</span> <span class="n">obj_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_app</span> <span class="o">=</span> <span class="n">obj_app</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_owner</span> <span class="o">=</span> <span class="n">obj_owner</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_check_perms</span><span class="p">(</span><span class="n">obj_perms</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span> <span class="o">=</span> <span class="n">obj_perms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">obj_shared_by_inclusion</span> <span class="o">=</span> <span class="n">obj_shared_by_inclusion</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACL.__str__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__str__</span><span class="p">()</span></code>

<a href="#user_access-solnlib.user_access.ObjectACL.__str__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACL.generate_key" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.generate_key" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate object acl record key.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_id</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ID of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object acl record key.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate object acl record key.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_id: ID of this object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Object acl record key.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{obj_collection}</span><span class="s2">_</span><span class="si">{obj_id}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">obj_collection</span><span class="o">=</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="o">=</span><span class="n">obj_id</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACL.merge" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">merge</span><span class="p">(</span><span class="n">obj_acl</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACL.merge" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Merge current object perms with perms of <code>obj_acl</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_acl</code></td>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.ObjectACL">ObjectACL</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object acl to merge.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_acl</span><span class="p">:</span> <span class="s2">&quot;ObjectACL&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge current object perms with perms of `obj_acl`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_acl: Object acl to merge.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">perm_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span>
                <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]),</span> <span class="nb">set</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">])</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OBJ_PERMS_ALLOW_ALL</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_obj_perms</span><span class="p">[</span><span class="n">perm_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">OBJ_PERMS_ALLOW_ALL</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACL.parse" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">parse</span><span class="p">(</span><span class="n">obj_acl_record</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#user_access-solnlib.user_access.ObjectACL.parse" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Parse object acl record and construct a new <code>ObjectACL</code> object from
it.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_acl_record</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object acl record.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.ObjectACL">ObjectACL</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New <code>ObjectACL</code> object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="n">obj_acl_record</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ObjectACL&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse object acl record and construct a new `ObjectACL` object from</span>
<span class="sd">    it.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_acl_record: Object acl record.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New `ObjectACL` object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">ObjectACL</span><span class="p">(</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_COLLECTION_KEY</span><span class="p">],</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_ID_KEY</span><span class="p">],</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_TYPE_KEY</span><span class="p">],</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_APP_KEY</span><span class="p">],</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_OWNER_KEY</span><span class="p">],</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_PERMS_KEY</span><span class="p">],</span>
        <span class="n">obj_acl_record</span><span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_SHARED_BY_INCLUSION_KEY</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.ObjectACLException" class="doc doc-heading">
        <code>ObjectACLException</code>


<a href="#user_access-solnlib.user_access.ObjectACLException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>



        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ObjectACLException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.ObjectACLManager" class="doc doc-heading">
        <code>ObjectACLManager</code>


<a href="#user_access-solnlib.user_access.ObjectACLManager" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>Object ACL manager.</p>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oaclm</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">ObjectACLManager</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span>
<span class="go">                                         &#39;Splunk_TA_test&#39;)</span>
</code></pre></div>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ObjectACLManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Object ACL manager.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; oaclm = user_access.ObjectACLManager(session_key,</span>
<span class="sd">                                                &#39;Splunk_TA_test&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">owner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
        <span class="n">scheme</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes ObjectACLManager.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            collection_name: Collection name to store object ACL info.</span>
<span class="sd">            session_key: Splunk access token.</span>
<span class="sd">            app: App name of namespace.</span>
<span class="sd">            owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">            scheme: (optional) The access scheme, default is None.</span>
<span class="sd">            host: (optional) The host name, default is None.</span>
<span class="sd">            port: (optional) The port number, default is None.</span>
<span class="sd">            context: Other configurations for Splunk rest client.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ObjectACLManagerException: If init ObjectACLManager failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{app}</span><span class="s2">_</span><span class="si">{collection_name}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="n">collection_name</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">get_collection_data</span><span class="p">(</span>
                <span class="n">collection_name</span><span class="p">,</span>
                <span class="n">session_key</span><span class="p">,</span>
                <span class="n">app</span><span class="p">,</span>
                <span class="n">owner</span><span class="p">,</span>
                <span class="n">scheme</span><span class="p">,</span>
                <span class="n">host</span><span class="p">,</span>
                <span class="n">port</span><span class="p">,</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="o">**</span><span class="n">context</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObjectACLManagerException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Get object acl collection: </span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2"> fail.&quot;</span>
            <span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update_acl</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_perms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">obj_shared_by_inclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">replace_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update acl info of object.</span>

<span class="sd">        Construct a new object acl info first, if `replace_existing` is True</span>
<span class="sd">        then replace existing acl info else merge new object acl info with the</span>
<span class="sd">        old one and replace the old acl info with merged acl info.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_id: ID of this object.</span>
<span class="sd">            obj_type: Type of this object.</span>
<span class="sd">            obj_app: App of this object.</span>
<span class="sd">            obj_owner: Owner of this object.</span>
<span class="sd">            obj_perms: Object perms, like:</span>

<span class="sd">                {</span>
<span class="sd">                    &#39;read&#39;: [&#39;*&#39;],</span>
<span class="sd">                    &#39;write&#39;: [&#39;admin&#39;],</span>
<span class="sd">                    &#39;delete&#39;: [&#39;admin&#39;]</span>
<span class="sd">                }.</span>
<span class="sd">            obj_shared_by_inclusion: (optional) Flag of object is shared by</span>
<span class="sd">                inclusion, default is True.</span>
<span class="sd">            replace_existing: (optional) Replace existing acl info flag, True</span>
<span class="sd">                indicates replace old acl info with new one else merge with old</span>
<span class="sd">                acl info, default is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj_acl</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="p">(</span>
            <span class="n">obj_collection</span><span class="p">,</span>
            <span class="n">obj_id</span><span class="p">,</span>
            <span class="n">obj_type</span><span class="p">,</span>
            <span class="n">obj_app</span><span class="p">,</span>
            <span class="n">obj_owner</span><span class="p">,</span>
            <span class="n">obj_perms</span><span class="p">,</span>
            <span class="n">obj_shared_by_inclusion</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">replace_existing</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ObjectACLNotExistException</span><span class="p">:</span>
                <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">old_obj_acl</span><span class="p">:</span>
                <span class="n">obj_acl</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">old_obj_acl</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">record</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">update_acls</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj_perms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">obj_shared_by_inclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">replace_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Batch update object acl info to all provided `obj_ids`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where objects currently stored.</span>
<span class="sd">            obj_ids: IDs list of objects.</span>
<span class="sd">            obj_type: Type of this object.</span>
<span class="sd">            obj_app: App of this object.</span>
<span class="sd">            obj_owner: Owner of this object.</span>
<span class="sd">            obj_perms: Object perms, like:</span>

<span class="sd">                {</span>
<span class="sd">                    &#39;read&#39;: [&#39;*&#39;],</span>
<span class="sd">                    &#39;write&#39;: [&#39;admin&#39;],</span>
<span class="sd">                    &#39;delete&#39;: [&#39;admin&#39;]</span>
<span class="sd">                }.</span>
<span class="sd">            obj_shared_by_inclusion: (optional) Flag of object is shared by</span>
<span class="sd">                inclusion, default is True.</span>
<span class="sd">            replace_existing: (optional) Replace existing acl info flag, True</span>
<span class="sd">                indicates replace old acl info with new one else merge with old acl</span>
<span class="sd">                info, default is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj_acl_records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">obj_ids</span><span class="p">:</span>
            <span class="n">obj_acl</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="p">(</span>
                <span class="n">obj_collection</span><span class="p">,</span>
                <span class="n">obj_id</span><span class="p">,</span>
                <span class="n">obj_type</span><span class="p">,</span>
                <span class="n">obj_app</span><span class="p">,</span>
                <span class="n">obj_owner</span><span class="p">,</span>
                <span class="n">obj_perms</span><span class="p">,</span>
                <span class="n">obj_shared_by_inclusion</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">replace_existing</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">ObjectACLNotExistException</span><span class="p">:</span>
                    <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="n">old_obj_acl</span><span class="p">:</span>
                    <span class="n">obj_acl</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">old_obj_acl</span><span class="p">)</span>

            <span class="n">obj_acl_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">record</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="o">*</span><span class="n">obj_acl_records</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_acl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ObjectACL&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get acl info.</span>

<span class="sd">        Query object acl info with parameter of the combination of</span>
<span class="sd">        `obj_collection` and `obj_id` from `self.collection_name` and</span>
<span class="sd">        return it.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_id: ID of this object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Object acl info if success else None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ObjectACLNotExistException: If object ACL info does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">ObjectACLNotExistException</span><span class="p">(</span>
                <span class="s2">&quot;Object ACL info of </span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2"> does not exist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">obj_acl</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_acls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ObjectACL</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Batch get acl info.</span>

<span class="sd">        Query objects acl info with parameter of the combination of</span>
<span class="sd">        `obj_collection` and `obj_ids` from KVStore and return them.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_ids: IDs of objects.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of `ObjectACL` instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;$or&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)}</span>
                    <span class="k">for</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">obj_ids</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">obj_acls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">obj_acl</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj_acl</span> <span class="ow">in</span> <span class="n">obj_acls</span><span class="p">]</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete_acl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Delete acl info.</span>

<span class="sd">        Query object acl info with parameter of the combination of</span>
<span class="sd">        `obj_collection` and `obj_ids` from KVStore and delete it.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_id: ID of this object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ObjectACLNotExistException: If object ACL info does not exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">key</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="k">raise</span> <span class="n">ObjectACLNotExistException</span><span class="p">(</span>
                <span class="s2">&quot;Object ACL info of </span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2"> does not exist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">delete_acls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Batch delete acl info.</span>

<span class="sd">        Query objects acl info with parameter of the combination of</span>
<span class="sd">        `obj_collection` and `obj_ids` from KVStore and delete them.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_ids: IDs of objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;$or&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)}</span>
                    <span class="k">for</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">obj_ids</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">get_accessible_object_ids</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get accessible IDs of objects from `obj_acls`.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            user: User name of current `operation`.</span>
<span class="sd">            operation: User operation, possible option: (read/write/delete).</span>
<span class="sd">            obj_collection: Collection where object currently stored.</span>
<span class="sd">            obj_ids: IDs of objects.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of IDs of accessible objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">obj_acls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acls</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">)</span>
        <span class="n">accessible_obj_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj_acl</span> <span class="ow">in</span> <span class="n">obj_acls</span><span class="p">:</span>
            <span class="n">perms</span> <span class="o">=</span> <span class="n">obj_acl</span><span class="o">.</span><span class="n">obj_perms</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_PERMS_ALLOW_ALL</span> <span class="ow">in</span> <span class="n">perms</span> <span class="ow">or</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">perms</span><span class="p">:</span>
                <span class="n">accessible_obj_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">obj_id</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">accessible_obj_ids</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">collection_name</span><span class="p">,</span> <span class="n">session_key</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">owner</span><span class="o">=</span><span class="s1">&#39;nobody&#39;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initializes ObjectACLManager.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>collection_name</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection name to store object ACL info.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App name of namespace.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>owner</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Owner of namespace, default is <code>nobody</code>.</p>
            </div>
          </td>
          <td>
                <code>&#39;nobody&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Optional">Optional</span>[<span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.ObjectACLManagerException">ObjectACLManagerException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If init ObjectACLManager failed.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">collection_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">owner</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes ObjectACLManager.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        collection_name: Collection name to store object ACL info.</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        app: App name of namespace.</span>
<span class="sd">        owner: (optional) Owner of namespace, default is `nobody`.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ObjectACLManagerException: If init ObjectACLManager failed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">collection_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{app}</span><span class="s2">_</span><span class="si">{collection_name}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">collection_name</span><span class="o">=</span><span class="n">collection_name</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">get_collection_data</span><span class="p">(</span>
            <span class="n">collection_name</span><span class="p">,</span>
            <span class="n">session_key</span><span class="p">,</span>
            <span class="n">app</span><span class="p">,</span>
            <span class="n">owner</span><span class="p">,</span>
            <span class="n">scheme</span><span class="p">,</span>
            <span class="n">host</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">context</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ObjectACLManagerException</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Get object acl collection: </span><span class="si">{</span><span class="n">collection_name</span><span class="si">}</span><span class="s2"> fail.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.delete_acl" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.delete_acl" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Delete acl info.</p>
<p>Query object acl info with parameter of the combination of
<code>obj_collection</code> and <code>obj_ids</code> from KVStore and delete it.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_id</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ID of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.ObjectACLNotExistException">ObjectACLNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If object ACL info does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_acl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete acl info.</span>

<span class="sd">    Query object acl info with parameter of the combination of</span>
<span class="sd">    `obj_collection` and `obj_ids` from KVStore and delete it.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_id: ID of this object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ObjectACLNotExistException: If object ACL info does not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">ObjectACLNotExistException</span><span class="p">(</span>
            <span class="s2">&quot;Object ACL info of </span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2"> does not exist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.delete_acls" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">delete_acls</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.delete_acls" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Batch delete acl info.</p>
<p>Query objects acl info with parameter of the combination of
<code>obj_collection</code> and <code>obj_ids</code> from KVStore and delete them.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_ids</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>IDs of objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">delete_acls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch delete acl info.</span>

<span class="sd">    Query objects acl info with parameter of the combination of</span>
<span class="sd">    `obj_collection` and `obj_ids` from KVStore and delete them.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_ids: IDs of objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">query</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;$or&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)}</span>
                <span class="k">for</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">obj_ids</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.get_accessible_object_ids" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_accessible_object_ids</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.get_accessible_object_ids" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get accessible IDs of objects from <code>obj_acls</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>user</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User name of current <code>operation</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>operation</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User operation, possible option: (read/write/delete).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_ids</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>IDs of objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of IDs of accessible objects.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_accessible_object_ids</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get accessible IDs of objects from `obj_acls`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        user: User name of current `operation`.</span>
<span class="sd">        operation: User operation, possible option: (read/write/delete).</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_ids: IDs of objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of IDs of accessible objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">obj_acls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acls</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">)</span>
    <span class="n">accessible_obj_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj_acl</span> <span class="ow">in</span> <span class="n">obj_acls</span><span class="p">:</span>
        <span class="n">perms</span> <span class="o">=</span> <span class="n">obj_acl</span><span class="o">.</span><span class="n">obj_perms</span><span class="p">[</span><span class="n">operation</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">OBJ_PERMS_ALLOW_ALL</span> <span class="ow">in</span> <span class="n">perms</span> <span class="ow">or</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">perms</span><span class="p">:</span>
            <span class="n">accessible_obj_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">obj_id</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">accessible_obj_ids</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.get_acl" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.get_acl" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get acl info.</p>
<p>Query object acl info with parameter of the combination of
<code>obj_collection</code> and <code>obj_id</code> from <code>self.collection_name</code> and
return it.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_id</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ID of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.ObjectACL">ObjectACL</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object acl info if success else None.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.ObjectACLNotExistException">ObjectACLNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If object ACL info does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_acl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ObjectACL&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get acl info.</span>

<span class="sd">    Query object acl info with parameter of the combination of</span>
<span class="sd">    `obj_collection` and `obj_id` from `self.collection_name` and</span>
<span class="sd">    return it.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_id: ID of this object.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Object acl info if success else None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ObjectACLNotExistException: If object ACL info does not exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">key</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">obj_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query_by_id</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">ObjectACLNotExistException</span><span class="p">(</span>
            <span class="s2">&quot;Object ACL info of </span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2"> does not exist.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">obj_acl</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.get_acls" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_acls</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.get_acls" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Batch get acl info.</p>
<p>Query objects acl info with parameter of the combination of
<code>obj_collection</code> and <code>obj_ids</code> from KVStore and return them.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_ids</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>IDs of objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional-hover="solnlib.user_access.ObjectACL">ObjectACL</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of <code>ObjectACL</code> instances.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_acls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ObjectACL</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch get acl info.</span>

<span class="sd">    Query objects acl info with parameter of the combination of</span>
<span class="sd">    `obj_collection` and `obj_ids` from KVStore and return them.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_ids: IDs of objects.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of `ObjectACL` instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">query</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;$or&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="n">ObjectACL</span><span class="o">.</span><span class="n">generate_key</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)}</span>
                <span class="k">for</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">obj_ids</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="n">obj_acls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">ObjectACL</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">obj_acl</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj_acl</span> <span class="ow">in</span> <span class="n">obj_acls</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.update_acl" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">,</span> <span class="n">obj_app</span><span class="p">,</span> <span class="n">obj_owner</span><span class="p">,</span> <span class="n">obj_perms</span><span class="p">,</span> <span class="n">obj_shared_by_inclusion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.update_acl" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Update acl info of object.</p>
<p>Construct a new object acl info first, if <code>replace_existing</code> is True
then replace existing acl info else merge new object acl info with the
old one and replace the old acl info with merged acl info.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where object currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_id</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>ID of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Owner of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_perms</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object perms, like:</p>
<p>{
    &lsquo;read&rsquo;: [&lsquo;*&rsquo;],
    &lsquo;write&rsquo;: [&lsquo;admin&rsquo;],
    &lsquo;delete&rsquo;: [&lsquo;admin&rsquo;]
}.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_shared_by_inclusion</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Flag of object is shared by
inclusion, default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>replace_existing</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Replace existing acl info flag, True
indicates replace old acl info with new one else merge with old
acl info, default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update_acl</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_perms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">obj_shared_by_inclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">replace_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update acl info of object.</span>

<span class="sd">    Construct a new object acl info first, if `replace_existing` is True</span>
<span class="sd">    then replace existing acl info else merge new object acl info with the</span>
<span class="sd">    old one and replace the old acl info with merged acl info.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where object currently stored.</span>
<span class="sd">        obj_id: ID of this object.</span>
<span class="sd">        obj_type: Type of this object.</span>
<span class="sd">        obj_app: App of this object.</span>
<span class="sd">        obj_owner: Owner of this object.</span>
<span class="sd">        obj_perms: Object perms, like:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;read&#39;: [&#39;*&#39;],</span>
<span class="sd">                &#39;write&#39;: [&#39;admin&#39;],</span>
<span class="sd">                &#39;delete&#39;: [&#39;admin&#39;]</span>
<span class="sd">            }.</span>
<span class="sd">        obj_shared_by_inclusion: (optional) Flag of object is shared by</span>
<span class="sd">            inclusion, default is True.</span>
<span class="sd">        replace_existing: (optional) Replace existing acl info flag, True</span>
<span class="sd">            indicates replace old acl info with new one else merge with old</span>
<span class="sd">            acl info, default is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">obj_acl</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="p">(</span>
        <span class="n">obj_collection</span><span class="p">,</span>
        <span class="n">obj_id</span><span class="p">,</span>
        <span class="n">obj_type</span><span class="p">,</span>
        <span class="n">obj_app</span><span class="p">,</span>
        <span class="n">obj_owner</span><span class="p">,</span>
        <span class="n">obj_perms</span><span class="p">,</span>
        <span class="n">obj_shared_by_inclusion</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">replace_existing</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">ObjectACLNotExistException</span><span class="p">:</span>
            <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">old_obj_acl</span><span class="p">:</span>
            <span class="n">obj_acl</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">old_obj_acl</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">record</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="user_access-solnlib.user_access.ObjectACLManager.update_acls" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">update_acls</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_ids</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">,</span> <span class="n">obj_app</span><span class="p">,</span> <span class="n">obj_owner</span><span class="p">,</span> <span class="n">obj_perms</span><span class="p">,</span> <span class="n">obj_shared_by_inclusion</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">replace_existing</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.ObjectACLManager.update_acls" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Batch update object acl info to all provided <code>obj_ids</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>obj_collection</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Collection where objects currently stored.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_ids</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="str">str</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>IDs list of objects.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Type of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_app</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_owner</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Owner of this object.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_perms</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object perms, like:</p>
<p>{
    &lsquo;read&rsquo;: [&lsquo;*&rsquo;],
    &lsquo;write&rsquo;: [&lsquo;admin&rsquo;],
    &lsquo;delete&rsquo;: [&lsquo;admin&rsquo;]
}.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_shared_by_inclusion</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Flag of object is shared by
inclusion, default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>replace_existing</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Replace existing acl info flag, True
indicates replace old acl info with new one else merge with old acl
info, default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">update_acls</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">obj_collection</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_ids</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_app</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_owner</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">obj_perms</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">obj_shared_by_inclusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">replace_existing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Batch update object acl info to all provided `obj_ids`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        obj_collection: Collection where objects currently stored.</span>
<span class="sd">        obj_ids: IDs list of objects.</span>
<span class="sd">        obj_type: Type of this object.</span>
<span class="sd">        obj_app: App of this object.</span>
<span class="sd">        obj_owner: Owner of this object.</span>
<span class="sd">        obj_perms: Object perms, like:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;read&#39;: [&#39;*&#39;],</span>
<span class="sd">                &#39;write&#39;: [&#39;admin&#39;],</span>
<span class="sd">                &#39;delete&#39;: [&#39;admin&#39;]</span>
<span class="sd">            }.</span>
<span class="sd">        obj_shared_by_inclusion: (optional) Flag of object is shared by</span>
<span class="sd">            inclusion, default is True.</span>
<span class="sd">        replace_existing: (optional) Replace existing acl info flag, True</span>
<span class="sd">            indicates replace old acl info with new one else merge with old acl</span>
<span class="sd">            info, default is True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">obj_acl_records</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">obj_id</span> <span class="ow">in</span> <span class="n">obj_ids</span><span class="p">:</span>
        <span class="n">obj_acl</span> <span class="o">=</span> <span class="n">ObjectACL</span><span class="p">(</span>
            <span class="n">obj_collection</span><span class="p">,</span>
            <span class="n">obj_id</span><span class="p">,</span>
            <span class="n">obj_type</span><span class="p">,</span>
            <span class="n">obj_app</span><span class="p">,</span>
            <span class="n">obj_owner</span><span class="p">,</span>
            <span class="n">obj_perms</span><span class="p">,</span>
            <span class="n">obj_shared_by_inclusion</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">replace_existing</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_acl</span><span class="p">(</span><span class="n">obj_collection</span><span class="p">,</span> <span class="n">obj_id</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ObjectACLNotExistException</span><span class="p">:</span>
                <span class="n">old_obj_acl</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="n">old_obj_acl</span><span class="p">:</span>
                <span class="n">obj_acl</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">old_obj_acl</span><span class="p">)</span>

        <span class="n">obj_acl_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj_acl</span><span class="o">.</span><span class="n">record</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_collection_data</span><span class="o">.</span><span class="n">batch_save</span><span class="p">(</span><span class="o">*</span><span class="n">obj_acl_records</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.ObjectACLManagerException" class="doc doc-heading">
        <code>ObjectACLManagerException</code>


<a href="#user_access-solnlib.user_access.ObjectACLManagerException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for ObjectACLManager.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ObjectACLManagerException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for ObjectACLManager.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.ObjectACLNotExistException" class="doc doc-heading">
        <code>ObjectACLNotExistException</code>


<a href="#user_access-solnlib.user_access.ObjectACLNotExistException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for the situation when ACL does not exist.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ObjectACLNotExistException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for the situation when ACL does not exist.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.UserAccessException" class="doc doc-heading">
        <code>UserAccessException</code>


<a href="#user_access-solnlib.user_access.UserAccessException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception for the situation when there is user access exception.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">UserAccessException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception for the situation when there is user access exception.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="user_access-solnlib.user_access.UserNotExistException" class="doc doc-heading">
        <code>UserNotExistException</code>


<a href="#user_access-solnlib.user_access.UserNotExistException" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span data-autorefs-optional="Exception">Exception</span></code></p>

  
      <p>Exception when user does not exist.</p>


        <details class="quote">
          <summary>Source code in <code>solnlib/user_access.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">UserNotExistException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Exception when user does not exist.&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="user_access-solnlib.user_access.check_user_access" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">check_user_access</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">,</span> <span class="n">obj_type</span><span class="p">,</span> <span class="n">operation</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.check_user_access" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>User access checker.</p>
<p>It will fetch user capabilities from given <code>session_key</code> and check if
the capability extracted from <code>capabilities</code>, <code>obj_type</code> and <code>operation</code>
is contained, if user capabilities include the extracted capability user
access is ok else fail.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>capabilities</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>App capabilities, example:</p>
<p>{
    &lsquo;object_type1&rsquo;: {
        &lsquo;read&rsquo;: &lsquo;read_app_object_type1&rsquo;,
        &lsquo;write&rsquo;: &lsquo;write_app_object_type1&rsquo;,
        &lsquo;delete&rsquo;: &lsquo;delete_app_object_type1&rsquo;},
        &lsquo;object_type2&rsquo;: {
        &lsquo;read&rsquo;: &lsquo;read_app_object_type2&rsquo;,
        &lsquo;write&rsquo;: &lsquo;write_app_object_type2&rsquo;,
        &lsquo;delete&rsquo;: &lsquo;delete_app_object_type2&rsquo;
    },
    &hellip;
}</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>obj_type</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Object type.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>operation</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User operation, possible option: (read/write/delete).</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.UserAccessException">UserAccessException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If user access permission is denied.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib.user_access</span> <span class="kn">import</span> <span class="n">check_user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fun</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">check_user_access</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">session_key</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">,</span> <span class="s1">&#39;test_object&#39;</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="o">...</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_user_access</span><span class="p">(</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">capabilities</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">obj_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">operation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;User access checker.</span>

<span class="sd">    It will fetch user capabilities from given `session_key` and check if</span>
<span class="sd">    the capability extracted from `capabilities`, `obj_type` and `operation`</span>
<span class="sd">    is contained, if user capabilities include the extracted capability user</span>
<span class="sd">    access is ok else fail.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        capabilities: App capabilities, example:</span>

<span class="sd">            {</span>
<span class="sd">                &#39;object_type1&#39;: {</span>
<span class="sd">                    &#39;read&#39;: &#39;read_app_object_type1&#39;,</span>
<span class="sd">                    &#39;write&#39;: &#39;write_app_object_type1&#39;,</span>
<span class="sd">                    &#39;delete&#39;: &#39;delete_app_object_type1&#39;},</span>
<span class="sd">                    &#39;object_type2&#39;: {</span>
<span class="sd">                    &#39;read&#39;: &#39;read_app_object_type2&#39;,</span>
<span class="sd">                    &#39;write&#39;: &#39;write_app_object_type2&#39;,</span>
<span class="sd">                    &#39;delete&#39;: &#39;delete_app_object_type2&#39;</span>
<span class="sd">                },</span>
<span class="sd">                ...</span>
<span class="sd">            }</span>
<span class="sd">        obj_type: Object type.</span>
<span class="sd">        operation: User operation, possible option: (read/write/delete).</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserAccessException: If user access permission is denied.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib.user_access import check_user_access</span>
<span class="sd">       &gt;&gt;&gt; def fun():</span>
<span class="sd">       &gt;&gt;&gt;     check_user_access(</span>
<span class="sd">       &gt;&gt;&gt;         session_key, capabilities, &#39;test_object&#39;, &#39;read&#39;)</span>
<span class="sd">       &gt;&gt;&gt;     ...</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">username</span> <span class="o">=</span> <span class="n">get_current_username</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
    <span class="n">capability</span> <span class="o">=</span> <span class="n">capabilities</span><span class="p">[</span><span class="n">obj_type</span><span class="p">][</span><span class="n">operation</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user_is_capable</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span>
        <span class="n">username</span><span class="p">,</span>
        <span class="n">capability</span><span class="p">,</span>
        <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span>
        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
        <span class="o">**</span><span class="n">context</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="n">UserAccessException</span><span class="p">(</span>
            <span class="s2">&quot;Permission denied, </span><span class="si">%s</span><span class="s2"> does not have the capability: </span><span class="si">%s</span><span class="s2">.&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">capability</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="user_access-solnlib.user_access.get_current_username" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_current_username</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.get_current_username" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get current user name from <code>session_key</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Current user name.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.InvalidSessionKeyException">InvalidSessionKeyException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>session_key</code> is invalid.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user_name</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">get_current_username</span><span class="p">(</span><span class="n">session_key</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_current_username</span><span class="p">(</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get current user name from `session_key`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Current user name.</span>

<span class="sd">    Raises:</span>
<span class="sd">        InvalidSessionKeyException: If `session_key` is invalid.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; user_name = user_access.get_current_username(session_key)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;/services/authentication/current-context&quot;</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">401</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">InvalidSessionKeyException</span><span class="p">(</span><span class="s2">&quot;Invalid session key.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="s2">&quot;username&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="user_access-solnlib.user_access.get_user_capabilities" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_user_capabilities</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.get_user_capabilities" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get user capabilities.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span>[<span data-autorefs-optional="dict">dict</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User capabilities.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.UserNotExistException">UserNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>username</code> does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user_capabilities</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">get_user_capabilities</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">session_key</span><span class="p">,</span> <span class="s1">&#39;test_user&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_user_capabilities</span><span class="p">(</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get user capabilities.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Returns:</span>
<span class="sd">        User capabilities.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserNotExistException: If `username` does not exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; user_capabilities = user_access.get_user_capabilities(</span>
<span class="sd">       &gt;&gt;&gt;     session_key, &#39;test_user&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/services/authentication/users/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">UserNotExistException</span><span class="p">(</span><span class="s2">&quot;User: </span><span class="si">%s</span><span class="s2"> does not exist.&quot;</span> <span class="o">%</span> <span class="n">username</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="s2">&quot;capabilities&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="user_access-solnlib.user_access.get_user_roles" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_user_roles</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.get_user_roles" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get user roles.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>username</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) User name of roles to get.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>User roles.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.UserNotExistException">UserNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>username</code> does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">user_roles</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">get_user_roles</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="s1">&#39;test_user&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@utils</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span><span class="n">exceptions</span><span class="o">=</span><span class="p">[</span><span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_user_roles</span><span class="p">(</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get user roles.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        username: (optional) User name of roles to get.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Returns:</span>
<span class="sd">        User roles.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserNotExistException: If `username` does not exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; user_roles = user_access.get_user_roles(session_key, &#39;test_user&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_rest_client</span> <span class="o">=</span> <span class="n">rest_client</span><span class="o">.</span><span class="n">SplunkRestClient</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/services/authentication/users/</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">_rest_client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">binding</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
            <span class="k">raise</span>

        <span class="k">raise</span> <span class="n">UserNotExistException</span><span class="p">(</span><span class="s2">&quot;User: </span><span class="si">%s</span><span class="s2"> does not exist.&quot;</span> <span class="o">%</span> <span class="n">username</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="s2">&quot;entry&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;content&quot;</span><span class="p">][</span><span class="s2">&quot;roles&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="user_access-solnlib.user_access.user_is_capable" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">user_is_capable</span><span class="p">(</span><span class="n">session_key</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">capability</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span></code>

<a href="#user_access-solnlib.user_access.user_is_capable" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Check if user is capable for given <code>capability</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>session_key</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Splunk access token.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>username</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) User name of roles to get.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>capability</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The capability we wish to check for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>scheme</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The access scheme, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>host</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The host name, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>port</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) The port number, default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>context</code></td>
          <td>
                <code><span data-autorefs-optional="dict">dict</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Other configurations for Splunk rest client.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True if user is capable else False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="solnlib.user_access.UserNotExistException">UserNotExistException</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>username</code> does not exist.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<p><strong>Examples:</strong></p>
    <div class="codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">solnlib</span> <span class="kn">import</span> <span class="n">user_access</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_capable</span> <span class="o">=</span> <span class="n">user_access</span><span class="o">.</span><span class="n">user_is_capable</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">session_key</span><span class="p">,</span> <span class="s1">&#39;test_user&#39;</span><span class="p">,</span> <span class="s1">&#39;object_read_capability&#39;</span><span class="p">)</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>solnlib/user_access.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">user_is_capable</span><span class="p">(</span>
    <span class="n">session_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">capability</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">scheme</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">host</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">port</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if user is capable for given `capability`.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        session_key: Splunk access token.</span>
<span class="sd">        username: (optional) User name of roles to get.</span>
<span class="sd">        capability: The capability we wish to check for.</span>
<span class="sd">        scheme: (optional) The access scheme, default is None.</span>
<span class="sd">        host: (optional) The host name, default is None.</span>
<span class="sd">        port: (optional) The port number, default is None.</span>
<span class="sd">        context: Other configurations for Splunk rest client.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if user is capable else False.</span>

<span class="sd">    Raises:</span>
<span class="sd">        UserNotExistException: If `username` does not exist.</span>

<span class="sd">    Examples:</span>
<span class="sd">       &gt;&gt;&gt; from solnlib import user_access</span>
<span class="sd">       &gt;&gt;&gt; is_capable = user_access.user_is_capable(</span>
<span class="sd">       &gt;&gt;&gt;     session_key, &#39;test_user&#39;, &#39;object_read_capability&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">capabilities</span> <span class="o">=</span> <span class="n">get_user_capabilities</span><span class="p">(</span>
        <span class="n">session_key</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="n">scheme</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">capability</span> <span class="ow">in</span> <span class="n">capabilities</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><section class="print-page" id="utils"><h1 id="utils-utilspy">utils.py<a class="headerlink" href="#utils-utilspy" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="solnlib.utils"></a>
  <div class="doc doc-contents first">
  
      <p>Common utilities.</p>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="utils-solnlib.utils.__all__" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;handle_teardown_signals&#39;</span><span class="p">,</span> <span class="s1">&#39;datetime_to_seconds&#39;</span><span class="p">,</span> <span class="s1">&#39;is_true&#39;</span><span class="p">,</span> <span class="s1">&#39;is_false&#39;</span><span class="p">,</span> <span class="s1">&#39;retry&#39;</span><span class="p">,</span> <span class="s1">&#39;extract_http_scheme_host_port&#39;</span><span class="p">,</span> <span class="s1">&#39;remove_http_proxy_env_vars&#39;</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#utils-solnlib.utils.__all__" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  </div>

</div>



<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.datetime_to_seconds" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">datetime_to_seconds</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.datetime_to_seconds" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Convert UTC datetime to seconds since epoch.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dt</code></td>
          <td>
                <code><span data-autorefs-optional="datetime">datetime</span>.<span data-autorefs-optional-hover="datetime.datetime">datetime</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Date time.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="float">float</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Seconds since epoch.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">datetime_to_seconds</span><span class="p">(</span><span class="n">dt</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert UTC datetime to seconds since epoch.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        dt: Date time.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Seconds since epoch.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">epoch_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcfromtimestamp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dt</span> <span class="o">-</span> <span class="n">epoch_time</span><span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.extract_http_scheme_host_port" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">http_url</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.extract_http_scheme_host_port" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Extract scheme, host and port from a HTTP URL.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>http_url</code></td>
          <td>
                <code><span data-autorefs-optional="str">str</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>HTTP URL to extract.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional-hover="typing.Tuple">Tuple</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple of scheme, host and port</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="ValueError">ValueError</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If <code>http_url</code> is not in http(s)://hostname:port format.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">extract_http_scheme_host_port</span><span class="p">(</span><span class="n">http_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract scheme, host and port from a HTTP URL.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        http_url: HTTP URL to extract.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple of scheme, host and port</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `http_url` is not in http(s)://hostname:port format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">http_info</span> <span class="o">=</span> <span class="n">urlparse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">http_url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">http_info</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">http_info</span><span class="o">.</span><span class="n">hostname</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">http_info</span><span class="o">.</span><span class="n">port</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">http_url</span> <span class="o">+</span> <span class="s2">&quot; is not in http(s)://hostname:port format&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">http_info</span><span class="o">.</span><span class="n">scheme</span><span class="p">,</span> <span class="n">http_info</span><span class="o">.</span><span class="n">hostname</span><span class="p">,</span> <span class="n">http_info</span><span class="o">.</span><span class="n">port</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.get_appname_from_path" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_appname_from_path</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.get_appname_from_path" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Gets name of the app from its path.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>absolute_path</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>path of app</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_appname_from_path</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets name of the app from its path.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        absolute_path: path of app</span>

<span class="sd">    Returns:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">absolute_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">absolute_path</span><span class="p">)</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">absolute_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">sep</span><span class="p">)</span>
    <span class="n">parts</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;apps&quot;</span><span class="p">,</span> <span class="s2">&quot;peer-apps&quot;</span><span class="p">,</span> <span class="s2">&quot;manager-apps&quot;</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">parts</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;etc&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">parts</span><span class="p">[</span><span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">continue</span>
    <span class="k">return</span> <span class="s2">&quot;-&quot;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.handle_teardown_signals" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">handle_teardown_signals</span><span class="p">(</span><span class="n">callback</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.handle_teardown_signals" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Register handler for SIGTERM/SIGINT/SIGBREAK signal.</p>
<p>Catch SIGTERM/SIGINT/SIGBREAK signals, and invoke callback
Note: this should be called in main thread since Python only catches
signals in main thread.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>callback</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Callable">Callable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Callback for tear down signals.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_teardown_signals</span><span class="p">(</span><span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register handler for SIGTERM/SIGINT/SIGBREAK signal.</span>

<span class="sd">    Catch SIGTERM/SIGINT/SIGBREAK signals, and invoke callback</span>
<span class="sd">    Note: this should be called in main thread since Python only catches</span>
<span class="sd">    signals in main thread.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        callback: Callback for tear down signals.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
    <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;nt&quot;</span><span class="p">:</span>
        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGBREAK</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.is_false" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_false</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.is_false" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Decide if <code>val</code> is false.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>val</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value to check.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True or False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_false</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decide if `val` is false.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        val: Value to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True or False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;FALSE&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;NO&quot;</span><span class="p">,</span> <span class="s2">&quot;NONE&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.is_true" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">is_true</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.is_true" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Decide if <code>val</code> is true.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>val</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Union">Union</span>[<span data-autorefs-optional="str">str</span>, <span data-autorefs-optional="int">int</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Value to check.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True or False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_true</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decide if `val` is true.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        val: Value to check.</span>

<span class="sd">    Returns:</span>
<span class="sd">        True or False.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;Y&quot;</span><span class="p">,</span> <span class="s2">&quot;YES&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.remove_http_proxy_env_vars" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">remove_http_proxy_env_vars</span><span class="p">()</span></code>

<a href="#utils-solnlib.utils.remove_http_proxy_env_vars" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>Removes HTTP(s) proxies from environment variables.</p>

<details class="removes-the-following-environment-variables" open>
  <summary>Removes the following environment variables</summary>
  <ul>
<li>http_proxy</li>
<li>https_proxy</li>
<li>HTTP_PROXY</li>
<li>HTTPS_PROXY</li>
</ul>
</details>      <p>This function can be used in Splunk modular inputs code before starting the
ingestion to ensure that no proxy is going to be used when doing requests.
In case of proxy is needed, it can be defined in the modular inputs code.</p>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_http_proxy_env_vars</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes HTTP(s) proxies from environment variables.</span>

<span class="sd">    Removes the following environment variables:</span>
<span class="sd">        * http_proxy</span>
<span class="sd">        * https_proxy</span>
<span class="sd">        * HTTP_PROXY</span>
<span class="sd">        * HTTPS_PROXY</span>

<span class="sd">    This function can be used in Splunk modular inputs code before starting the</span>
<span class="sd">    ingestion to ensure that no proxy is going to be used when doing requests.</span>
<span class="sd">    In case of proxy is needed, it can be defined in the modular inputs code.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">env_vars_to_remove</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;http_proxy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https_proxy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HTTP_PROXY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HTTPS_PROXY&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">env_var</span> <span class="ow">in</span> <span class="n">env_vars_to_remove</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">env_var</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="n">env_var</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="utils-solnlib.utils.retry" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">retry</span><span class="p">(</span><span class="n">retries</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">reraise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default_return</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">exceptions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#utils-solnlib.utils.retry" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
  
      <p>A decorator to run function with max <code>retries</code> times if there is
exception.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>retries</code></td>
          <td>
                <code><span data-autorefs-optional="int">int</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Max retries times, default is 3.</p>
            </div>
          </td>
          <td>
                <code>3</code>
          </td>
        </tr>
        <tr>
          <td><code>reraise</code></td>
          <td>
                <code><span data-autorefs-optional="bool">bool</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether exception should be reraised, default is True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>default_return</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.Any">Any</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) Default return value for function
run after max retries and reraise is False.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>exceptions</code></td>
          <td>
                <code><span data-autorefs-optional-hover="typing.List">List</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(optional) List of exceptions that should retry.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>solnlib/utils.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">retry</span><span class="p">(</span>
    <span class="n">retries</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">reraise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">default_return</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exceptions</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A decorator to run function with max `retries` times if there is</span>
<span class="sd">    exception.</span>

<span class="sd">    Arguments:</span>
<span class="sd">        retries: (optional) Max retries times, default is 3.</span>
<span class="sd">        reraise: Whether exception should be reraised, default is True.</span>
<span class="sd">        default_return: (optional) Default return value for function</span>
<span class="sd">            run after max retries and reraise is False.</span>
<span class="sd">        exceptions: (optional) List of exceptions that should retry.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">max_tries</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">retries</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">do_retry</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">last_ex</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_tries</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Run function: </span><span class="si">%s</span><span class="s2"> failed: </span><span class="si">%s</span><span class="s2">.&quot;</span><span class="p">,</span>
                        <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                        <span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">(),</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">exceptions</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span>
                        <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">exception</span><span class="p">)</span> <span class="k">for</span> <span class="n">exception</span> <span class="ow">in</span> <span class="n">exceptions</span>
                    <span class="p">):</span>
                        <span class="n">last_ex</span> <span class="o">=</span> <span class="n">e</span>
                        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">max_tries</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span>

            <span class="k">if</span> <span class="n">reraise</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">last_ex</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">default_return</span>

        <span class="k">return</span> <span class="n">wrapper</span>

    <span class="k">return</span> <span class="n">do_retry</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div></section><h1 class='nav-section-title-end'>Ended: References</h1></div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "/", "features": ["content.code.copy", "navigation.indexes"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>